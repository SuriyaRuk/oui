(window["savedObjectsManagement_bundle_jsonpfunction"]=window["savedObjectsManagement_bundle_jsonpfunction"]||[]).push([[3],{28:function(module,exports,__webpack_require__){var assignValue=__webpack_require__(39),castPath=__webpack_require__(51),isFunction=__webpack_require__(29),isIndex=__webpack_require__(80),isObject=__webpack_require__(25),toKey=__webpack_require__(81);function baseSet(object,path,value,customizer){if(!isObject(object)){return object}path=castPath(path,object);var index=-1,length=path.length,lastIndex=length-1,nested=object;while(nested!=null&&++index<length){var key=toKey(path[index]),newValue=value;if(key=="prototype"&&isFunction(nested)){throw new Error("Illegal access of function prototype")}if(index!=lastIndex){var objValue=hasOwnProperty.call(nested,key)?nested[key]:undefined;newValue=customizer?customizer(objValue,key,nested):undefined;if(newValue===undefined){newValue=isObject(objValue)?objValue:isIndex(path[index+1])?[]:{}}}assignValue(nested,key,newValue);nested=nested[key]}return object}module.exports=baseSet},37:function(module,exports,__webpack_require__){exports.set=__webpack_require__(38);exports.setWith=__webpack_require__(82)},38:function(module,exports,__webpack_require__){var baseSet=__webpack_require__(28);function set(object,path,value){return object==null?object:baseSet(object,path,value)}module.exports=set},82:function(module,exports,__webpack_require__){var baseSet=__webpack_require__(28);function setWith(object,path,value,customizer){customizer=typeof customizer=="function"?customizer:undefined;return object==null?object:baseSet(object,path,value,customizer)}module.exports=setWith},96:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",(function(){return SavedObjectsEditionPage}));var external_osdSharedDeps_React_=__webpack_require__(10);var external_osdSharedDeps_React_default=__webpack_require__.n(external_osdSharedDeps_React_);var external_osdSharedDeps_ReactRouterDom_=__webpack_require__(13);var query_string=__webpack_require__(32);var external_osdSharedDeps_OsdI18n_=__webpack_require__(1);var external_osdSharedDeps_ElasticEui_=__webpack_require__(11);var external_osdSharedDeps_OsdI18nReact_=__webpack_require__(12);const Header=_ref=>{let{canEdit:canEdit,canDelete:canDelete,canViewInApp:canViewInApp,type:type,viewUrl:viewUrl,onDeleteClick:onDeleteClick}=_ref;return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPageContentHeader"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPageContentHeaderSection"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],null,canEdit?external_osdSharedDeps_React_default.a.createElement("h1",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"savedObjectsManagement.view.editItemTitle",defaultMessage:"Edit {title}",values:{title:type}})):external_osdSharedDeps_React_default.a.createElement("h1",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"savedObjectsManagement.view.viewItemTitle",defaultMessage:"View {title}",values:{title:type}})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPageContentHeaderSection"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false},canViewInApp&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButton"],{size:"s",href:viewUrl,iconType:"eye","data-test-subj":"savedObjectEditViewInApp"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"savedObjectsManagement.view.viewItemButtonLabel",defaultMessage:"View {title}",values:{title:type}}))),canDelete&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButton"],{color:"danger",size:"s",iconType:"trash",onClick:()=>onDeleteClick(),"data-test-subj":"savedObjectEditDelete"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"savedObjectsManagement.view.deleteItemButtonLabel",defaultMessage:"Delete {title}",values:{title:type}}))))))};const NotFoundErrors=_ref=>{let{type:type}=_ref;const getMessage=()=>{switch(type){case"search":return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"savedObjectsManagement.view.savedSearchDoesNotExistErrorMessage",defaultMessage:"The saved search associated with this object no longer exists."});case"index-pattern":return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"savedObjectsManagement.view.indexPatternDoesNotExistErrorMessage",defaultMessage:"The index pattern associated with this object no longer exists."});case"index-pattern-field":return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"savedObjectsManagement.view.fieldDoesNotExistErrorMessage",defaultMessage:"A field associated with this object no longer exists in the index pattern."});default:return null}};return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCallOut"],{title:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"savedObjectsManagement.view.savedObjectProblemErrorMessage",defaultMessage:"There is a problem with this saved object"}),iconType:"alert",color:"danger"},external_osdSharedDeps_React_default.a.createElement("p",null,getMessage()),external_osdSharedDeps_React_default.a.createElement("p",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"savedObjectsManagement.view.howToFixErrorDescription",defaultMessage:"If you know what this error means, go ahead and fix it — otherwise click the delete button above."})))};const Intro=()=>external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCallOut"],{title:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"savedObjectsManagement.view.howToModifyObjectTitle",defaultMessage:"Proceed with caution!"}),iconType:"alert",color:"warning"},external_osdSharedDeps_React_default.a.createElement("p",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"savedObjectsManagement.view.howToModifyObjectDescription",defaultMessage:"Modifying objects is for advanced users only. Object properties are not validated and invalid objects could cause errors, data loss, or worse. Unless someone with intimate knowledge of the code told you to be in here, you probably shouldn’t be."})));var opensearch_safer_lodash_set=__webpack_require__(37);var external_osdSharedDeps_Lodash_=__webpack_require__(0);class field_Field extends external_osdSharedDeps_React_["PureComponent"]{render(){const{name:name}=this.props;return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,label:name},this.renderField())}onCodeEditorChange(targetValue){const{name:name,onChange:onChange}=this.props;let invalid=false;try{JSON.parse(targetValue)}catch(e){invalid=true}onChange(name,{value:targetValue,invalid:invalid})}onFieldChange(targetValue){const{name:name,type:type,onChange:onChange}=this.props;let newParsedValue=targetValue;let invalid=false;if(type==="number"){try{newParsedValue=Number(newParsedValue)}catch(e){invalid=true}}onChange(name,{value:newParsedValue,invalid:invalid})}renderField(){var _state$value;const{type:type,name:name,state:state,disabled:disabled}=this.props;const currentValue=(_state$value=state===null||state===void 0?void 0:state.value)!==null&&_state$value!==void 0?_state$value:this.props.value;switch(type){case"number":return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{name:name,id:this.fieldId,value:currentValue,onChange:e=>this.onFieldChange(e.target.value),disabled:disabled,"data-test-subj":"savedObjects-editField-".concat(name)});case"boolean":return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSwitch"],{name:name,id:this.fieldId,label:!!currentValue?external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"savedObjectsManagement.field.onLabel",defaultMessage:"On"}):external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"savedObjectsManagement.field.offLabel",defaultMessage:"Off"}),checked:!!currentValue,onChange:e=>this.onFieldChange(e.target.checked),disabled:disabled,"data-test-subj":"savedObjects-editField-".concat(name)});case"json":case"array":return external_osdSharedDeps_React_default.a.createElement("div",{"data-test-subj":"savedObjects-editField-".concat(name)},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCodeEditor"],{name:"savedObjects-editField-".concat(name,"-aceEditor"),mode:"json",theme:"textmate",value:currentValue,onChange:value=>this.onCodeEditorChange(value),width:"100%",height:"auto",minLines:6,maxLines:30,isReadOnly:disabled,setOptions:{showLineNumbers:true,tabSize:2,useSoftTabs:true},editorProps:{$blockScrolling:Infinity},showGutter:true}));default:return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{id:this.fieldId,name:name,value:currentValue,onChange:e=>this.onFieldChange(e.target.value),disabled:disabled,"data-test-subj":"savedObjects-editField-".concat(name)})}}get fieldId(){const{name:name}=this.props;return"savedObjects-editField-".concat(name)}}var lib=__webpack_require__(4);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class form_Form extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);_defineProperty(this,"handleFieldChange",(name,newState)=>{this.setState({fieldStates:{...this.state.fieldStates,[name]:newState}})});_defineProperty(this,"onCancel",()=>{window.history.back()});_defineProperty(this,"onSubmit",async()=>{const{object:object,onSave:onSave}=this.props;const{fields:fields,fieldStates:fieldStates}=this.state;if(!this.isFormValid()){return}this.setState({submitting:true});const source=Object(external_osdSharedDeps_Lodash_["cloneDeep"])(object.attributes);fields.forEach(field=>{var _fieldStates$field$na,_fieldStates$field$na2;let value=(_fieldStates$field$na=(_fieldStates$field$na2=fieldStates[field.name])===null||_fieldStates$field$na2===void 0?void 0:_fieldStates$field$na2.value)!==null&&_fieldStates$field$na!==void 0?_fieldStates$field$na:field.value;if(field.type==="array"&&typeof value==="string"){value=JSON.parse(value)}Object(opensearch_safer_lodash_set["set"])(source,field.name,value)});const{references:references,...attributes}=source;await onSave({attributes:attributes,references:references});this.setState({submitting:false})});this.state={fields:[],fieldStates:{},submitting:false}}componentDidMount(){const{object:object,service:service}=this.props;const fields=Object(lib["createFieldList"])(object,service);this.setState({fields:fields})}render(){const{editionEnabled:editionEnabled,service:service}=this.props;const{fields:fields,fieldStates:fieldStates,submitting:submitting}=this.state;const isValid=this.isFormValid();return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiForm"],{"data-test-subj":"savedObjectEditForm",role:"form"},fields.map(field=>external_osdSharedDeps_React_default.a.createElement(field_Field,{key:"".concat(field.type,"-").concat(field.name),type:field.type,name:field.name,value:field.value,state:fieldStates[field.name],disabled:!editionEnabled,onChange:this.handleFieldChange})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"m"},editionEnabled&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButton"],{fill:true,"aria-label":external_osdSharedDeps_OsdI18n_["i18n"].translate("savedObjectsManagement.view.saveButtonAriaLabel",{defaultMessage:"Save { title } object",values:{title:service.type}}),onClick:this.onSubmit,disabled:!isValid||submitting,"data-test-subj":"savedObjectEditSave"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"savedObjectsManagement.view.saveButtonLabel",defaultMessage:"Save { title } object",values:{title:service.type}}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButtonEmpty"],{"aria-label":external_osdSharedDeps_OsdI18n_["i18n"].translate("savedObjectsManagement.view.cancelButtonAriaLabel",{defaultMessage:"Cancel"}),onClick:this.onCancel,"data-test-subj":"savedObjectEditCancel"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"savedObjectsManagement.view.cancelButtonLabel",defaultMessage:"Cancel"})))))}isFormValid(){const{fieldStates:fieldStates}=this.state;return!Object.values(fieldStates).some(state=>state.invalid===true)}}var triggers=__webpack_require__(5);function saved_object_view_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class saved_object_view_SavedObjectEdition extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);saved_object_view_defineProperty(this,"saveChanges",async _ref=>{let{attributes:attributes,references:references}=_ref;const{savedObjectsClient:savedObjectsClient,notifications:notifications}=this.props;const{object:object,type:type}=this.state;await savedObjectsClient.update(object.type,object.id,attributes,{references:references});notifications.toasts.addSuccess("Updated ".concat(this.formatTitle(object)," ").concat(type," object"));this.redirectToListing()});saved_object_view_defineProperty(this,"formatTitle",object=>{var _object$attributes$ti,_object$attributes;return(_object$attributes$ti=object===null||object===void 0?void 0:(_object$attributes=object.attributes)===null||_object$attributes===void 0?void 0:_object$attributes.title)!==null&&_object$attributes$ti!==void 0?_object$attributes$ti:""});const{serviceRegistry:serviceRegistry,serviceName:serviceName}=props;const _type=serviceRegistry.get(serviceName).service.type;this.state={object:undefined,type:_type}}componentDidMount(){const{id:id,savedObjectsClient:savedObjectsClient}=this.props;const{type:type}=this.state;savedObjectsClient.get(type,id).then(object=>{this.setState({object:object})})}render(){const{capabilities:capabilities,notFoundType:notFoundType,serviceRegistry:serviceRegistry,id:id,serviceName:serviceName,savedObjectsClient:savedObjectsClient}=this.props;const{type:type}=this.state;const{object:object}=this.state;const{edit:canEdit,delete:canDelete}=capabilities.savedObjectsManagement;const canView=Object(lib["canViewInApp"])(capabilities,type);const service=serviceRegistry.get(serviceName).service;return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPageContent"],{horizontalPosition:"center","data-test-subj":"savedObjectsEdit"},external_osdSharedDeps_React_default.a.createElement(Header,{canEdit:canEdit,canDelete:canDelete,canViewInApp:canView,type:type,onDeleteClick:()=>this.delete(),viewUrl:service.urlFor(id)}),notFoundType&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(NotFoundErrors,{type:notFoundType})),canEdit&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(Intro,null)),object&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(form_Form,{object:object,savedObjectsClient:savedObjectsClient,service:service,editionEnabled:canEdit,onSave:this.saveChanges})))}async delete(){var _object$attributes2;const{id:id,savedObjectsClient:savedObjectsClient,overlays:overlays,notifications:notifications}=this.props;const{type:type,object:object}=this.state;const confirmed=await overlays.openConfirm(external_osdSharedDeps_OsdI18n_["i18n"].translate("savedObjectsManagement.deleteConfirm.modalDescription",{defaultMessage:"This action permanently removes the object from OpenSearch Dashboards."}),{confirmButtonText:external_osdSharedDeps_OsdI18n_["i18n"].translate("savedObjectsManagement.deleteConfirm.modalDeleteButtonLabel",{defaultMessage:"Delete"}),title:external_osdSharedDeps_OsdI18n_["i18n"].translate("savedObjectsManagement.deleteConfirm.modalTitle",{defaultMessage:"Delete '{title}'?",values:{title:(object===null||object===void 0?void 0:(_object$attributes2=object.attributes)===null||_object$attributes2===void 0?void 0:_object$attributes2.title)||"saved OpenSearch Dashboards object"}}),buttonColor:"danger"});if(confirmed){this.props.uiActions.getTrigger(triggers["a"]).exec({type:type,savedObjectId:id});await savedObjectsClient.delete(type,id);notifications.toasts.addSuccess("Deleted ".concat(this.formatTitle(object)," ").concat(type," object"));this.redirectToListing()}}redirectToListing(){this.props.history.push("/")}}const SavedObjectsEditionPage=_ref=>{let{coreStart:coreStart,uiActionsStart:uiActionsStart,serviceRegistry:serviceRegistry,setBreadcrumbs:setBreadcrumbs,history:history}=_ref;const{service:serviceName,id:id}=Object(external_osdSharedDeps_ReactRouterDom_["useParams"])();const capabilities=coreStart.application.capabilities;const{search:search}=Object(external_osdSharedDeps_ReactRouterDom_["useLocation"])();const query=Object(query_string["parse"])(search);const service=serviceRegistry.get(serviceName);Object(external_osdSharedDeps_React_["useEffect"])(()=>{var _service$service$type;setBreadcrumbs([{text:external_osdSharedDeps_OsdI18n_["i18n"].translate("savedObjectsManagement.breadcrumb.index",{defaultMessage:"Saved objects"}),href:"/"},{text:external_osdSharedDeps_OsdI18n_["i18n"].translate("savedObjectsManagement.breadcrumb.edit",{defaultMessage:"Edit {savedObjectType}",values:{savedObjectType:(_service$service$type=service===null||service===void 0?void 0:service.service.type)!==null&&_service$service$type!==void 0?_service$service$type:"object"}})}])},[setBreadcrumbs,service]);return external_osdSharedDeps_React_default.a.createElement(saved_object_view_SavedObjectEdition,{id:id,serviceName:serviceName,serviceRegistry:serviceRegistry,savedObjectsClient:coreStart.savedObjects.client,overlays:coreStart.overlays,notifications:coreStart.notifications,uiActions:uiActionsStart,capabilities:capabilities,notFoundType:query.notFound,history:history})}}}]);