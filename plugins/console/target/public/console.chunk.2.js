(window["console_bundle_jsonpfunction"]=window["console_bundle_jsonpfunction"]||[]).push([[2],{51:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"renderApp",(function(){return renderApp}));var external_osdSharedDeps_React_=__webpack_require__(16);var external_osdSharedDeps_React_default=__webpack_require__.n(external_osdSharedDeps_React_);var external_osdSharedDeps_ReactDom_=__webpack_require__(24);const ServicesContext=Object(external_osdSharedDeps_React_["createContext"])(null);function ServicesContextProvider(_ref){let{children:children,value:value}=_ref;Object(external_osdSharedDeps_React_["useEffect"])(()=>{value.services.opensearchHostService.init()},[value.services.opensearchHostService]);return external_osdSharedDeps_React_default.a.createElement(ServicesContext.Provider,{value:value},children)}const useServicesContext=()=>{const context=Object(external_osdSharedDeps_React_["useContext"])(ServicesContext);if(context===undefined){throw new Error("useServicesContext must be used inside the ServicesContextProvider.")}return context};const createUseContext=(Ctx,name)=>()=>{const ctx=Object(external_osdSharedDeps_React_["useContext"])(Ctx);if(!ctx){throw new Error("".concat(name," should be used inside of ").concat(name,"Provider!"))}return ctx};var dist=__webpack_require__(32);var lib_function=__webpack_require__(33);const initialResultValue={data:null,type:"unknown"};const initialValue=Object(dist["produce"])({requestInFlight:false,lastResult:initialResultValue},lib_function["identity"]);const reducer=(state,action)=>Object(dist["produce"])(state,draft=>{if(action.type==="sendRequest"){draft.requestInFlight=true;draft.lastResult=initialResultValue;return}if(action.type==="requestSuccess"){draft.requestInFlight=false;draft.lastResult=action.payload;return}if(action.type==="requestFail"){draft.requestInFlight=false;draft.lastResult={...initialResultValue,error:action.payload};return}if(action.type==="resetLastResult"){draft.lastResult=initialResultValue;return}return draft});const RequestReadContext=Object(external_osdSharedDeps_React_["createContext"])(null);const RequestActionContext=Object(external_osdSharedDeps_React_["createContext"])(null);function RequestContextProvider(_ref){let{children:children}=_ref;const[state,dispatch]=Object(external_osdSharedDeps_React_["useReducer"])(reducer,initialValue);return external_osdSharedDeps_React_default.a.createElement(RequestReadContext.Provider,{value:state},external_osdSharedDeps_React_default.a.createElement(RequestActionContext.Provider,{value:dispatch},children))}const useRequestReadContext=createUseContext(RequestReadContext,"RequestReadContext");const useRequestActionContext=createUseContext(RequestActionContext,"RequestActionContext");const editor_initialValue=Object(dist["produce"])({ready:false,settings:null,currentTextObject:null},lib_function["identity"]);const editor_reducer=(state,action)=>Object(dist["produce"])(state,draft=>{if(action.type==="setInputEditor"){if(action.payload){draft.ready=true}return}if(action.type==="updateSettings"){draft.settings=action.payload;return}if(action.type==="setCurrentTextObject"){draft.currentTextObject=action.payload;return}return draft});const EditorReadContext=Object(external_osdSharedDeps_React_["createContext"])(null);const EditorActionContext=Object(external_osdSharedDeps_React_["createContext"])(null);function EditorContextProvider(_ref){let{children:children,settings:settings}=_ref;const[state,dispatch]=Object(external_osdSharedDeps_React_["useReducer"])(editor_reducer,editor_initialValue,value=>({...value,settings:settings}));return external_osdSharedDeps_React_default.a.createElement(EditorReadContext.Provider,{value:state},external_osdSharedDeps_React_default.a.createElement(EditorActionContext.Provider,{value:dispatch},children))}const useEditorReadContext=createUseContext(EditorReadContext,"EditorReadContext");const useEditorActionContext=createUseContext(EditorActionContext,"EditorActionContext");var external_osdSharedDeps_OsdI18n_=__webpack_require__(1);var file_saver=__webpack_require__(37);var external_osdSharedDeps_ElasticEui_=__webpack_require__(18);var external_osdSharedDeps_Lodash_=__webpack_require__(17);var external_osdSharedDeps_Lodash_default=__webpack_require__.n(external_osdSharedDeps_Lodash_);var external_osdSharedDeps_Moment_=__webpack_require__(21);var external_osdSharedDeps_Moment_default=__webpack_require__.n(external_osdSharedDeps_Moment_);var public_=__webpack_require__(25);function subscribeResizeChecker(el){for(var _len=arguments.length,editors=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){editors[_key-1]=arguments[_key]}const checker=new public_["ResizeChecker"](el);checker.on("resize",()=>editors.forEach(e=>{if(e.getCoreEditor){e.getCoreEditor().resize()}else{e.resize()}if(e.updateActionsBar){e.updateActionsBar()}}));return()=>checker.destroy()}var brace=__webpack_require__(28);var brace_default=__webpack_require__.n(brace);var worker_worker="/*\n * SPDX-License-Identifier: Apache-2.0\n *\n * The OpenSearch Contributors require contributions made to\n * this file be licensed under the Apache-2.0 license or a\n * compatible open source license.\n *\n * Any modifications Copyright OpenSearch Contributors. See\n * GitHub history for details.\n */\n\n/*\n * Licensed to Elasticsearch B.V. under one or more contributor\n * license agreements. See the NOTICE file distributed with\n * this work for additional information regarding copyright\n * ownership. Elasticsearch B.V. licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/* @notice\n *\n * This product includes code that is based on Ace editor, which was available\n * under a \"BSD\" license.\n *\n * Distributed under the BSD license:\n *\n * Copyright (c) 2010, Ajax.org B.V.\n * All rights reserved.\n *\n *  Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *     * Redistributions of source code must retain the above copyright\n *       notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above copyright\n *       notice, this list of conditions and the following disclaimer in the\n *       documentation and/or other materials provided with the distribution.\n *     * Neither the name of Ajax.org B.V. nor the\n *       names of its contributors may be used to endorse or promote products\n *       derived from this software without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* eslint-disable */\n/*\n  This file is loaded up as a blob by Brace to hand to Ace to load as Jsonp\n  (hence the redefining of everything).  It is based on the javascript\n  mode from the brace distro.\n*/\n\n(function (window) {\n  function resolveModuleId(id, paths) {\n    for (let testPath = id, tail = ''; testPath;) {\n      let alias = paths[testPath];\n      if ('string' === typeof alias) return alias + tail;\n      if (alias)\n        {return (\n          alias.location.replace(/\\/*$/, '/') +\n          (tail || alias.main || alias.name)\n        );}\n      if (alias === !1) return '';\n      let i = testPath.lastIndexOf('/');\n      if (-1 === i) break;\n      (tail = testPath.substr(i) + tail), (testPath = testPath.slice(0, i));\n    }\n    return id;\n  }\n  if (\n    !(\n      (void 0 !== window.window && window.document) ||\n      (window.acequire && window.define)\n    )\n  ) {\n    window.console ||\n      ((window.console = function () {\n        let msgs = Array.prototype.slice.call(arguments, 0);\n        postMessage({ type: 'log', data: msgs });\n      }),\n        (window.console.error = window.console.warn = window.console.log = window.console.trace =\n        window.console)),\n    (window.window = window),\n    (window.ace = window),\n    (window.onerror = function (message, file, line, col, err) {\n      postMessage({\n        type: 'error',\n        data: {\n          message: message,\n          data: err.data,\n          file: file,\n          line: line,\n          col: col,\n          stack: err.stack,\n        },\n      });\n    }),\n    (window.normalizeModule = function (parentId, moduleName) {\n      if (-1 !== moduleName.indexOf('!')) {\n        let chunks = moduleName.split('!');\n        return (\n          window.normalizeModule(parentId, chunks[0]) +\n            '!' +\n            window.normalizeModule(parentId, chunks[1])\n        );\n      }\n      if ('.' == moduleName.charAt(0)) {\n        let base = parentId\n          .split('/')\n          .slice(0, -1)\n          .join('/');\n        for (\n          moduleName = (base ? base + '/' : '') + moduleName;\n          -1 !== moduleName.indexOf('.') && previous != moduleName;\n\n        ) {\n          var previous = moduleName;\n          moduleName = moduleName\n            .replace(/^\\.\\//, '')\n            .replace(/\\/\\.\\//, '/')\n            .replace(/[^\\/]+\\/\\.\\.\\//, '');\n        }\n      }\n      return moduleName;\n    }),\n    (window.acequire = function acequire(parentId, id) {\n      if ((id || ((id = parentId), (parentId = null)), !id.charAt))\n        {throw Error(\n            'worker.js acequire() accepts only (parentId, id) as arguments'\n          );}\n      id = window.normalizeModule(parentId, id);\n      let module = window.acequire.modules[id];\n      if (module)\n        {return (\n            module.initialized ||\n              ((module.initialized = !0),\n              (module.exports = module.factory().exports)),\n            module.exports\n          );}\n      if (!window.acequire.tlns) return console.log('unable to load ' + id);\n      let path = resolveModuleId(id, window.acequire.tlns);\n      return (\n        '.js' != path.slice(-3) && (path += '.js'),\n        (window.acequire.id = id),\n        (window.acequire.modules[id] = {}),\n        importScripts(path),\n        window.acequire(parentId, id)\n      );\n    }),\n    (window.acequire.modules = {}),\n    (window.acequire.tlns = {}),\n    (window.define = function (id, deps, factory) {\n      if (\n        (2 == arguments.length\n          ? ((factory = deps),\n            'string' !== typeof id && ((deps = id), (id = window.acequire.id)))\n          : 1 == arguments.length &&\n              ((factory = id), (deps = []), (id = window.acequire.id)),\n          'function' !== typeof factory)\n      )\n        {return (\n            (window.acequire.modules[id] = {\n              exports: factory,\n              initialized: !0,\n            }),\n            void 0\n          );}\n      deps.length || (deps = ['require', 'exports', 'module']);\n      let req = function (childId) {\n        return window.acequire(id, childId);\n      };\n      window.acequire.modules[id] = {\n        exports: {},\n        factory: function () {\n          let module = this,\n            returnExports = factory.apply(\n              this,\n              deps.map(function (dep) {\n                switch (dep) {\n                  case 'require':\n                    return req;\n                  case 'exports':\n                    return module.exports;\n                  case 'module':\n                    return module;\n                  default:\n                    return req(dep);\n                }\n              })\n            );\n          return returnExports && (module.exports = returnExports), module;\n        },\n      };\n    }),\n    (window.define.amd = {}),\n    (acequire.tlns = {}),\n    (window.initBaseUrls = function (topLevelNamespaces) {\n      for (let i in topLevelNamespaces)\n        {acequire.tlns[i] = topLevelNamespaces[i];}\n    }),\n    (window.initSender = function () {\n      let EventEmitter = window.acequire('ace/lib/event_emitter')\n          .EventEmitter,\n        oop = window.acequire('ace/lib/oop'),\n        Sender = function () {};\n      return (\n        function () {\n          oop.implement(this, EventEmitter),\n          (this.callback = function (data, callbackId) {\n            postMessage({ type: 'call', id: callbackId, data: data });\n          }),\n          (this.emit = function (name, data) {\n            postMessage({ type: 'event', name: name, data: data });\n          });\n        }.call(Sender.prototype),\n        new Sender()\n      );\n    });\n    let main = (window.main = null),\n      sender = (window.sender = null);\n    window.onmessage = function (e) {\n      let msg = e.data;\n      if (msg.event && sender) sender._signal(msg.event, msg.data);\n      else if (msg.command)\n        {if (main[msg.command]) main[msg.command].apply(main, msg.args);\n        else {\n          if (!window[msg.command])\n            throw Error('Unknown command:' + msg.command);\n          window[msg.command].apply(window, msg.args);\n        }}\n      else if (msg.init) {\n        window.initBaseUrls(msg.tlns),\n        acequire('ace/lib/es5-shim'),\n        (sender = window.sender = window.initSender());\n        let clazz = acequire(msg.module)[msg.classname];\n        main = window.main = new clazz(sender);\n      }\n    };\n  }\n}(this)),\nace.define('ace/lib/oop', ['require', 'exports', 'module'], function (\n  acequire,\n  exports\n) {\n  (exports.inherits = function (ctor, superCtor) {\n    (ctor.super_ = superCtor),\n    (ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: !1,\n        writable: !0,\n        configurable: !0,\n      },\n    }));\n  }),\n  (exports.mixin = function (obj, mixin) {\n    for (let key in mixin) obj[key] = mixin[key];\n    return obj;\n  }),\n  (exports.implement = function (proto, mixin) {\n    exports.mixin(proto, mixin);\n  });\n}),\nace.define('ace/range', ['require', 'exports', 'module'], function (\n  acequire,\n  exports\n) {\n  let comparePoints = function (p1, p2) {\n      return p1.row - p2.row || p1.column - p2.column;\n    },\n    Range = function (startRow, startColumn, endRow, endColumn) {\n      (this.start = { row: startRow, column: startColumn }),\n      (this.end = { row: endRow, column: endColumn });\n    };\n  (function () {\n    (this.isEqual = function (range) {\n      return (\n        this.start.row === range.start.row &&\n          this.end.row === range.end.row &&\n          this.start.column === range.start.column &&\n          this.end.column === range.end.column\n      );\n    }),\n    (this.toString = function () {\n      return (\n        'Range: [' +\n            this.start.row +\n            '/' +\n            this.start.column +\n            '] -> [' +\n            this.end.row +\n            '/' +\n            this.end.column +\n            ']'\n      );\n    }),\n    (this.contains = function (row, column) {\n      return 0 == this.compare(row, column);\n    }),\n    (this.compareRange = function (range) {\n      let cmp,\n        end = range.end,\n        start = range.start;\n      return (\n        (cmp = this.compare(end.row, end.column)),\n        1 == cmp\n          ? ((cmp = this.compare(start.row, start.column)),\n            1 == cmp ? 2 : 0 == cmp ? 1 : 0)\n          : -1 == cmp\n            ? -2\n            : ((cmp = this.compare(start.row, start.column)),\n              -1 == cmp ? -1 : 1 == cmp ? 42 : 0)\n      );\n    }),\n    (this.comparePoint = function (p) {\n      return this.compare(p.row, p.column);\n    }),\n    (this.containsRange = function (range) {\n      return (\n        0 == this.comparePoint(range.start) &&\n            0 == this.comparePoint(range.end)\n      );\n    }),\n    (this.intersects = function (range) {\n      let cmp = this.compareRange(range);\n      return -1 == cmp || 0 == cmp || 1 == cmp;\n    }),\n    (this.isEnd = function (row, column) {\n      return this.end.row == row && this.end.column == column;\n    }),\n    (this.isStart = function (row, column) {\n      return this.start.row == row && this.start.column == column;\n    }),\n    (this.setStart = function (row, column) {\n      'object' === typeof row\n        ? ((this.start.column = row.column), (this.start.row = row.row))\n        : ((this.start.row = row), (this.start.column = column));\n    }),\n    (this.setEnd = function (row, column) {\n      'object' === typeof row\n        ? ((this.end.column = row.column), (this.end.row = row.row))\n        : ((this.end.row = row), (this.end.column = column));\n    }),\n    (this.inside = function (row, column) {\n      return 0 == this.compare(row, column)\n        ? this.isEnd(row, column) || this.isStart(row, column)\n          ? !1\n          : !0\n        : !1;\n    }),\n    (this.insideStart = function (row, column) {\n      return 0 == this.compare(row, column)\n        ? this.isEnd(row, column)\n          ? !1\n          : !0\n        : !1;\n    }),\n    (this.insideEnd = function (row, column) {\n      return 0 == this.compare(row, column)\n        ? this.isStart(row, column)\n          ? !1\n          : !0\n        : !1;\n    }),\n    (this.compare = function (row, column) {\n      return this.isMultiLine() || row !== this.start.row\n        ? this.start.row > row\n          ? -1\n          : row > this.end.row\n            ? 1\n            : this.start.row === row\n              ? column >= this.start.column\n                ? 0\n                : -1\n              : this.end.row === row\n                ? this.end.column >= column\n                  ? 0\n                  : 1\n                : 0\n        : this.start.column > column\n          ? -1\n          : column > this.end.column\n            ? 1\n            : 0;\n    }),\n    (this.compareStart = function (row, column) {\n      return this.start.row == row && this.start.column == column\n        ? -1\n        : this.compare(row, column);\n    }),\n    (this.compareEnd = function (row, column) {\n      return this.end.row == row && this.end.column == column\n        ? 1\n        : this.compare(row, column);\n    }),\n    (this.compareInside = function (row, column) {\n      return this.end.row == row && this.end.column == column\n        ? 1\n        : this.start.row == row && this.start.column == column\n          ? -1\n          : this.compare(row, column);\n    }),\n    (this.clipRows = function (firstRow, lastRow) {\n      if (this.end.row > lastRow) var end = { row: lastRow + 1, column: 0 };\n      else if (firstRow > this.end.row)\n        {var end = { row: firstRow, column: 0 };}\n      if (this.start.row > lastRow)\n        {var start = { row: lastRow + 1, column: 0 };}\n      else if (firstRow > this.start.row)\n        {var start = { row: firstRow, column: 0 };}\n      return Range.fromPoints(start || this.start, end || this.end);\n    }),\n    (this.extend = function (row, column) {\n      let cmp = this.compare(row, column);\n      if (0 == cmp) return this;\n      if (-1 == cmp) var start = { row: row, column: column };\n      else var end = { row: row, column: column };\n      return Range.fromPoints(start || this.start, end || this.end);\n    }),\n    (this.isEmpty = function () {\n      return (\n        this.start.row === this.end.row &&\n            this.start.column === this.end.column\n      );\n    }),\n    (this.isMultiLine = function () {\n      return this.start.row !== this.end.row;\n    }),\n    (this.clone = function () {\n      return Range.fromPoints(this.start, this.end);\n    }),\n    (this.collapseRows = function () {\n      return 0 == this.end.column\n        ? new Range(\n          this.start.row,\n          0,\n          Math.max(this.start.row, this.end.row - 1),\n          0\n        )\n        : new Range(this.start.row, 0, this.end.row, 0);\n    }),\n    (this.toScreenRange = function (session) {\n      let screenPosStart = session.documentToScreenPosition(this.start),\n        screenPosEnd = session.documentToScreenPosition(this.end);\n      return new Range(\n        screenPosStart.row,\n        screenPosStart.column,\n        screenPosEnd.row,\n        screenPosEnd.column\n      );\n    }),\n    (this.moveBy = function (row, column) {\n      (this.start.row += row),\n      (this.start.column += column),\n      (this.end.row += row),\n      (this.end.column += column);\n    });\n  }.call(Range.prototype),\n    (Range.fromPoints = function (start, end) {\n      return new Range(start.row, start.column, end.row, end.column);\n    }),\n    (Range.comparePoints = comparePoints),\n    (Range.comparePoints = function (p1, p2) {\n      return p1.row - p2.row || p1.column - p2.column;\n    }),\n    (exports.Range = Range));\n}),\nace.define('ace/apply_delta', ['require', 'exports', 'module'], function (\n  acequire,\n  exports\n) {\n  exports.applyDelta = function (docLines, delta) {\n    let row = delta.start.row,\n      startColumn = delta.start.column,\n      line = docLines[row] || '';\n    switch (delta.action) {\n      case 'insert':\n        var lines = delta.lines;\n        if (1 === lines.length)\n          {docLines[row] =\n              line.substring(0, startColumn) +\n              delta.lines[0] +\n              line.substring(startColumn);}\n        else {\n          let args = [row, 1].concat(delta.lines);\n          docLines.splice.apply(docLines, args),\n          (docLines[row] = line.substring(0, startColumn) + docLines[row]),\n          (docLines[row + delta.lines.length - 1] += line.substring(\n            startColumn\n          ));\n        }\n        break;\n      case 'remove':\n        var endColumn = delta.end.column,\n          endRow = delta.end.row;\n        row === endRow\n          ? (docLines[row] =\n                line.substring(0, startColumn) + line.substring(endColumn))\n          : docLines.splice(\n            row,\n            endRow - row + 1,\n            line.substring(0, startColumn) +\n                  docLines[endRow].substring(endColumn)\n          );\n    }\n  };\n}),\nace.define(\n  'ace/lib/event_emitter',\n  ['require', 'exports', 'module'],\n  function (acequire, exports) {\n    let EventEmitter = {},\n      stopPropagation = function () {\n        this.propagationStopped = !0;\n      },\n      preventDefault = function () {\n        this.defaultPrevented = !0;\n      };\n    (EventEmitter._emit = EventEmitter._dispatchEvent = function (\n      eventName,\n      e\n    ) {\n      this._eventRegistry || (this._eventRegistry = {}),\n      this._defaultHandlers || (this._defaultHandlers = {});\n      let listeners = this._eventRegistry[eventName] || [],\n        defaultHandler = this._defaultHandlers[eventName];\n      if (listeners.length || defaultHandler) {\n        ('object' === typeof e && e) || (e = {}),\n        e.type || (e.type = eventName),\n        e.stopPropagation || (e.stopPropagation = stopPropagation),\n        e.preventDefault || (e.preventDefault = preventDefault),\n        (listeners = listeners.slice());\n        for (\n          let i = 0;\n          listeners.length > i &&\n            (listeners[i](e, this), !e.propagationStopped);\n          i++\n        );\n        return defaultHandler && !e.defaultPrevented\n          ? defaultHandler(e, this)\n          : void 0;\n      }\n    }),\n    (EventEmitter._signal = function (eventName, e) {\n      let listeners = (this._eventRegistry || {})[eventName];\n      if (listeners) {\n        listeners = listeners.slice();\n        for (let i = 0; listeners.length > i; i++) listeners[i](e, this);\n      }\n    }),\n    (EventEmitter.once = function (eventName, callback) {\n      let _self = this;\n      callback &&\n            this.addEventListener(eventName, function newCallback() {\n              _self.removeEventListener(eventName, newCallback),\n              callback.apply(null, arguments);\n            });\n    }),\n    (EventEmitter.setDefaultHandler = function (eventName, callback) {\n      let handlers = this._defaultHandlers;\n      if (\n        (handlers ||\n              (handlers = this._defaultHandlers = { _disabled_: {} }),\n          handlers[eventName])\n      ) {\n        let old = handlers[eventName],\n          disabled = handlers._disabled_[eventName];\n        disabled || (handlers._disabled_[eventName] = disabled = []),\n        disabled.push(old);\n        let i = disabled.indexOf(callback);\n        -1 != i && disabled.splice(i, 1);\n      }\n      handlers[eventName] = callback;\n    }),\n    (EventEmitter.removeDefaultHandler = function (eventName, callback) {\n      let handlers = this._defaultHandlers;\n      if (handlers) {\n        let disabled = handlers._disabled_[eventName];\n        if (handlers[eventName] == callback)\n          {handlers[eventName],\n                disabled && this.setDefaultHandler(eventName, disabled.pop());}\n        else if (disabled) {\n          let i = disabled.indexOf(callback);\n          -1 != i && disabled.splice(i, 1);\n        }\n      }\n    }),\n    (EventEmitter.on = EventEmitter.addEventListener = function (\n      eventName,\n      callback,\n      capturing\n    ) {\n      this._eventRegistry = this._eventRegistry || {};\n      let listeners = this._eventRegistry[eventName];\n      return (\n        listeners || (listeners = this._eventRegistry[eventName] = []),\n        -1 == listeners.indexOf(callback) &&\n              listeners[capturing ? 'unshift' : 'push'](callback),\n        callback\n      );\n    }),\n    (EventEmitter.off = EventEmitter.removeListener = EventEmitter.removeEventListener = function (\n      eventName,\n      callback\n    ) {\n      this._eventRegistry = this._eventRegistry || {};\n      let listeners = this._eventRegistry[eventName];\n      if (listeners) {\n        let index = listeners.indexOf(callback);\n        -1 !== index && listeners.splice(index, 1);\n      }\n    }),\n    (EventEmitter.removeAllListeners = function (eventName) {\n      this._eventRegistry && (this._eventRegistry[eventName] = []);\n    }),\n    (exports.EventEmitter = EventEmitter);\n  }\n),\nace.define(\n  'ace/anchor',\n  ['require', 'exports', 'module', 'ace/lib/oop', 'ace/lib/event_emitter'],\n  function (acequire, exports) {\n    let oop = acequire('./lib/oop'),\n      EventEmitter = acequire('./lib/event_emitter').EventEmitter,\n      Anchor = (exports.Anchor = function (doc, row, column) {\n        (this.$onChange = this.onChange.bind(this)),\n        this.attach(doc),\n        column === void 0\n          ? this.setPosition(row.row, row.column)\n          : this.setPosition(row, column);\n      });\n    (function () {\n      function $pointsInOrder(point1, point2, equalPointsInOrder) {\n        let bColIsAfter = equalPointsInOrder\n          ? point1.column <= point2.column\n          : point1.column < point2.column;\n        return (\n          point1.row < point2.row || (point1.row == point2.row && bColIsAfter)\n        );\n      }\n      function $getTransformedPoint(delta, point, moveIfEqual) {\n        let deltaIsInsert = 'insert' == delta.action,\n          deltaRowShift =\n              (deltaIsInsert ? 1 : -1) * (delta.end.row - delta.start.row),\n          deltaColShift =\n              (deltaIsInsert ? 1 : -1) *\n              (delta.end.column - delta.start.column),\n          deltaStart = delta.start,\n          deltaEnd = deltaIsInsert ? deltaStart : delta.end;\n        return $pointsInOrder(point, deltaStart, moveIfEqual)\n          ? { row: point.row, column: point.column }\n          : $pointsInOrder(deltaEnd, point, !moveIfEqual)\n            ? {\n              row: point.row + deltaRowShift,\n              column:\n                    point.column +\n                    (point.row == deltaEnd.row ? deltaColShift : 0),\n            }\n            : { row: deltaStart.row, column: deltaStart.column };\n      }\n      oop.implement(this, EventEmitter),\n      (this.getPosition = function () {\n        return this.$clipPositionToDocument(this.row, this.column);\n      }),\n      (this.getDocument = function () {\n        return this.document;\n      }),\n      (this.$insertRight = !1),\n      (this.onChange = function (delta) {\n        if (\n          !(\n            (delta.start.row == delta.end.row &&\n                  delta.start.row != this.row) ||\n                delta.start.row > this.row\n          )\n        ) {\n          let point = $getTransformedPoint(\n            delta,\n            { row: this.row, column: this.column },\n            this.$insertRight\n          );\n          this.setPosition(point.row, point.column, !0);\n        }\n      }),\n      (this.setPosition = function (row, column, noClip) {\n        let pos;\n        if (\n          ((pos = noClip\n            ? { row: row, column: column }\n            : this.$clipPositionToDocument(row, column)),\n            this.row != pos.row || this.column != pos.column)\n        ) {\n          let old = { row: this.row, column: this.column };\n          (this.row = pos.row),\n          (this.column = pos.column),\n          this._signal('change', { old: old, value: pos });\n        }\n      }),\n      (this.detach = function () {\n        this.document.removeEventListener('change', this.$onChange);\n      }),\n      (this.attach = function (doc) {\n        (this.document = doc || this.document),\n        this.document.on('change', this.$onChange);\n      }),\n      (this.$clipPositionToDocument = function (row, column) {\n        let pos = {};\n        return (\n          row >= this.document.getLength()\n            ? ((pos.row = Math.max(0, this.document.getLength() - 1)),\n              (pos.column = this.document.getLine(pos.row).length))\n            : 0 > row\n              ? ((pos.row = 0), (pos.column = 0))\n              : ((pos.row = row),\n                (pos.column = Math.min(\n                  this.document.getLine(pos.row).length,\n                  Math.max(0, column)\n                ))),\n          0 > column && (pos.column = 0),\n          pos\n        );\n      });\n    }.call(Anchor.prototype));\n  }\n),\nace.define(\n  'ace/document',\n  [\n    'require',\n    'exports',\n    'module',\n    'ace/lib/oop',\n    'ace/apply_delta',\n    'ace/lib/event_emitter',\n    'ace/range',\n    'ace/anchor',\n  ],\n  function (acequire, exports) {\n    let oop = acequire('./lib/oop'),\n      applyDelta = acequire('./apply_delta').applyDelta,\n      EventEmitter = acequire('./lib/event_emitter').EventEmitter,\n      Range = acequire('./range').Range,\n      Anchor = acequire('./anchor').Anchor,\n      Document = function (textOrLines) {\n        (this.$lines = ['']),\n        0 === textOrLines.length\n          ? (this.$lines = [''])\n          : Array.isArray(textOrLines)\n            ? this.insertMergedLines({ row: 0, column: 0 }, textOrLines)\n            : this.insert({ row: 0, column: 0 }, textOrLines);\n      };\n    (function () {\n      oop.implement(this, EventEmitter),\n      (this.setValue = function (text) {\n        let len = this.getLength() - 1;\n        this.remove(new Range(0, 0, len, this.getLine(len).length)),\n        this.insert({ row: 0, column: 0 }, text);\n      }),\n      (this.getValue = function () {\n        return this.getAllLines().join(this.getNewLineCharacter());\n      }),\n      (this.createAnchor = function (row, column) {\n        return new Anchor(this, row, column);\n      }),\n      (this.$split =\n            0 === 'aaa'.split(/a/).length\n              ? function (text) {\n                return text.replace(/\\r\\n|\\r/g, '\\n').split('\\n');\n              }\n              : function (text) {\n                return text.split(/\\r\\n|\\r|\\n/);\n              }),\n      (this.$detectNewLine = function (text) {\n        let match = text.match(/^.*?(\\r\\n|\\r|\\n)/m);\n        (this.$autoNewLine = match ? match[1] : '\\n'),\n        this._signal('changeNewLineMode');\n      }),\n      (this.getNewLineCharacter = function () {\n        switch (this.$newLineMode) {\n          case 'windows':\n            return '\\r\\n';\n          case 'unix':\n            return '\\n';\n          default:\n            return this.$autoNewLine || '\\n';\n        }\n      }),\n      (this.$autoNewLine = ''),\n      (this.$newLineMode = 'auto'),\n      (this.setNewLineMode = function (newLineMode) {\n        this.$newLineMode !== newLineMode &&\n              ((this.$newLineMode = newLineMode),\n                this._signal('changeNewLineMode'));\n      }),\n      (this.getNewLineMode = function () {\n        return this.$newLineMode;\n      }),\n      (this.isNewLine = function (text) {\n        return '\\r\\n' == text || '\\r' == text || '\\n' == text;\n      }),\n      (this.getLine = function (row) {\n        return this.$lines[row] || '';\n      }),\n      (this.getLines = function (firstRow, lastRow) {\n        return this.$lines.slice(firstRow, lastRow + 1);\n      }),\n      (this.getAllLines = function () {\n        return this.getLines(0, this.getLength());\n      }),\n      (this.getLength = function () {\n        return this.$lines.length;\n      }),\n      (this.getTextRange = function (range) {\n        return this.getLinesForRange(range).join(\n          this.getNewLineCharacter()\n        );\n      }),\n      (this.getLinesForRange = function (range) {\n        let lines;\n        if (range.start.row === range.end.row)\n          {lines = [\n                this.getLine(range.start.row).substring(\n                  range.start.column,\n                  range.end.column\n                ),\n              ];}\n        else {\n          (lines = this.getLines(range.start.row, range.end.row)),\n          (lines[0] = (lines[0] || '').substring(range.start.column));\n          let l = lines.length - 1;\n          range.end.row - range.start.row == l &&\n                (lines[l] = lines[l].substring(0, range.end.column));\n        }\n        return lines;\n      }),\n      (this.insertLines = function (row, lines) {\n        return (\n          console.warn(\n            'Use of document.insertLines is deprecated. Use the insertFullLines method instead.'\n          ),\n          this.insertFullLines(row, lines)\n        );\n      }),\n      (this.removeLines = function (firstRow, lastRow) {\n        return (\n          console.warn(\n            'Use of document.removeLines is deprecated. Use the removeFullLines method instead.'\n          ),\n          this.removeFullLines(firstRow, lastRow)\n        );\n      }),\n      (this.insertNewLine = function (position) {\n        return (\n          console.warn(\n            'Use of document.insertNewLine is deprecated. Use insertMergedLines(position, [\\'\\', \\'\\']) instead.'\n          ),\n          this.insertMergedLines(position, ['', ''])\n        );\n      }),\n      (this.insert = function (position, text) {\n        return (\n          1 >= this.getLength() && this.$detectNewLine(text),\n          this.insertMergedLines(position, this.$split(text))\n        );\n      }),\n      (this.insertInLine = function (position, text) {\n        let start = this.clippedPos(position.row, position.column),\n          end = this.pos(position.row, position.column + text.length);\n        return (\n          this.applyDelta(\n            { start: start, end: end, action: 'insert', lines: [text] },\n            !0\n          ),\n          this.clonePos(end)\n        );\n      }),\n      (this.clippedPos = function (row, column) {\n        let length = this.getLength();\n        void 0 === row\n          ? (row = length)\n          : 0 > row\n            ? (row = 0)\n            : row >= length && ((row = length - 1), (column = void 0));\n        let line = this.getLine(row);\n        return (\n          void 0 == column && (column = line.length),\n          (column = Math.min(Math.max(column, 0), line.length)),\n          { row: row, column: column }\n        );\n      }),\n      (this.clonePos = function (pos) {\n        return { row: pos.row, column: pos.column };\n      }),\n      (this.pos = function (row, column) {\n        return { row: row, column: column };\n      }),\n      (this.$clipPosition = function (position) {\n        let length = this.getLength();\n        return (\n          position.row >= length\n            ? ((position.row = Math.max(0, length - 1)),\n              (position.column = this.getLine(length - 1).length))\n            : ((position.row = Math.max(0, position.row)),\n              (position.column = Math.min(\n                Math.max(position.column, 0),\n                this.getLine(position.row).length\n              ))),\n          position\n        );\n      }),\n      (this.insertFullLines = function (row, lines) {\n        row = Math.min(Math.max(row, 0), this.getLength());\n        let column = 0;\n        this.getLength() > row\n          ? ((lines = lines.concat([''])), (column = 0))\n          : ((lines = [''].concat(lines)),\n            row--,\n            (column = this.$lines[row].length)),\n        this.insertMergedLines({ row: row, column: column }, lines);\n      }),\n      (this.insertMergedLines = function (position, lines) {\n        let start = this.clippedPos(position.row, position.column),\n          end = {\n            row: start.row + lines.length - 1,\n            column:\n                  (1 == lines.length ? start.column : 0) +\n                  lines[lines.length - 1].length,\n          };\n        return (\n          this.applyDelta({\n            start: start,\n            end: end,\n            action: 'insert',\n            lines: lines,\n          }),\n          this.clonePos(end)\n        );\n      }),\n      (this.remove = function (range) {\n        let start = this.clippedPos(range.start.row, range.start.column),\n          end = this.clippedPos(range.end.row, range.end.column);\n        return (\n          this.applyDelta({\n            start: start,\n            end: end,\n            action: 'remove',\n            lines: this.getLinesForRange({ start: start, end: end }),\n          }),\n          this.clonePos(start)\n        );\n      }),\n      (this.removeInLine = function (row, startColumn, endColumn) {\n        let start = this.clippedPos(row, startColumn),\n          end = this.clippedPos(row, endColumn);\n        return (\n          this.applyDelta(\n            {\n              start: start,\n              end: end,\n              action: 'remove',\n              lines: this.getLinesForRange({ start: start, end: end }),\n            },\n            !0\n          ),\n          this.clonePos(start)\n        );\n      }),\n      (this.removeFullLines = function (firstRow, lastRow) {\n        (firstRow = Math.min(Math.max(0, firstRow), this.getLength() - 1)),\n        (lastRow = Math.min(Math.max(0, lastRow), this.getLength() - 1));\n        let deleteFirstNewLine =\n                lastRow == this.getLength() - 1 && firstRow > 0,\n          deleteLastNewLine = this.getLength() - 1 > lastRow,\n          startRow = deleteFirstNewLine ? firstRow - 1 : firstRow,\n          startCol = deleteFirstNewLine ? this.getLine(startRow).length : 0,\n          endRow = deleteLastNewLine ? lastRow + 1 : lastRow,\n          endCol = deleteLastNewLine ? 0 : this.getLine(endRow).length,\n          range = new Range(startRow, startCol, endRow, endCol),\n          deletedLines = this.$lines.slice(firstRow, lastRow + 1);\n        return (\n          this.applyDelta({\n            start: range.start,\n            end: range.end,\n            action: 'remove',\n            lines: this.getLinesForRange(range),\n          }),\n          deletedLines\n        );\n      }),\n      (this.removeNewLine = function (row) {\n        this.getLength() - 1 > row &&\n              row >= 0 &&\n              this.applyDelta({\n                start: this.pos(row, this.getLine(row).length),\n                end: this.pos(row + 1, 0),\n                action: 'remove',\n                lines: ['', ''],\n              });\n      }),\n      (this.replace = function (range, text) {\n        if (\n          (range instanceof Range ||\n                (range = Range.fromPoints(range.start, range.end)),\n            0 === text.length && range.isEmpty())\n        )\n          {return range.start;}\n        if (text == this.getTextRange(range)) return range.end;\n        this.remove(range);\n        let end;\n        return (end = text ? this.insert(range.start, text) : range.start);\n      }),\n      (this.applyDeltas = function (deltas) {\n        for (let i = 0; deltas.length > i; i++) this.applyDelta(deltas[i]);\n      }),\n      (this.revertDeltas = function (deltas) {\n        for (let i = deltas.length - 1; i >= 0; i--)\n          {this.revertDelta(deltas[i]);}\n      }),\n      (this.applyDelta = function (delta, doNotValidate) {\n        let isInsert = 'insert' == delta.action;\n        (isInsert\n          ? 1 >= delta.lines.length && !delta.lines[0]\n          : !Range.comparePoints(delta.start, delta.end)) ||\n              (isInsert &&\n                delta.lines.length > 2e4 &&\n                this.$splitAndapplyLargeDelta(delta, 2e4),\n                applyDelta(this.$lines, delta, doNotValidate),\n                this._signal('change', delta));\n      }),\n      (this.$splitAndapplyLargeDelta = function (delta, MAX) {\n        for (\n          let lines = delta.lines,\n            l = lines.length,\n            row = delta.start.row,\n            column = delta.start.column,\n            from = 0,\n            to = 0;\n          ;\n\n        ) {\n          (from = to), (to += MAX - 1);\n          let chunk = lines.slice(from, to);\n          if (to > l) {\n            (delta.lines = chunk),\n            (delta.start.row = row + from),\n            (delta.start.column = column);\n            break;\n          }\n          chunk.push(''),\n          this.applyDelta(\n            {\n              start: this.pos(row + from, column),\n              end: this.pos(row + to, (column = 0)),\n              action: delta.action,\n              lines: chunk,\n            },\n            !0\n          );\n        }\n      }),\n      (this.revertDelta = function (delta) {\n        this.applyDelta({\n          start: this.clonePos(delta.start),\n          end: this.clonePos(delta.end),\n          action: 'insert' == delta.action ? 'remove' : 'insert',\n          lines: delta.lines.slice(),\n        });\n      }),\n      (this.indexToPosition = function (index, startRow) {\n        for (\n          var lines = this.$lines || this.getAllLines(),\n            newlineLength = this.getNewLineCharacter().length,\n            i = startRow || 0,\n            l = lines.length;\n          l > i;\n          i++\n        )\n          {if (((index -= lines[i].length + newlineLength), 0 > index))\n                return {\n                  row: i,\n                  column: index + lines[i].length + newlineLength,\n                };}\n        return { row: l - 1, column: lines[l - 1].length };\n      }),\n      (this.positionToIndex = function (pos, startRow) {\n        for (\n          var lines = this.$lines || this.getAllLines(),\n            newlineLength = this.getNewLineCharacter().length,\n            index = 0,\n            row = Math.min(pos.row, lines.length),\n            i = startRow || 0;\n          row > i;\n          ++i\n        )\n          {index += lines[i].length + newlineLength;}\n        return index + pos.column;\n      });\n    }.call(Document.prototype),\n      (exports.Document = Document));\n  }\n),\nace.define('ace/lib/lang', ['require', 'exports', 'module'], function (\n  acequire,\n  exports\n) {\n  (exports.last = function (a) {\n    return a[a.length - 1];\n  }),\n  (exports.stringReverse = function (string) {\n    return string\n      .split('')\n      .reverse()\n      .join('');\n  }),\n  (exports.stringRepeat = function (string, count) {\n    for (var result = ''; count > 0;)\n      {1 & count && (result += string), (count >>= 1) && (string += string);}\n    return result;\n  });\n  let trimBeginRegexp = /^\\s\\s*/,\n    trimEndRegexp = /\\s\\s*$/;\n  (exports.stringTrimLeft = function (string) {\n    return string.replace(trimBeginRegexp, '');\n  }),\n  (exports.stringTrimRight = function (string) {\n    return string.replace(trimEndRegexp, '');\n  }),\n  (exports.copyObject = function (obj) {\n    let copy = {};\n    for (let key in obj) copy[key] = obj[key];\n    return copy;\n  }),\n  (exports.copyArray = function (array) {\n    for (var copy = [], i = 0, l = array.length; l > i; i++)\n      {copy[i] =\n            array[i] && 'object' == typeof array[i]\n              ? this.copyObject(array[i])\n              : array[i];}\n    return copy;\n  }),\n  (exports.deepCopy = function deepCopy(obj) {\n    if ('object' !== typeof obj || !obj) return obj;\n    let copy;\n    if (Array.isArray(obj)) {\n      copy = [];\n      for (var key = 0; obj.length > key; key++)\n        {copy[key] = deepCopy(obj[key]);}\n      return copy;\n    }\n    if ('[object Object]' !== Object.prototype.toString.call(obj))\n      {return obj;}\n    copy = {};\n    for (var key in obj) copy[key] = deepCopy(obj[key]);\n    return copy;\n  }),\n  (exports.arrayToMap = function (arr) {\n    for (var map = {}, i = 0; arr.length > i; i++) map[arr[i]] = 1;\n    return map;\n  }),\n  (exports.createMap = function (props) {\n    let map = Object.create(null);\n    for (let i in props) map[i] = props[i];\n    return map;\n  }),\n  (exports.arrayRemove = function (array, value) {\n    for (let i = 0; array.length >= i; i++)\n      {value === array[i] && array.splice(i, 1);}\n  }),\n  (exports.escapeRegExp = function (str) {\n    return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g, '\\\\$1');\n  }),\n  (exports.escapeHTML = function (str) {\n    return str\n      .replace(/&/g, '&#38;')\n      .replace(/\"/g, '&#34;')\n      .replace(/'/g, '&#39;')\n      .replace(/</g, '&#60;');\n  }),\n  (exports.getMatchOffsets = function (string, regExp) {\n    let matches = [];\n    return (\n      string.replace(regExp, function (str) {\n        matches.push({\n          offset: arguments[arguments.length - 2],\n          length: str.length,\n        });\n      }),\n      matches\n    );\n  }),\n  (exports.deferredCall = function (fcn) {\n    var timer = null,\n      callback = function () {\n        (timer = null), fcn();\n      },\n      deferred = function (timeout) {\n        return (\n          deferred.cancel(),\n          (timer = setTimeout(callback, timeout || 0)),\n          deferred\n        );\n      };\n    return (\n      (deferred.schedule = deferred),\n      (deferred.call = function () {\n        return this.cancel(), fcn(), deferred;\n      }),\n      (deferred.cancel = function () {\n        return clearTimeout(timer), (timer = null), deferred;\n      }),\n      (deferred.isPending = function () {\n        return timer;\n      }),\n      deferred\n    );\n  }),\n  (exports.delayedCall = function (fcn, defaultTimeout) {\n    let timer = null,\n      callback = function () {\n        (timer = null), fcn();\n      },\n      _self = function (timeout) {\n        null == timer &&\n              (timer = setTimeout(callback, timeout || defaultTimeout));\n      };\n    return (\n      (_self.delay = function (timeout) {\n        timer && clearTimeout(timer),\n        (timer = setTimeout(callback, timeout || defaultTimeout));\n      }),\n      (_self.schedule = _self),\n      (_self.call = function () {\n        this.cancel(), fcn();\n      }),\n      (_self.cancel = function () {\n        timer && clearTimeout(timer), (timer = null);\n      }),\n      (_self.isPending = function () {\n        return timer;\n      }),\n      _self\n    );\n  });\n}),\nace.define(\n  'ace/worker/mirror',\n  [\n    'require',\n    'exports',\n    'module',\n    'ace/range',\n    'ace/document',\n    'ace/lib/lang',\n  ],\n  function (acequire, exports) {\n    acequire('../range').Range;\n    let Document = acequire('../document').Document,\n      lang = acequire('../lib/lang'),\n      Mirror = (exports.Mirror = function (sender) {\n        this.sender = sender;\n        let doc = (this.doc = new Document('')),\n          deferredUpdate = (this.deferredUpdate = lang.delayedCall(\n            this.onUpdate.bind(this)\n          )),\n          _self = this;\n        sender.on('change', function (e) {\n          let data = e.data;\n          if (data[0].start) doc.applyDeltas(data);\n          else\n            {for (var i = 0; data.length > i; i += 2) {\n                if (Array.isArray(data[i + 1]))\n                  var d = {\n                    action: 'insert',\n                    start: data[i],\n                    lines: data[i + 1],\n                  };\n                else\n                  var d = {\n                    action: 'remove',\n                    start: data[i],\n                    end: data[i + 1],\n                  };\n                doc.applyDelta(d, !0);\n              }}\n          return _self.$timeout\n            ? deferredUpdate.schedule(_self.$timeout)\n            : (_self.onUpdate(), void 0);\n        });\n      });\n    (function () {\n      (this.$timeout = 500),\n      (this.setTimeout = function (timeout) {\n        this.$timeout = timeout;\n      }),\n      (this.setValue = function (value) {\n        this.doc.setValue(value),\n        this.deferredUpdate.schedule(this.$timeout);\n      }),\n      (this.getValue = function (callbackId) {\n        this.sender.callback(this.doc.getValue(), callbackId);\n      }),\n      (this.onUpdate = function () {}),\n      (this.isPending = function () {\n        return this.deferredUpdate.isPending();\n      });\n    }.call(Mirror.prototype));\n  }\n),\nace.define('ace/lib/es5-shim', ['require', 'exports', 'module'], function () {\n  function Empty() {}\n  function doesDefinePropertyWork(object) {\n    try {\n      return (\n        Object.defineProperty(object, 'sentinel', {}), 'sentinel' in object\n      );\n    } catch (exception) {}\n  }\n  function toInteger(n) {\n    return (\n      (n = +n),\n      n !== n\n        ? (n = 0)\n        : 0 !== n &&\n            n !== 1 / 0 &&\n            n !== -(1 / 0) &&\n            (n = (n > 0 || -1) * Math.floor(Math.abs(n))),\n      n\n    );\n  }\n  Function.prototype.bind ||\n      (Function.prototype.bind = function (that) {\n        let target = this;\n        if ('function' !== typeof target)\n          {throw new TypeError(\n            'Function.prototype.bind called on incompatible ' + target\n          );}\n        var args = slice.call(arguments, 1),\n          bound = function () {\n            if (this instanceof bound) {\n              let result = target.apply(\n                this,\n                args.concat(slice.call(arguments))\n              );\n              return Object(result) === result ? result : this;\n            }\n            return target.apply(that, args.concat(slice.call(arguments)));\n          };\n        return (\n          target.prototype &&\n            ((Empty.prototype = target.prototype),\n              (bound.prototype = new Empty()),\n              (Empty.prototype = null)),\n          bound\n        );\n      });\n  var defineGetter,\n    defineSetter,\n    lookupGetter,\n    lookupSetter,\n    supportsAccessors,\n    call = Function.prototype.call,\n    prototypeOfArray = Array.prototype,\n    prototypeOfObject = Object.prototype,\n    slice = prototypeOfArray.slice,\n    _toString = call.bind(prototypeOfObject.toString),\n    owns = call.bind(prototypeOfObject.hasOwnProperty);\n  if (\n    ((supportsAccessors = owns(prototypeOfObject, '__defineGetter__')) &&\n        ((defineGetter = call.bind(prototypeOfObject.__defineGetter__)),\n          (defineSetter = call.bind(prototypeOfObject.__defineSetter__)),\n          (lookupGetter = call.bind(prototypeOfObject.__lookupGetter__)),\n          (lookupSetter = call.bind(prototypeOfObject.__lookupSetter__))),\n      2 != [1, 2].splice(0).length)\n  )\n    {if (\n        (function() {\n          function makeArray(l) {\n            var a = Array(l + 2);\n            return (a[0] = a[1] = 0), a;\n          }\n          var lengthBefore,\n            array = [];\n          return (\n            array.splice.apply(array, makeArray(20)),\n            array.splice.apply(array, makeArray(26)),\n            (lengthBefore = array.length),\n            array.splice(5, 0, 'XXX'),\n            lengthBefore + 1 == array.length,\n            lengthBefore + 1 == array.length ? !0 : void 0\n          );\n        })()\n      ) {\n        var array_splice = Array.prototype.splice;\n        Array.prototype.splice = function(start, deleteCount) {\n          return arguments.length\n            ? array_splice.apply(\n                this,\n                [\n                  void 0 === start ? 0 : start,\n                  void 0 === deleteCount ? this.length - start : deleteCount,\n                ].concat(slice.call(arguments, 2))\n              )\n            : [];\n        };\n      } else\n        Array.prototype.splice = function(pos, removeCount) {\n          var length = this.length;\n          pos > 0\n            ? pos > length && (pos = length)\n            : void 0 == pos\n              ? (pos = 0)\n              : 0 > pos && (pos = Math.max(length + pos, 0)),\n            length > pos + removeCount || (removeCount = length - pos);\n          var removed = this.slice(pos, pos + removeCount),\n            insert = slice.call(arguments, 2),\n            add = insert.length;\n          if (pos === length) add && this.push.apply(this, insert);\n          else {\n            var remove = Math.min(removeCount, length - pos),\n              tailOldPos = pos + remove,\n              tailNewPos = tailOldPos + add - remove,\n              tailCount = length - tailOldPos,\n              lengthAfterRemove = length - remove;\n            if (tailOldPos > tailNewPos)\n              for (var i = 0; tailCount > i; ++i)\n                this[tailNewPos + i] = this[tailOldPos + i];\n            else if (tailNewPos > tailOldPos)\n              for (i = tailCount; i--; )\n                this[tailNewPos + i] = this[tailOldPos + i];\n            if (add && pos === lengthAfterRemove)\n              (this.length = lengthAfterRemove), this.push.apply(this, insert);\n            else\n              for (this.length = lengthAfterRemove + add, i = 0; add > i; ++i)\n                this[pos + i] = insert[i];\n          }\n          return removed;\n        };}\n  Array.isArray ||\n      (Array.isArray = function (obj) {\n        return '[object Array]' == _toString(obj);\n      });\n  let boxedString = Object('a'),\n    splitString = 'a' != boxedString[0] || !(0 in boxedString);\n  if (\n    (Array.prototype.forEach ||\n        (Array.prototype.forEach = function (fun) {\n          let object = toObject(this),\n            self =\n              splitString && '[object String]' == _toString(this)\n                ? this.split('')\n                : object,\n            thisp = arguments[1],\n            i = -1,\n            length = self.length >>> 0;\n          if ('[object Function]' != _toString(fun)) throw new TypeError();\n          for (; length > ++i;)\n            {i in self && fun.call(thisp, self[i], i, object);}\n        }),\n      Array.prototype.map ||\n        (Array.prototype.map = function (fun) {\n          let object = toObject(this),\n            self =\n              splitString && '[object String]' == _toString(this)\n                ? this.split('')\n                : object,\n            length = self.length >>> 0,\n            result = Array(length),\n            thisp = arguments[1];\n          if ('[object Function]' != _toString(fun))\n            {throw new TypeError(fun + ' is not a function');}\n          for (let i = 0; length > i; i++)\n            {i in self && (result[i] = fun.call(thisp, self[i], i, object));}\n          return result;\n        }),\n      Array.prototype.filter ||\n        (Array.prototype.filter = function (fun) {\n          let value,\n            object = toObject(this),\n            self =\n              splitString && '[object String]' == _toString(this)\n                ? this.split('')\n                : object,\n            length = self.length >>> 0,\n            result = [],\n            thisp = arguments[1];\n          if ('[object Function]' != _toString(fun))\n            {throw new TypeError(fun + ' is not a function');}\n          for (let i = 0; length > i; i++)\n            {i in self &&\n              ((value = self[i]),\n              fun.call(thisp, value, i, object) && result.push(value));}\n          return result;\n        }),\n      Array.prototype.every ||\n        (Array.prototype.every = function (fun) {\n          let object = toObject(this),\n            self =\n              splitString && '[object String]' == _toString(this)\n                ? this.split('')\n                : object,\n            length = self.length >>> 0,\n            thisp = arguments[1];\n          if ('[object Function]' != _toString(fun))\n            {throw new TypeError(fun + ' is not a function');}\n          for (let i = 0; length > i; i++)\n            {if (i in self && !fun.call(thisp, self[i], i, object)) return !1;}\n          return !0;\n        }),\n      Array.prototype.some ||\n        (Array.prototype.some = function (fun) {\n          let object = toObject(this),\n            self =\n              splitString && '[object String]' == _toString(this)\n                ? this.split('')\n                : object,\n            length = self.length >>> 0,\n            thisp = arguments[1];\n          if ('[object Function]' != _toString(fun))\n            {throw new TypeError(fun + ' is not a function');}\n          for (let i = 0; length > i; i++)\n            {if (i in self && fun.call(thisp, self[i], i, object)) return !0;}\n          return !1;\n        }),\n      Array.prototype.reduce ||\n        (Array.prototype.reduce = function (fun) {\n          let object = toObject(this),\n            self =\n              splitString && '[object String]' == _toString(this)\n                ? this.split('')\n                : object,\n            length = self.length >>> 0;\n          if ('[object Function]' != _toString(fun))\n            {throw new TypeError(fun + ' is not a function');}\n          if (!length && 1 == arguments.length)\n            {throw new TypeError('reduce of empty array with no initial value');}\n          let result,\n            i = 0;\n          if (arguments.length >= 2) result = arguments[1];\n          else\n            {for (;;) {\n              if (i in self) {\n                result = self[i++];\n                break;\n              }\n              if (++i >= length)\n                throw new TypeError(\n                  'reduce of empty array with no initial value'\n                );\n            }}\n          for (; length > i; i++)\n            {i in self &&\n              (result = fun.call(void 0, result, self[i], i, object));}\n          return result;\n        }),\n      Array.prototype.reduceRight ||\n        (Array.prototype.reduceRight = function (fun) {\n          let object = toObject(this),\n            self =\n              splitString && '[object String]' == _toString(this)\n                ? this.split('')\n                : object,\n            length = self.length >>> 0;\n          if ('[object Function]' != _toString(fun))\n            {throw new TypeError(fun + ' is not a function');}\n          if (!length && 1 == arguments.length)\n            {throw new TypeError(\n              'reduceRight of empty array with no initial value'\n            );}\n          let result,\n            i = length - 1;\n          if (arguments.length >= 2) result = arguments[1];\n          else\n            {for (;;) {\n              if (i in self) {\n                result = self[i--];\n                break;\n              }\n              if (0 > --i)\n                throw new TypeError(\n                  'reduceRight of empty array with no initial value'\n                );\n            }}\n          do\n            {i in this &&\n              (result = fun.call(void 0, result, self[i], i, object));}\n          while (i--);\n          return result;\n        }),\n      (Array.prototype.indexOf && -1 == [0, 1].indexOf(1, 2)) ||\n        (Array.prototype.indexOf = function (sought) {\n          let self =\n              splitString && '[object String]' == _toString(this)\n                ? this.split('')\n                : toObject(this),\n            length = self.length >>> 0;\n          if (!length) return -1;\n          let i = 0;\n          for (\n            arguments.length > 1 && (i = toInteger(arguments[1])),\n            i = i >= 0 ? i : Math.max(0, length + i);\n            length > i;\n            i++\n          )\n            {if (i in self && self[i] === sought) return i;}\n          return -1;\n        }),\n      (Array.prototype.lastIndexOf && -1 == [0, 1].lastIndexOf(0, -3)) ||\n        (Array.prototype.lastIndexOf = function (sought) {\n          let self =\n              splitString && '[object String]' == _toString(this)\n                ? this.split('')\n                : toObject(this),\n            length = self.length >>> 0;\n          if (!length) return -1;\n          let i = length - 1;\n          for (\n            arguments.length > 1 && (i = Math.min(i, toInteger(arguments[1]))),\n            i = i >= 0 ? i : length - Math.abs(i);\n            i >= 0;\n            i--\n          )\n            {if (i in self && sought === self[i]) return i;}\n          return -1;\n        }),\n      Object.getPrototypeOf ||\n        (Object.getPrototypeOf = function (object) {\n          return (\n            object.__proto__ ||\n            (object.constructor\n              ? object.constructor.prototype\n              : prototypeOfObject)\n          );\n        }),\n      !Object.getOwnPropertyDescriptor)\n  ) {\n    let ERR_NON_OBJECT =\n        'Object.getOwnPropertyDescriptor called on a non-object: ';\n    Object.getOwnPropertyDescriptor = function (object, property) {\n      if (\n        ('object' !== typeof object && 'function' !== typeof object) ||\n          null === object\n      )\n        {throw new TypeError(ERR_NON_OBJECT + object);}\n      if (owns(object, property)) {\n        var descriptor, getter, setter;\n        if (\n          ((descriptor = { enumerable: !0, configurable: !0 }),\n            supportsAccessors)\n        ) {\n          let prototype = object.__proto__;\n          object.__proto__ = prototypeOfObject;\n          var getter = lookupGetter(object, property),\n            setter = lookupSetter(object, property);\n          if (((object.__proto__ = prototype), getter || setter))\n            {return (\n                getter && (descriptor.get = getter),\n                setter && (descriptor.set = setter),\n                descriptor\n              );}\n        }\n        return (descriptor.value = object[property]), descriptor;\n      }\n    };\n  }\n  if (\n    (Object.getOwnPropertyNames ||\n        (Object.getOwnPropertyNames = function (object) {\n          return Object.keys(object);\n        }),\n      !Object.create)\n  ) {\n    let createEmpty;\n    (createEmpty =\n        null === Object.prototype.__proto__\n          ? function () {\n            return { __proto__: null };\n          }\n          : function () {\n            let empty = {};\n            for (let i in empty) empty[i] = null;\n            return (\n              (empty.constructor = empty.hasOwnProperty = empty.propertyIsEnumerable = empty.isPrototypeOf = empty.toLocaleString = empty.toString = empty.valueOf = empty.__proto__ = null),\n              empty\n            );\n          }),\n    (Object.create = function (prototype, properties) {\n      let object;\n      if (null === prototype) object = createEmpty();\n      else {\n        if ('object' !== typeof prototype)\n          {throw new TypeError(\n                'typeof prototype[' + typeof prototype + \"] != 'object'\"\n              );}\n        let Type = function () {};\n        (Type.prototype = prototype),\n        (object = new Type()),\n        (object.__proto__ = prototype);\n      }\n      return (\n        void 0 !== properties &&\n              Object.defineProperties(object, properties),\n        object\n      );\n    });\n  }\n  if (Object.defineProperty) {\n    let definePropertyWorksOnObject = doesDefinePropertyWork({}),\n      definePropertyWorksOnDom =\n          'undefined' === typeof document ||\n          doesDefinePropertyWork(document.createElement('div'));\n    if (!definePropertyWorksOnObject || !definePropertyWorksOnDom)\n      {var definePropertyFallback = Object.defineProperty;}\n  }\n  if (!Object.defineProperty || definePropertyFallback) {\n    let ERR_NON_OBJECT_DESCRIPTOR =\n          'Property description must be an object: ',\n      ERR_NON_OBJECT_TARGET = 'Object.defineProperty called on non-object: ',\n      ERR_ACCESSORS_NOT_SUPPORTED =\n          'getters & setters can not be defined on this javascript engine';\n    Object.defineProperty = function (object, property, descriptor) {\n      if (\n        ('object' !== typeof object && 'function' !== typeof object) ||\n          null === object\n      )\n        {throw new TypeError(ERR_NON_OBJECT_TARGET + object);}\n      if (\n        ('object' !== typeof descriptor && 'function' !== typeof descriptor) ||\n          null === descriptor\n      )\n        {throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR + descriptor);}\n      if (definePropertyFallback)\n        {try {\n            return definePropertyFallback.call(\n              Object,\n              object,\n              property,\n              descriptor\n            );\n          } catch (exception) {}}\n      if (owns(descriptor, 'value'))\n        {if (\n            supportsAccessors &&\n            (lookupGetter(object, property) || lookupSetter(object, property))\n          ) {\n            var prototype = object.__proto__;\n            (object.__proto__ = prototypeOfObject),\n              delete object[property],\n              (object[property] = descriptor.value),\n              (object.__proto__ = prototype);\n          } else object[property] = descriptor.value;}\n      else {\n        if (!supportsAccessors)\n          {throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);}\n        owns(descriptor, 'get') &&\n            defineGetter(object, property, descriptor.get),\n        owns(descriptor, 'set') &&\n              defineSetter(object, property, descriptor.set);\n      }\n      return object;\n    };\n  }\n  Object.defineProperties ||\n      (Object.defineProperties = function (object, properties) {\n        for (let property in properties)\n          {owns(properties, property) &&\n            Object.defineProperty(object, property, properties[property]);}\n        return object;\n      }),\n  Object.seal ||\n        (Object.seal = function (object) {\n          return object;\n        }),\n  Object.freeze ||\n        (Object.freeze = function (object) {\n          return object;\n        });\n  try {\n    Object.freeze(function () {});\n  } catch (exception) {\n    Object.freeze = (function (freezeObject) {\n      return function (object) {\n        return 'function' === typeof object ? object : freezeObject(object);\n      };\n    }(Object.freeze));\n  }\n  if (\n    (Object.preventExtensions ||\n        (Object.preventExtensions = function (object) {\n          return object;\n        }),\n      Object.isSealed ||\n        (Object.isSealed = function () {\n          return !1;\n        }),\n      Object.isFrozen ||\n        (Object.isFrozen = function () {\n          return !1;\n        }),\n      Object.isExtensible ||\n        (Object.isExtensible = function (object) {\n          if (Object(object) === object) throw new TypeError();\n          for (var name = ''; owns(object, name);) name += '?';\n          object[name] = !0;\n          let returnValue = owns(object, name);\n          return delete object[name], returnValue;\n        }),\n      !Object.keys)\n  ) {\n    let hasDontEnumBug = !0,\n      dontEnums = [\n        'toString',\n        'toLocaleString',\n        'valueOf',\n        'hasOwnProperty',\n        'isPrototypeOf',\n        'propertyIsEnumerable',\n        'constructor',\n      ],\n      dontEnumsLength = dontEnums.length;\n    for (let key in { toString: null }) hasDontEnumBug = !1;\n    Object.keys = function (object) {\n      if (\n        ('object' !== typeof object && 'function' !== typeof object) ||\n          null === object\n      )\n        {throw new TypeError('Object.keys called on a non-object');}\n      let keys = [];\n      for (let name in object) owns(object, name) && keys.push(name);\n      if (hasDontEnumBug)\n        {for (var i = 0, ii = dontEnumsLength; ii > i; i++) {\n            var dontEnum = dontEnums[i];\n            owns(object, dontEnum) && keys.push(dontEnum);\n          }}\n      return keys;\n    };\n  }\n  Date.now ||\n      (Date.now = function () {\n        return new Date().getTime();\n      });\n  let ws = '\t\\nv\\f\\r \\u2028\\u2029\ufeff';\n  if (!String.prototype.trim || ws.trim()) {\n    ws = '[' + ws + ']';\n    let trimBeginRegexp = RegExp('^' + ws + ws + '*'),\n      trimEndRegexp = RegExp(ws + ws + '*$');\n    String.prototype.trim = function () {\n      return (this + '')\n        .replace(trimBeginRegexp, '')\n        .replace(trimEndRegexp, '');\n    };\n  }\n  var toObject = function (o) {\n    if (null == o) throw new TypeError('can\\'t convert ' + o + ' to object');\n    return Object(o);\n  };\n});\nace.define(\n  'sense_editor/mode/worker_parser',\n  ['require', 'exports', 'module'],\n  function () {\n    let at, // The index of the current character\n      ch, // The current character\n      annos, // annotations\n      escapee = {\n        '\"': '\"',\n        '\\\\': '\\\\',\n        '/': '/',\n        b: '\\b',\n        f: '\\f',\n        n: '\\n',\n        r: '\\r',\n        t: '\\t',\n      },\n      text,\n      annotate = function (type, text) {\n        annos.push({ type: type, text: text, at: at });\n      },\n      error = function (m) {\n        throw {\n          name: 'SyntaxError',\n          message: m,\n          at: at,\n          text: text,\n        };\n      },\n      reset = function (newAt) {\n        ch = text.charAt(newAt);\n        at = newAt + 1;\n      },\n      next = function (c) {\n        if (c && c !== ch) {\n          error('Expected \\'' + c + '\\' instead of \\'' + ch + '\\'');\n        }\n\n        ch = text.charAt(at);\n        at += 1;\n        return ch;\n      },\n      nextUpTo = function (upTo, errorMessage) {\n        let currentAt = at,\n          i = text.indexOf(upTo, currentAt);\n        if (i < 0) {\n          error(errorMessage || 'Expected \\'' + upTo + '\\'');\n        }\n        reset(i + upTo.length);\n        return text.substring(currentAt, i);\n      },\n      peek = function (c) {\n        return text.substr(at, c.length) === c; // nocommit - double check\n      },\n      number = function () {\n        let number,\n          string = '';\n\n        if (ch === '-') {\n          string = '-';\n          next('-');\n        }\n        while (ch >= '0' && ch <= '9') {\n          string += ch;\n          next();\n        }\n        if (ch === '.') {\n          string += '.';\n          while (next() && ch >= '0' && ch <= '9') {\n            string += ch;\n          }\n        }\n        if (ch === 'e' || ch === 'E') {\n          string += ch;\n          next();\n          if (ch === '-' || ch === '+') {\n            string += ch;\n            next();\n          }\n          while (ch >= '0' && ch <= '9') {\n            string += ch;\n            next();\n          }\n        }\n        number = +string;\n        if (isNaN(number)) {\n          error('Bad number');\n        } else {\n          return number;\n        }\n      },\n      string = function () {\n        let hex,\n          i,\n          string = '',\n          uffff;\n\n        if (ch === '\"') {\n          if (peek('\"\"')) {\n            // literal\n            next('\"');\n            next('\"');\n            return nextUpTo('\"\"\"', 'failed to find closing \\'\"\"\"\\'');\n          } else {\n            while (next()) {\n              if (ch === '\"') {\n                next();\n                return string;\n              } else if (ch === '\\\\') {\n                next();\n                if (ch === 'u') {\n                  uffff = 0;\n                  for (i = 0; i < 4; i += 1) {\n                    hex = parseInt(next(), 16);\n                    if (!isFinite(hex)) {\n                      break;\n                    }\n                    uffff = uffff * 16 + hex;\n                  }\n                  string += String.fromCharCode(uffff);\n                } else if (typeof escapee[ch] === 'string') {\n                  string += escapee[ch];\n                } else {\n                  break;\n                }\n              } else {\n                string += ch;\n              }\n            }\n          }\n        }\n        error('Bad string');\n      },\n      white = function () {\n        while (ch && ch <= ' ') {\n          next();\n        }\n      },\n      strictWhite = function () {\n        while (ch && (ch == ' ' || ch == '\\t')) {\n          next();\n        }\n      },\n      newLine = function () {\n        if (ch == '\\n') next();\n      },\n      word = function () {\n        switch (ch) {\n          case 't':\n            next('t');\n            next('r');\n            next('u');\n            next('e');\n            return true;\n          case 'f':\n            next('f');\n            next('a');\n            next('l');\n            next('s');\n            next('e');\n            return false;\n          case 'n':\n            next('n');\n            next('u');\n            next('l');\n            next('l');\n            return null;\n        }\n        error('Unexpected \\'' + ch + '\\'');\n      },\n      // parses and returns the method\n      method = function () {\n        switch (ch) {\n          case 'G':\n            next('G');\n            next('E');\n            next('T');\n            return 'GET';\n          case 'H':\n            next('H');\n            next('E');\n            next('A');\n            next('D');\n            return 'HEAD';\n          case 'D':\n            next('D');\n            next('E');\n            next('L');\n            next('E');\n            next('T');\n            next('E');\n            return 'DELETE';\n          case 'P':\n            next('P');\n            switch (ch) {\n              case 'U':\n                next('U');\n                next('T');\n                return 'PUT';\n              case 'O':\n                next('O');\n                next('S');\n                next('T');\n                return 'POST';\n              default:\n                error('Unexpected \\'' + ch + '\\'');\n            }\n            break;\n          default:\n            error('Expected one of GET/POST/PUT/DELETE/HEAD');\n        }\n      },\n      value, // Place holder for the value function.\n      array = function () {\n        const array = [];\n\n        if (ch === '[') {\n          next('[');\n          white();\n          if (ch === ']') {\n            next(']');\n            return array; // empty array\n          }\n          while (ch) {\n            array.push(value());\n            white();\n            if (ch === ']') {\n              next(']');\n              return array;\n            }\n            next(',');\n            white();\n          }\n        }\n        error('Bad array');\n      },\n      object = function () {\n        let key,\n          object = {};\n\n        if (ch === '{') {\n          next('{');\n          white();\n          if (ch === '}') {\n            next('}');\n            return object; // empty object\n          }\n          while (ch) {\n            key = string();\n            white();\n            next(':');\n            if (Object.hasOwnProperty.call(object, key)) {\n              error('Duplicate key \"' + key + '\"');\n            }\n            object[key] = value();\n            white();\n            if (ch === '}') {\n              next('}');\n              return object;\n            }\n            next(',');\n            white();\n          }\n        }\n        error('Bad object');\n      };\n\n    value = function () {\n      white();\n      switch (ch) {\n        case '{':\n          return object();\n        case '[':\n          return array();\n        case '\"':\n          return string();\n        case '-':\n          return number();\n        default:\n          return ch >= '0' && ch <= '9' ? number() : word();\n      }\n    };\n\n    let url = function () {\n        let url = '';\n        while (ch && ch != '\\n') {\n          url += ch;\n          next();\n        }\n        if (url == '') {\n          error('Missing url');\n        }\n        return url;\n      },\n      request = function () {\n        white();\n        method();\n        strictWhite();\n        url();\n        strictWhite(); // advance to one new line\n        newLine();\n        strictWhite();\n        if (ch == '{') {\n          object();\n        }\n        // multi doc request\n        strictWhite(); // advance to one new line\n        newLine();\n        strictWhite();\n        while (ch == '{') {\n          // another object\n          object();\n          strictWhite();\n          newLine();\n          strictWhite();\n        }\n      },\n      comment = function () {\n        while (ch == '#') {\n          while (ch && ch !== '\\n') {\n            next();\n          }\n          white();\n        }\n      },\n      multi_request = function () {\n        while (ch && ch != '') {\n          white();\n          if (!ch) {\n            continue;\n          }\n          try {\n            comment();\n            white();\n            if (!ch) {\n              continue;\n            }\n            request();\n            white();\n          } catch (e) {\n            annotate('error', e.message);\n            // snap\n            const substring = text.substr(at);\n            const nextMatch = substring.search(/^POST|HEAD|GET|PUT|DELETE/m);\n            if (nextMatch < 1) return;\n            reset(at + nextMatch);\n          }\n        }\n      };\n\n    return function (source, reviver) {\n      let result;\n\n      text = source;\n      at = 0;\n      annos = [];\n      next();\n      multi_request();\n      white();\n      if (ch) {\n        annotate('error', 'Syntax error');\n      }\n\n      result = { annotations: annos };\n\n      return typeof reviver === 'function'\n        ? (function walk(holder, key) {\n          let k,\n            v,\n            value = holder[key];\n          if (value && typeof value === 'object') {\n            for (k in value) {\n              if (Object.hasOwnProperty.call(value, k)) {\n                v = walk(value, k);\n                if (v !== undefined) {\n                  value[k] = v;\n                } else {\n                  delete value[k];\n                }\n              }\n            }\n          }\n          return reviver.call(holder, key, value);\n        }({ '': result }, ''))\n        : result;\n    };\n  }\n);\n\nace.define(\n  'sense_editor/mode/worker',\n  [\n    'require',\n    'exports',\n    'module',\n    'ace/lib/oop',\n    'ace/worker/mirror',\n    'sense_editor/mode/worker_parser',\n  ],\n  function (require, exports) {\n    const oop = require('ace/lib/oop');\n    const Mirror = require('ace/worker/mirror').Mirror;\n    const parse = require('sense_editor/mode/worker_parser');\n\n    const SenseWorker = (exports.SenseWorker = function (sender) {\n      Mirror.call(this, sender);\n      this.setTimeout(200);\n    });\n\n    oop.inherits(SenseWorker, Mirror);\n\n    (function () {\n      this.id = 'senseWorker';\n      this.onUpdate = function () {\n        const value = this.doc.getValue();\n        let pos, result;\n        try {\n          result = parse(value);\n        } catch (e) {\n          pos = this.charToDocumentPosition(e.at - 1);\n          this.sender.emit('error', {\n            row: pos.row,\n            column: pos.column,\n            text: e.message,\n            type: 'error',\n          });\n          return;\n        }\n        for (let i = 0; i < result.annotations.length; i++) {\n          pos = this.charToDocumentPosition(result.annotations[i].at - 1);\n          result.annotations[i].row = pos.row;\n          result.annotations[i].column = pos.column;\n        }\n        this.sender.emit('ok', result.annotations);\n      };\n\n      this.charToDocumentPosition = function (charPos) {\n        let i = 0;\n        const len = this.doc.getLength();\n        const nl = this.doc.getNewLineCharacter().length;\n\n        if (!len) {\n          return { row: 0, column: 0 };\n        }\n\n        let lineStart = 0,\n          line;\n        while (i < len) {\n          line = this.doc.getLine(i);\n          const lineLength = line.length + nl;\n          if (lineStart + lineLength > charPos) {\n            return {\n              row: i,\n              column: charPos - lineStart,\n            };\n          }\n\n          lineStart += lineLength;\n          i += 1;\n        }\n\n        return {\n          row: i - 1,\n          column: line.length,\n        };\n      };\n    }.call(SenseWorker.prototype));\n  }\n);\n";const workerModule={id:"sense_editor/mode/worker",src:worker_worker};const{TextHighlightRules:TextHighlightRules}=brace_default.a.acequire("ace/mode/text_highlight_rules");const oop=brace_default.a.acequire("ace/lib/oop");const OpenSearchSqlHighlightRules=function(){const keywords="describe|between|in|like|not|and|or|desc|select|from|where|having|group|by|order"+"asc|desc|pivot|for|in|as|show|columns|include|frozen|tables|escape|limit|rlike|all|distinct|is";const builtinConstants="true|false";const builtinFunctions="avg|count|first|first_value|last|last_value|max|min|sum|kurtosis|mad|percentile|percentile_rank|skewness"+"|stddev_pop|sum_of_squares|var_pop|histogram|case|coalesce|greatest|ifnull|iif|isnull|least|nullif|nvl"+"|curdate|current_date|current_time|current_timestamp|curtime|dateadd|datediff|datepart|datetrunc|date_add"+"|date_diff|date_part|date_trunc|day|dayname|dayofmonth|dayofweek|dayofyear|day_name|day_of_month|day_of_week"+"|day_of_year|dom|dow|doy|hour|hour_of_day|idow|isodayofweek|isodow|isoweek|isoweekofyear|iso_day_of_week|iso_week_of_year"+"|iw|iwoy|minute|minute_of_day|minute_of_hour|month|monthname|month_name|month_of_year|now|quarter|second|second_of_minute"+"|timestampadd|timestampdiff|timestamp_add|timestamp_diff|today|week|week_of_year|year|abs|acos|asin|atan|atan2|cbrt"+"|ceil|ceiling|cos|cosh|cot|degrees|e|exp|expm1|floor|log|log10|mod|pi|power|radians|rand|random|round|sign|signum|sin"+"|sinh|sqrt|tan|truncate|ascii|bit_length|char|character_length|char_length|concat|insert|lcase|left|length|locate"+"|ltrim|octet_length|position|repeat|replace|right|rtrim|space|substring|ucase|cast|convert|database|user|st_astext|st_aswkt"+"|st_distance|st_geometrytype|st_geomfromtext|st_wkttosql|st_x|st_y|st_z|score";const dataTypes="null|boolean|byte|short|integer|long|double|float|half_float|scaled_float|keyword|text|binary|date|ip|object|nested|time"+"|interval_year|interval_month|interval_day|interval_hour|interval_minute|interval_second|interval_year_to_month"+"inteval_day_to_hour|interval_day_to_minute|interval_day_to_second|interval_hour_to_minute|interval_hour_to_second"+"interval_minute_to_second|geo_point|geo_shape|shape";const keywordMapper=this.createKeywordMapper({keyword:[keywords,builtinFunctions,builtinConstants,dataTypes].join("|")},"identifier",true);this.$rules={start:[{token:"comment",regex:"--.*$"},{token:"comment",start:"/\\*",end:"\\*/"},{token:"string",regex:'".*?"'},{token:"constant",regex:"'.*?'"},{token:"string",regex:"`.*?`"},{token:"entity.name.function",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:keywordMapper,regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"},{token:"keyword.operator",regex:"|<|\\*|\\.|\\:\\:|\\+|\\-|\\/|\\/\\/|%|&|\\^|~|<|>|<=|=>|==|!=|<>|="},{token:"paren.lparen",regex:"[\\(]"},{token:"paren.rparen",regex:"[\\)]"},{token:"text",regex:"\\s+"}]};this.normalizeRules()};oop.inherits(OpenSearchSqlHighlightRules,TextHighlightRules);const script_highlight_rules_oop=brace_default.a.acequire("ace/lib/oop");const{TextHighlightRules:script_highlight_rules_TextHighlightRules}=brace_default.a.acequire("ace/mode/text_highlight_rules");const painlessKeywords="def|int|long|byte|String|float|double|char|null|if|else|while|do|for|continue|break|new|try|catch|throw|this|instanceof|return|ctx";function ScriptHighlightRules(){this.name="ScriptHighlightRules";this.$rules={start:[{token:"script.comment",regex:"\\/\\/.*$"},{token:"script.string.regexp",regex:"[/](?:(?:\\[(?:\\\\]|[^\\]])+\\])|(?:\\\\/|[^\\]/]))*[/]\\w*\\s*(?=[).,;]|$)"},{token:"script.string",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"script.constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"script.constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"script.constant.language.boolean",regex:"(?:true|false)\\b"},{token:"script.keyword",regex:painlessKeywords},{token:"script.text",regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"},{token:"script.keyword.operator",regex:"\\?\\.|\\*\\.|=~|==~|!|%|&|\\*|\\-\\-|\\-|\\+\\+|\\+|~|===|==|=|!=|!==|<=|>=|<<=|>>=|>>>=|<>|<|>|->|!|&&|\\|\\||\\?\\:|\\*=|%=|\\+=|\\-=|&=|\\^=|\\b(?:in|instanceof|new|typeof|void)"},{token:"script.lparen",regex:"[[({]"},{token:"script.rparen",regex:"[\\])}]"},{token:"script.text",regex:"\\s+"}]}}script_highlight_rules_oop.inherits(ScriptHighlightRules,script_highlight_rules_TextHighlightRules);var mode_json=__webpack_require__(30);const{JsonHighlightRules:JsonHighlightRules}=brace_default.a.acequire("ace/mode/json_highlight_rules");const x_json_highlight_rules_oop=brace_default.a.acequire("ace/lib/oop");const jsonRules=function(root){root=root?root:"json";const rules={};const xJsonRules=[{token:["variable","whitespace","ace.punctuation.colon","whitespace","punctuation.start_triple_quote"],regex:'("(?:[^"]*_)?script"|"inline"|"source")(\\s*?)(:)(\\s*?)(""")',next:"script-start",merge:false,push:true},{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"punctuation.start_triple_quote",regex:'"""',next:"string_literal",merge:false,push:true},{token:"string",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]'},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"invalid.illegal",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"invalid.illegal",regex:"\\/\\/.*$"},{token:"paren.lparen",merge:false,regex:"{",next:root,push:true},{token:"paren.lparen",merge:false,regex:"[[(]"},{token:"paren.rparen",merge:false,regex:"[\\])]"},{token:"paren.rparen",regex:"}",merge:false,next:"pop"},{token:"punctuation.comma",regex:","},{token:"punctuation.colon",regex:":"},{token:"whitespace",regex:"\\s+"},{token:"text",regex:".+?"}];rules[root]=xJsonRules;rules[root+"-sql"]=[{token:["variable","whitespace","ace.punctuation.colon","whitespace","punctuation.start_triple_quote"],regex:'("query")(\\s*?)(:)(\\s*?)(""")',next:"sql-start",merge:false,push:true}].concat(xJsonRules);rules.string_literal=[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"},{token:"multi_string",regex:"."}];return rules};function XJsonHighlightRules(){this.$rules={...jsonRules("start")};this.embedRules(ScriptHighlightRules,"script-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}]);this.embedRules(OpenSearchSqlHighlightRules,"sql-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}])}x_json_highlight_rules_oop.inherits(XJsonHighlightRules,JsonHighlightRules);function addToRules(otherRules,embedUnder){otherRules.$rules=Object(external_osdSharedDeps_Lodash_["defaultsDeep"])(otherRules.$rules,jsonRules(embedUnder));otherRules.embedRules(ScriptHighlightRules,"script-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}]);otherRules.embedRules(OpenSearchSqlHighlightRules,"sql-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}])}var x_json_ace_worker='/*\n * SPDX-License-Identifier: Apache-2.0\n *\n * The OpenSearch Contributors require contributions made to\n * this file be licensed under the Apache-2.0 license or a\n * compatible open source license.\n *\n * Any modifications Copyright OpenSearch Contributors. See\n * GitHub history for details.\n */\n\n/*\n * Licensed to Elasticsearch B.V. under one or more contributor\n * license agreements. See the NOTICE file distributed with\n * this work for additional information regarding copyright\n * ownership. Elasticsearch B.V. licenses this file to you under\n * the Apache License, Version 2.0 (the "License"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/* @notice\n *\n * This product includes code that is based on Ace editor, which was available\n * under a "BSD" license.\n *\n * Distributed under the BSD license:\n *\n * Copyright (c) 2010, Ajax.org B.V.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *     * Redistributions of source code must retain the above copyright\n *       notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above copyright\n *       notice, this list of conditions and the following disclaimer in the\n *       documentation and/or other materials provided with the distribution.\n *     * Neither the name of Ajax.org B.V. nor the\n *       names of its contributors may be used to endorse or promote products\n *       derived from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* eslint-disable */\n\n/*\n  This file is loaded up as a blob by Brace to hand to Ace to load as Jsonp\n  (hence the redefining of everything).  It is based on the json\n  mode from the brace distro.\n\n  It is very likely that this file will be removed in future but for now it enables\n  extended JSON parsing, like e.g. """{}""" (triple quotes)\n*/\n"no use strict";\n\n!function (window) {\n  function resolveModuleId(id, paths) {\n    for (var testPath = id, tail = ""; testPath;) {\n      var alias = paths[testPath];\n      if ("string" == typeof alias) return alias + tail;\n      if (alias) return alias.location.replace(/\\/*$/, "/") + (tail || alias.main || alias.name);\n      if (alias === !1) return "";\n      var i = testPath.lastIndexOf("/");\n      if (-1 === i) break;\n      tail = testPath.substr(i) + tail, testPath = testPath.slice(0, i);\n    }\n\n    return id;\n  }\n\n  if (!(void 0 !== window.window && window.document || window.acequire && window.define)) {\n    window.console || (window.console = function () {\n      var msgs = Array.prototype.slice.call(arguments, 0);\n      postMessage({\n        type: "log",\n        data: msgs\n      });\n    }, window.console.error = window.console.warn = window.console.log = window.console.trace = window.console), window.window = window, window.ace = window, window.onerror = function (message, file, line, col, err) {\n      postMessage({\n        type: "error",\n        data: {\n          message: message,\n          data: err.data,\n          file: file,\n          line: line,\n          col: col,\n          stack: err.stack\n        }\n      });\n    }, window.normalizeModule = function (parentId, moduleName) {\n      if (-1 !== moduleName.indexOf("!")) {\n        var chunks = moduleName.split("!");\n        return window.normalizeModule(parentId, chunks[0]) + "!" + window.normalizeModule(parentId, chunks[1]);\n      }\n\n      if ("." == moduleName.charAt(0)) {\n        var base = parentId.split("/").slice(0, -1).join("/");\n\n        for (moduleName = (base ? base + "/" : "") + moduleName; -1 !== moduleName.indexOf(".") && previous != moduleName;) {\n          var previous = moduleName;\n          moduleName = moduleName.replace(/^\\.\\//, "").replace(/\\/\\.\\//, "/").replace(/[^\\/]+\\/\\.\\.\\//, "");\n        }\n      }\n\n      return moduleName;\n    }, window.acequire = function acequire(parentId, id) {\n      if (id || (id = parentId, parentId = null), !id.charAt) throw Error("worker.js acequire() accepts only (parentId, id) as arguments");\n      id = window.normalizeModule(parentId, id);\n      var module = window.acequire.modules[id];\n      if (module) return module.initialized || (module.initialized = !0, module.exports = module.factory().exports), module.exports;\n      if (!window.acequire.tlns) return console.log("unable to load " + id);\n      var path = resolveModuleId(id, window.acequire.tlns);\n      return ".js" != path.slice(-3) && (path += ".js"), window.acequire.id = id, window.acequire.modules[id] = {}, importScripts(path), window.acequire(parentId, id);\n    }, window.acequire.modules = {}, window.acequire.tlns = {}, window.define = function (id, deps, factory) {\n      if (2 == arguments.length ? (factory = deps, "string" != typeof id && (deps = id, id = window.acequire.id)) : 1 == arguments.length && (factory = id, deps = [], id = window.acequire.id), "function" != typeof factory) return window.acequire.modules[id] = {\n        exports: factory,\n        initialized: !0\n      }, void 0;\n      deps.length || (deps = ["require", "exports", "module"]);\n\n      var req = function (childId) {\n        return window.acequire(id, childId);\n      };\n\n      window.acequire.modules[id] = {\n        exports: {},\n        factory: function () {\n          var module = this,\n              returnExports = factory.apply(this, deps.map(function (dep) {\n            switch (dep) {\n              case "require":\n                return req;\n\n              case "exports":\n                return module.exports;\n\n              case "module":\n                return module;\n\n              default:\n                return req(dep);\n            }\n          }));\n          return returnExports && (module.exports = returnExports), module;\n        }\n      };\n    }, window.define.amd = {}, acequire.tlns = {}, window.initBaseUrls = function (topLevelNamespaces) {\n      for (var i in topLevelNamespaces) acequire.tlns[i] = topLevelNamespaces[i];\n    }, window.initSender = function () {\n      var EventEmitter = window.acequire("ace/lib/event_emitter").EventEmitter,\n          oop = window.acequire("ace/lib/oop"),\n          Sender = function () {};\n\n      return function () {\n        oop.implement(this, EventEmitter), this.callback = function (data, callbackId) {\n          postMessage({\n            type: "call",\n            id: callbackId,\n            data: data\n          });\n        }, this.emit = function (name, data) {\n          postMessage({\n            type: "event",\n            name: name,\n            data: data\n          });\n        };\n      }.call(Sender.prototype), new Sender();\n    };\n    var main = window.main = null,\n        sender = window.sender = null;\n\n    window.onmessage = function (e) {\n      var msg = e.data;\n      if (msg.event && sender) sender._signal(msg.event, msg.data);else if (msg.command) {\n        if (main[msg.command]) main[msg.command].apply(main, msg.args);else {\n          if (!window[msg.command]) throw Error("Unknown command:" + msg.command);\n          window[msg.command].apply(window, msg.args);\n        }\n      } else if (msg.init) {\n        window.initBaseUrls(msg.tlns), acequire("ace/lib/es5-shim"), sender = window.sender = window.initSender();\n        var clazz = acequire(msg.module)[msg.classname];\n        main = window.main = new clazz(sender);\n      }\n    };\n  }\n}(this), ace.define("ace/lib/oop", ["require", "exports", "module"], function (acequire, exports) {\n  "use strict";\n\n  exports.inherits = function (ctor, superCtor) {\n    ctor.super_ = superCtor, ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: !1,\n        writable: !0,\n        configurable: !0\n      }\n    });\n  }, exports.mixin = function (obj, mixin) {\n    for (var key in mixin) obj[key] = mixin[key];\n\n    return obj;\n  }, exports.implement = function (proto, mixin) {\n    exports.mixin(proto, mixin);\n  };\n}), ace.define("ace/range", ["require", "exports", "module"], function (acequire, exports) {\n  "use strict";\n\n  var comparePoints = function (p1, p2) {\n    return p1.row - p2.row || p1.column - p2.column;\n  },\n      Range = function (startRow, startColumn, endRow, endColumn) {\n    this.start = {\n      row: startRow,\n      column: startColumn\n    }, this.end = {\n      row: endRow,\n      column: endColumn\n    };\n  };\n\n  (function () {\n    this.isEqual = function (range) {\n      return this.start.row === range.start.row && this.end.row === range.end.row && this.start.column === range.start.column && this.end.column === range.end.column;\n    }, this.toString = function () {\n      return "Range: [" + this.start.row + "/" + this.start.column + "] -> [" + this.end.row + "/" + this.end.column + "]";\n    }, this.contains = function (row, column) {\n      return 0 == this.compare(row, column);\n    }, this.compareRange = function (range) {\n      var cmp,\n          end = range.end,\n          start = range.start;\n      return cmp = this.compare(end.row, end.column), 1 == cmp ? (cmp = this.compare(start.row, start.column), 1 == cmp ? 2 : 0 == cmp ? 1 : 0) : -1 == cmp ? -2 : (cmp = this.compare(start.row, start.column), -1 == cmp ? -1 : 1 == cmp ? 42 : 0);\n    }, this.comparePoint = function (p) {\n      return this.compare(p.row, p.column);\n    }, this.containsRange = function (range) {\n      return 0 == this.comparePoint(range.start) && 0 == this.comparePoint(range.end);\n    }, this.intersects = function (range) {\n      var cmp = this.compareRange(range);\n      return -1 == cmp || 0 == cmp || 1 == cmp;\n    }, this.isEnd = function (row, column) {\n      return this.end.row == row && this.end.column == column;\n    }, this.isStart = function (row, column) {\n      return this.start.row == row && this.start.column == column;\n    }, this.setStart = function (row, column) {\n      "object" == typeof row ? (this.start.column = row.column, this.start.row = row.row) : (this.start.row = row, this.start.column = column);\n    }, this.setEnd = function (row, column) {\n      "object" == typeof row ? (this.end.column = row.column, this.end.row = row.row) : (this.end.row = row, this.end.column = column);\n    }, this.inside = function (row, column) {\n      return 0 == this.compare(row, column) ? this.isEnd(row, column) || this.isStart(row, column) ? !1 : !0 : !1;\n    }, this.insideStart = function (row, column) {\n      return 0 == this.compare(row, column) ? this.isEnd(row, column) ? !1 : !0 : !1;\n    }, this.insideEnd = function (row, column) {\n      return 0 == this.compare(row, column) ? this.isStart(row, column) ? !1 : !0 : !1;\n    }, this.compare = function (row, column) {\n      return this.isMultiLine() || row !== this.start.row ? this.start.row > row ? -1 : row > this.end.row ? 1 : this.start.row === row ? column >= this.start.column ? 0 : -1 : this.end.row === row ? this.end.column >= column ? 0 : 1 : 0 : this.start.column > column ? -1 : column > this.end.column ? 1 : 0;\n    }, this.compareStart = function (row, column) {\n      return this.start.row == row && this.start.column == column ? -1 : this.compare(row, column);\n    }, this.compareEnd = function (row, column) {\n      return this.end.row == row && this.end.column == column ? 1 : this.compare(row, column);\n    }, this.compareInside = function (row, column) {\n      return this.end.row == row && this.end.column == column ? 1 : this.start.row == row && this.start.column == column ? -1 : this.compare(row, column);\n    }, this.clipRows = function (firstRow, lastRow) {\n      if (this.end.row > lastRow) var end = {\n        row: lastRow + 1,\n        column: 0\n      };else if (firstRow > this.end.row) var end = {\n        row: firstRow,\n        column: 0\n      };\n      if (this.start.row > lastRow) var start = {\n        row: lastRow + 1,\n        column: 0\n      };else if (firstRow > this.start.row) var start = {\n        row: firstRow,\n        column: 0\n      };\n      return Range.fromPoints(start || this.start, end || this.end);\n    }, this.extend = function (row, column) {\n      var cmp = this.compare(row, column);\n      if (0 == cmp) return this;\n      if (-1 == cmp) var start = {\n        row: row,\n        column: column\n      };else var end = {\n        row: row,\n        column: column\n      };\n      return Range.fromPoints(start || this.start, end || this.end);\n    }, this.isEmpty = function () {\n      return this.start.row === this.end.row && this.start.column === this.end.column;\n    }, this.isMultiLine = function () {\n      return this.start.row !== this.end.row;\n    }, this.clone = function () {\n      return Range.fromPoints(this.start, this.end);\n    }, this.collapseRows = function () {\n      return 0 == this.end.column ? new Range(this.start.row, 0, Math.max(this.start.row, this.end.row - 1), 0) : new Range(this.start.row, 0, this.end.row, 0);\n    }, this.toScreenRange = function (session) {\n      var screenPosStart = session.documentToScreenPosition(this.start),\n          screenPosEnd = session.documentToScreenPosition(this.end);\n      return new Range(screenPosStart.row, screenPosStart.column, screenPosEnd.row, screenPosEnd.column);\n    }, this.moveBy = function (row, column) {\n      this.start.row += row, this.start.column += column, this.end.row += row, this.end.column += column;\n    };\n  }).call(Range.prototype), Range.fromPoints = function (start, end) {\n    return new Range(start.row, start.column, end.row, end.column);\n  }, Range.comparePoints = comparePoints, Range.comparePoints = function (p1, p2) {\n    return p1.row - p2.row || p1.column - p2.column;\n  }, exports.Range = Range;\n}), ace.define("ace/apply_delta", ["require", "exports", "module"], function (acequire, exports) {\n  "use strict";\n\n  exports.applyDelta = function (docLines, delta) {\n    var row = delta.start.row,\n        startColumn = delta.start.column,\n        line = docLines[row] || "";\n\n    switch (delta.action) {\n      case "insert":\n        var lines = delta.lines;\n        if (1 === lines.length) docLines[row] = line.substring(0, startColumn) + delta.lines[0] + line.substring(startColumn);else {\n          var args = [row, 1].concat(delta.lines);\n          docLines.splice.apply(docLines, args), docLines[row] = line.substring(0, startColumn) + docLines[row], docLines[row + delta.lines.length - 1] += line.substring(startColumn);\n        }\n        break;\n\n      case "remove":\n        var endColumn = delta.end.column,\n            endRow = delta.end.row;\n        row === endRow ? docLines[row] = line.substring(0, startColumn) + line.substring(endColumn) : docLines.splice(row, endRow - row + 1, line.substring(0, startColumn) + docLines[endRow].substring(endColumn));\n    }\n  };\n}), ace.define("ace/lib/event_emitter", ["require", "exports", "module"], function (acequire, exports) {\n  "use strict";\n\n  var EventEmitter = {},\n      stopPropagation = function () {\n    this.propagationStopped = !0;\n  },\n      preventDefault = function () {\n    this.defaultPrevented = !0;\n  };\n\n  EventEmitter._emit = EventEmitter._dispatchEvent = function (eventName, e) {\n    this._eventRegistry || (this._eventRegistry = {}), this._defaultHandlers || (this._defaultHandlers = {});\n    var listeners = this._eventRegistry[eventName] || [],\n        defaultHandler = this._defaultHandlers[eventName];\n\n    if (listeners.length || defaultHandler) {\n      "object" == typeof e && e || (e = {}), e.type || (e.type = eventName), e.stopPropagation || (e.stopPropagation = stopPropagation), e.preventDefault || (e.preventDefault = preventDefault), listeners = listeners.slice();\n\n      for (var i = 0; listeners.length > i && (listeners[i](e, this), !e.propagationStopped); i++);\n\n      return defaultHandler && !e.defaultPrevented ? defaultHandler(e, this) : void 0;\n    }\n  }, EventEmitter._signal = function (eventName, e) {\n    var listeners = (this._eventRegistry || {})[eventName];\n\n    if (listeners) {\n      listeners = listeners.slice();\n\n      for (var i = 0; listeners.length > i; i++) listeners[i](e, this);\n    }\n  }, EventEmitter.once = function (eventName, callback) {\n    var _self = this;\n\n    callback && this.addEventListener(eventName, function newCallback() {\n      _self.removeEventListener(eventName, newCallback), callback.apply(null, arguments);\n    });\n  }, EventEmitter.setDefaultHandler = function (eventName, callback) {\n    var handlers = this._defaultHandlers;\n\n    if (handlers || (handlers = this._defaultHandlers = {\n      _disabled_: {}\n    }), handlers[eventName]) {\n      var old = handlers[eventName],\n          disabled = handlers._disabled_[eventName];\n      disabled || (handlers._disabled_[eventName] = disabled = []), disabled.push(old);\n      var i = disabled.indexOf(callback);\n      -1 != i && disabled.splice(i, 1);\n    }\n\n    handlers[eventName] = callback;\n  }, EventEmitter.removeDefaultHandler = function (eventName, callback) {\n    var handlers = this._defaultHandlers;\n\n    if (handlers) {\n      var disabled = handlers._disabled_[eventName];\n      if (handlers[eventName] == callback) handlers[eventName], disabled && this.setDefaultHandler(eventName, disabled.pop());else if (disabled) {\n        var i = disabled.indexOf(callback);\n        -1 != i && disabled.splice(i, 1);\n      }\n    }\n  }, EventEmitter.on = EventEmitter.addEventListener = function (eventName, callback, capturing) {\n    this._eventRegistry = this._eventRegistry || {};\n    var listeners = this._eventRegistry[eventName];\n    return listeners || (listeners = this._eventRegistry[eventName] = []), -1 == listeners.indexOf(callback) && listeners[capturing ? "unshift" : "push"](callback), callback;\n  }, EventEmitter.off = EventEmitter.removeListener = EventEmitter.removeEventListener = function (eventName, callback) {\n    this._eventRegistry = this._eventRegistry || {};\n    var listeners = this._eventRegistry[eventName];\n\n    if (listeners) {\n      var index = listeners.indexOf(callback);\n      -1 !== index && listeners.splice(index, 1);\n    }\n  }, EventEmitter.removeAllListeners = function (eventName) {\n    this._eventRegistry && (this._eventRegistry[eventName] = []);\n  }, exports.EventEmitter = EventEmitter;\n}), ace.define("ace/anchor", ["require", "exports", "module", "ace/lib/oop", "ace/lib/event_emitter"], function (acequire, exports) {\n  "use strict";\n\n  var oop = acequire("./lib/oop"),\n      EventEmitter = acequire("./lib/event_emitter").EventEmitter,\n      Anchor = exports.Anchor = function (doc, row, column) {\n    this.$onChange = this.onChange.bind(this), this.attach(doc), column === void 0 ? this.setPosition(row.row, row.column) : this.setPosition(row, column);\n  };\n\n  (function () {\n    function $pointsInOrder(point1, point2, equalPointsInOrder) {\n      var bColIsAfter = equalPointsInOrder ? point1.column <= point2.column : point1.column < point2.column;\n      return point1.row < point2.row || point1.row == point2.row && bColIsAfter;\n    }\n\n    function $getTransformedPoint(delta, point, moveIfEqual) {\n      var deltaIsInsert = "insert" == delta.action,\n          deltaRowShift = (deltaIsInsert ? 1 : -1) * (delta.end.row - delta.start.row),\n          deltaColShift = (deltaIsInsert ? 1 : -1) * (delta.end.column - delta.start.column),\n          deltaStart = delta.start,\n          deltaEnd = deltaIsInsert ? deltaStart : delta.end;\n      return $pointsInOrder(point, deltaStart, moveIfEqual) ? {\n        row: point.row,\n        column: point.column\n      } : $pointsInOrder(deltaEnd, point, !moveIfEqual) ? {\n        row: point.row + deltaRowShift,\n        column: point.column + (point.row == deltaEnd.row ? deltaColShift : 0)\n      } : {\n        row: deltaStart.row,\n        column: deltaStart.column\n      };\n    }\n\n    oop.implement(this, EventEmitter), this.getPosition = function () {\n      return this.$clipPositionToDocument(this.row, this.column);\n    }, this.getDocument = function () {\n      return this.document;\n    }, this.$insertRight = !1, this.onChange = function (delta) {\n      if (!(delta.start.row == delta.end.row && delta.start.row != this.row || delta.start.row > this.row)) {\n        var point = $getTransformedPoint(delta, {\n          row: this.row,\n          column: this.column\n        }, this.$insertRight);\n        this.setPosition(point.row, point.column, !0);\n      }\n    }, this.setPosition = function (row, column, noClip) {\n      var pos;\n\n      if (pos = noClip ? {\n        row: row,\n        column: column\n      } : this.$clipPositionToDocument(row, column), this.row != pos.row || this.column != pos.column) {\n        var old = {\n          row: this.row,\n          column: this.column\n        };\n        this.row = pos.row, this.column = pos.column, this._signal("change", {\n          old: old,\n          value: pos\n        });\n      }\n    }, this.detach = function () {\n      this.document.removeEventListener("change", this.$onChange);\n    }, this.attach = function (doc) {\n      this.document = doc || this.document, this.document.on("change", this.$onChange);\n    }, this.$clipPositionToDocument = function (row, column) {\n      var pos = {};\n      return row >= this.document.getLength() ? (pos.row = Math.max(0, this.document.getLength() - 1), pos.column = this.document.getLine(pos.row).length) : 0 > row ? (pos.row = 0, pos.column = 0) : (pos.row = row, pos.column = Math.min(this.document.getLine(pos.row).length, Math.max(0, column))), 0 > column && (pos.column = 0), pos;\n    };\n  }).call(Anchor.prototype);\n}), ace.define("ace/document", ["require", "exports", "module", "ace/lib/oop", "ace/apply_delta", "ace/lib/event_emitter", "ace/range", "ace/anchor"], function (acequire, exports) {\n  "use strict";\n\n  var oop = acequire("./lib/oop"),\n      applyDelta = acequire("./apply_delta").applyDelta,\n      EventEmitter = acequire("./lib/event_emitter").EventEmitter,\n      Range = acequire("./range").Range,\n      Anchor = acequire("./anchor").Anchor,\n      Document = function (textOrLines) {\n    this.$lines = [""], 0 === textOrLines.length ? this.$lines = [""] : Array.isArray(textOrLines) ? this.insertMergedLines({\n      row: 0,\n      column: 0\n    }, textOrLines) : this.insert({\n      row: 0,\n      column: 0\n    }, textOrLines);\n  };\n\n  (function () {\n    oop.implement(this, EventEmitter), this.setValue = function (text) {\n      var len = this.getLength() - 1;\n      this.remove(new Range(0, 0, len, this.getLine(len).length)), this.insert({\n        row: 0,\n        column: 0\n      }, text);\n    }, this.getValue = function () {\n      return this.getAllLines().join(this.getNewLineCharacter());\n    }, this.createAnchor = function (row, column) {\n      return new Anchor(this, row, column);\n    }, this.$split = 0 === "aaa".split(/a/).length ? function (text) {\n      return text.replace(/\\r\\n|\\r/g, "\\n").split("\\n");\n    } : function (text) {\n      return text.split(/\\r\\n|\\r|\\n/);\n    }, this.$detectNewLine = function (text) {\n      var match = text.match(/^.*?(\\r\\n|\\r|\\n)/m);\n      this.$autoNewLine = match ? match[1] : "\\n", this._signal("changeNewLineMode");\n    }, this.getNewLineCharacter = function () {\n      switch (this.$newLineMode) {\n        case "windows":\n          return "\\r\\n";\n\n        case "unix":\n          return "\\n";\n\n        default:\n          return this.$autoNewLine || "\\n";\n      }\n    }, this.$autoNewLine = "", this.$newLineMode = "auto", this.setNewLineMode = function (newLineMode) {\n      this.$newLineMode !== newLineMode && (this.$newLineMode = newLineMode, this._signal("changeNewLineMode"));\n    }, this.getNewLineMode = function () {\n      return this.$newLineMode;\n    }, this.isNewLine = function (text) {\n      return "\\r\\n" == text || "\\r" == text || "\\n" == text;\n    }, this.getLine = function (row) {\n      return this.$lines[row] || "";\n    }, this.getLines = function (firstRow, lastRow) {\n      return this.$lines.slice(firstRow, lastRow + 1);\n    }, this.getAllLines = function () {\n      return this.getLines(0, this.getLength());\n    }, this.getLength = function () {\n      return this.$lines.length;\n    }, this.getTextRange = function (range) {\n      return this.getLinesForRange(range).join(this.getNewLineCharacter());\n    }, this.getLinesForRange = function (range) {\n      var lines;\n      if (range.start.row === range.end.row) lines = [this.getLine(range.start.row).substring(range.start.column, range.end.column)];else {\n        lines = this.getLines(range.start.row, range.end.row), lines[0] = (lines[0] || "").substring(range.start.column);\n        var l = lines.length - 1;\n        range.end.row - range.start.row == l && (lines[l] = lines[l].substring(0, range.end.column));\n      }\n      return lines;\n    }, this.insertLines = function (row, lines) {\n      return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."), this.insertFullLines(row, lines);\n    }, this.removeLines = function (firstRow, lastRow) {\n      return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."), this.removeFullLines(firstRow, lastRow);\n    }, this.insertNewLine = function (position) {\n      return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, [\'\', \'\']) instead."), this.insertMergedLines(position, ["", ""]);\n    }, this.insert = function (position, text) {\n      return 1 >= this.getLength() && this.$detectNewLine(text), this.insertMergedLines(position, this.$split(text));\n    }, this.insertInLine = function (position, text) {\n      var start = this.clippedPos(position.row, position.column),\n          end = this.pos(position.row, position.column + text.length);\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "insert",\n        lines: [text]\n      }, !0), this.clonePos(end);\n    }, this.clippedPos = function (row, column) {\n      var length = this.getLength();\n      void 0 === row ? row = length : 0 > row ? row = 0 : row >= length && (row = length - 1, column = void 0);\n      var line = this.getLine(row);\n      return void 0 == column && (column = line.length), column = Math.min(Math.max(column, 0), line.length), {\n        row: row,\n        column: column\n      };\n    }, this.clonePos = function (pos) {\n      return {\n        row: pos.row,\n        column: pos.column\n      };\n    }, this.pos = function (row, column) {\n      return {\n        row: row,\n        column: column\n      };\n    }, this.$clipPosition = function (position) {\n      var length = this.getLength();\n      return position.row >= length ? (position.row = Math.max(0, length - 1), position.column = this.getLine(length - 1).length) : (position.row = Math.max(0, position.row), position.column = Math.min(Math.max(position.column, 0), this.getLine(position.row).length)), position;\n    }, this.insertFullLines = function (row, lines) {\n      row = Math.min(Math.max(row, 0), this.getLength());\n      var column = 0;\n      this.getLength() > row ? (lines = lines.concat([""]), column = 0) : (lines = [""].concat(lines), row--, column = this.$lines[row].length), this.insertMergedLines({\n        row: row,\n        column: column\n      }, lines);\n    }, this.insertMergedLines = function (position, lines) {\n      var start = this.clippedPos(position.row, position.column),\n          end = {\n        row: start.row + lines.length - 1,\n        column: (1 == lines.length ? start.column : 0) + lines[lines.length - 1].length\n      };\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "insert",\n        lines: lines\n      }), this.clonePos(end);\n    }, this.remove = function (range) {\n      var start = this.clippedPos(range.start.row, range.start.column),\n          end = this.clippedPos(range.end.row, range.end.column);\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "remove",\n        lines: this.getLinesForRange({\n          start: start,\n          end: end\n        })\n      }), this.clonePos(start);\n    }, this.removeInLine = function (row, startColumn, endColumn) {\n      var start = this.clippedPos(row, startColumn),\n          end = this.clippedPos(row, endColumn);\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "remove",\n        lines: this.getLinesForRange({\n          start: start,\n          end: end\n        })\n      }, !0), this.clonePos(start);\n    }, this.removeFullLines = function (firstRow, lastRow) {\n      firstRow = Math.min(Math.max(0, firstRow), this.getLength() - 1), lastRow = Math.min(Math.max(0, lastRow), this.getLength() - 1);\n      var deleteFirstNewLine = lastRow == this.getLength() - 1 && firstRow > 0,\n          deleteLastNewLine = this.getLength() - 1 > lastRow,\n          startRow = deleteFirstNewLine ? firstRow - 1 : firstRow,\n          startCol = deleteFirstNewLine ? this.getLine(startRow).length : 0,\n          endRow = deleteLastNewLine ? lastRow + 1 : lastRow,\n          endCol = deleteLastNewLine ? 0 : this.getLine(endRow).length,\n          range = new Range(startRow, startCol, endRow, endCol),\n          deletedLines = this.$lines.slice(firstRow, lastRow + 1);\n      return this.applyDelta({\n        start: range.start,\n        end: range.end,\n        action: "remove",\n        lines: this.getLinesForRange(range)\n      }), deletedLines;\n    }, this.removeNewLine = function (row) {\n      this.getLength() - 1 > row && row >= 0 && this.applyDelta({\n        start: this.pos(row, this.getLine(row).length),\n        end: this.pos(row + 1, 0),\n        action: "remove",\n        lines: ["", ""]\n      });\n    }, this.replace = function (range, text) {\n      if (range instanceof Range || (range = Range.fromPoints(range.start, range.end)), 0 === text.length && range.isEmpty()) return range.start;\n      if (text == this.getTextRange(range)) return range.end;\n      this.remove(range);\n      var end;\n      return end = text ? this.insert(range.start, text) : range.start;\n    }, this.applyDeltas = function (deltas) {\n      for (var i = 0; deltas.length > i; i++) this.applyDelta(deltas[i]);\n    }, this.revertDeltas = function (deltas) {\n      for (var i = deltas.length - 1; i >= 0; i--) this.revertDelta(deltas[i]);\n    }, this.applyDelta = function (delta, doNotValidate) {\n      var isInsert = "insert" == delta.action;\n      (isInsert ? 1 >= delta.lines.length && !delta.lines[0] : !Range.comparePoints(delta.start, delta.end)) || (isInsert && delta.lines.length > 2e4 && this.$splitAndapplyLargeDelta(delta, 2e4), applyDelta(this.$lines, delta, doNotValidate), this._signal("change", delta));\n    }, this.$splitAndapplyLargeDelta = function (delta, MAX) {\n      for (var lines = delta.lines, l = lines.length, row = delta.start.row, column = delta.start.column, from = 0, to = 0;;) {\n        from = to, to += MAX - 1;\n        var chunk = lines.slice(from, to);\n\n        if (to > l) {\n          delta.lines = chunk, delta.start.row = row + from, delta.start.column = column;\n          break;\n        }\n\n        chunk.push(""), this.applyDelta({\n          start: this.pos(row + from, column),\n          end: this.pos(row + to, column = 0),\n          action: delta.action,\n          lines: chunk\n        }, !0);\n      }\n    }, this.revertDelta = function (delta) {\n      this.applyDelta({\n        start: this.clonePos(delta.start),\n        end: this.clonePos(delta.end),\n        action: "insert" == delta.action ? "remove" : "insert",\n        lines: delta.lines.slice()\n      });\n    }, this.indexToPosition = function (index, startRow) {\n      for (var lines = this.$lines || this.getAllLines(), newlineLength = this.getNewLineCharacter().length, i = startRow || 0, l = lines.length; l > i; i++) if (index -= lines[i].length + newlineLength, 0 > index) return {\n        row: i,\n        column: index + lines[i].length + newlineLength\n      };\n\n      return {\n        row: l - 1,\n        column: lines[l - 1].length\n      };\n    }, this.positionToIndex = function (pos, startRow) {\n      for (var lines = this.$lines || this.getAllLines(), newlineLength = this.getNewLineCharacter().length, index = 0, row = Math.min(pos.row, lines.length), i = startRow || 0; row > i; ++i) index += lines[i].length + newlineLength;\n\n      return index + pos.column;\n    };\n  }).call(Document.prototype), exports.Document = Document;\n}), ace.define("ace/lib/lang", ["require", "exports", "module"], function (acequire, exports) {\n  "use strict";\n\n  exports.last = function (a) {\n    return a[a.length - 1];\n  }, exports.stringReverse = function (string) {\n    return string.split("").reverse().join("");\n  }, exports.stringRepeat = function (string, count) {\n    for (var result = ""; count > 0;) 1 & count && (result += string), (count >>= 1) && (string += string);\n\n    return result;\n  };\n  var trimBeginRegexp = /^\\s\\s*/,\n      trimEndRegexp = /\\s\\s*$/;\n  exports.stringTrimLeft = function (string) {\n    return string.replace(trimBeginRegexp, "");\n  }, exports.stringTrimRight = function (string) {\n    return string.replace(trimEndRegexp, "");\n  }, exports.copyObject = function (obj) {\n    var copy = {};\n\n    for (var key in obj) copy[key] = obj[key];\n\n    return copy;\n  }, exports.copyArray = function (array) {\n    for (var copy = [], i = 0, l = array.length; l > i; i++) copy[i] = array[i] && "object" == typeof array[i] ? this.copyObject(array[i]) : array[i];\n\n    return copy;\n  }, exports.deepCopy = function deepCopy(obj) {\n    if ("object" != typeof obj || !obj) return obj;\n    var copy;\n\n    if (Array.isArray(obj)) {\n      copy = [];\n\n      for (var key = 0; obj.length > key; key++) copy[key] = deepCopy(obj[key]);\n\n      return copy;\n    }\n\n    if ("[object Object]" !== Object.prototype.toString.call(obj)) return obj;\n    copy = {};\n\n    for (var key in obj) copy[key] = deepCopy(obj[key]);\n\n    return copy;\n  }, exports.arrayToMap = function (arr) {\n    for (var map = {}, i = 0; arr.length > i; i++) map[arr[i]] = 1;\n\n    return map;\n  }, exports.createMap = function (props) {\n    var map = Object.create(null);\n\n    for (var i in props) map[i] = props[i];\n\n    return map;\n  }, exports.arrayRemove = function (array, value) {\n    for (var i = 0; array.length >= i; i++) value === array[i] && array.splice(i, 1);\n  }, exports.escapeRegExp = function (str) {\n    return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g, "\\\\$1");\n  }, exports.escapeHTML = function (str) {\n    return str.replace(/&/g, "&#38;").replace(/"/g, "&#34;").replace(/\'/g, "&#39;").replace(/</g, "&#60;");\n  }, exports.getMatchOffsets = function (string, regExp) {\n    var matches = [];\n    return string.replace(regExp, function (str) {\n      matches.push({\n        offset: arguments[arguments.length - 2],\n        length: str.length\n      });\n    }), matches;\n  }, exports.deferredCall = function (fcn) {\n    var timer = null,\n        callback = function () {\n      timer = null, fcn();\n    },\n        deferred = function (timeout) {\n      return deferred.cancel(), timer = setTimeout(callback, timeout || 0), deferred;\n    };\n\n    return deferred.schedule = deferred, deferred.call = function () {\n      return this.cancel(), fcn(), deferred;\n    }, deferred.cancel = function () {\n      return clearTimeout(timer), timer = null, deferred;\n    }, deferred.isPending = function () {\n      return timer;\n    }, deferred;\n  }, exports.delayedCall = function (fcn, defaultTimeout) {\n    var timer = null,\n        callback = function () {\n      timer = null, fcn();\n    },\n        _self = function (timeout) {\n      null == timer && (timer = setTimeout(callback, timeout || defaultTimeout));\n    };\n\n    return _self.delay = function (timeout) {\n      timer && clearTimeout(timer), timer = setTimeout(callback, timeout || defaultTimeout);\n    }, _self.schedule = _self, _self.call = function () {\n      this.cancel(), fcn();\n    }, _self.cancel = function () {\n      timer && clearTimeout(timer), timer = null;\n    }, _self.isPending = function () {\n      return timer;\n    }, _self;\n  };\n}), ace.define("ace/worker/mirror", ["require", "exports", "module", "ace/range", "ace/document", "ace/lib/lang"], function (acequire, exports) {\n  "use strict";\n\n  acequire("../range").Range;\n\n  var Document = acequire("../document").Document,\n      lang = acequire("../lib/lang"),\n      Mirror = exports.Mirror = function (sender) {\n    this.sender = sender;\n\n    var doc = this.doc = new Document(""),\n        deferredUpdate = this.deferredUpdate = lang.delayedCall(this.onUpdate.bind(this)),\n        _self = this;\n\n    sender.on("change", function (e) {\n      var data = e.data;\n      if (data[0].start) doc.applyDeltas(data);else for (var i = 0; data.length > i; i += 2) {\n        if (Array.isArray(data[i + 1])) var d = {\n          action: "insert",\n          start: data[i],\n          lines: data[i + 1]\n        };else var d = {\n          action: "remove",\n          start: data[i],\n          end: data[i + 1]\n        };\n        doc.applyDelta(d, !0);\n      }\n      return _self.$timeout ? deferredUpdate.schedule(_self.$timeout) : (_self.onUpdate(), void 0);\n    });\n  };\n\n  (function () {\n    this.$timeout = 500, this.setTimeout = function (timeout) {\n      this.$timeout = timeout;\n    }, this.setValue = function (value) {\n      this.doc.setValue(value), this.deferredUpdate.schedule(this.$timeout);\n    }, this.getValue = function (callbackId) {\n      this.sender.callback(this.doc.getValue(), callbackId);\n    }, this.onUpdate = function () {}, this.isPending = function () {\n      return this.deferredUpdate.isPending();\n    };\n  }).call(Mirror.prototype);\n}), ace.define("ace/mode/json/json_parse", ["require", "exports", "module"], function () {\n  "use strict";\n\n  var at,\n      ch,\n      text,\n      value,\n      escapee = {\n    \'"\': \'"\',\n    "\\\\": "\\\\",\n    "/": "/",\n    b: "\\b",\n    f: "\\f",\n    n: "\\n",\n    r: "\\r",\n    t: "\t"\n  },\n      error = function (m) {\n    throw {\n      name: "SyntaxError",\n      message: m,\n      at: at,\n      text: text\n    };\n  },\n      reset = function (newAt) {\n    ch = text.charAt(newAt);\n    at = newAt + 1;\n  },\n      next = function (c) {\n    return c && c !== ch && error("Expected \'" + c + "\' instead of \'" + ch + "\'"), ch = text.charAt(at), at += 1, ch;\n  },\n      nextUpTo = function (upTo, errorMessage) {\n    let currentAt = at,\n        i = text.indexOf(upTo, currentAt);\n\n    if (i < 0) {\n      error(errorMessage || \'Expected \\\'\' + upTo + \'\\\'\');\n    }\n\n    reset(i + upTo.length);\n    return text.substring(currentAt, i);\n  },\n      peek = function (c) {\n    return text.substr(at, c.length) === c; // nocommit - double check\n  },\n      number = function () {\n    var number,\n        string = "";\n\n    for ("-" === ch && (string = "-", next("-")); ch >= "0" && "9" >= ch;) string += ch, next();\n\n    if ("." === ch) for (string += "."; next() && ch >= "0" && "9" >= ch;) string += ch;\n    if ("e" === ch || "E" === ch) for (string += ch, next(), ("-" === ch || "+" === ch) && (string += ch, next()); ch >= "0" && "9" >= ch;) string += ch, next();\n    return number = +string, isNaN(number) ? (error("Bad number"), void 0) : number;\n  },\n      string = function () {\n    var hex,\n        i,\n        uffff,\n        string = "";\n\n    if (\'"\' === ch) {\n      if (peek(\'""\')) {\n        // literal\n        next(\'"\');\n        next(\'"\');\n        return nextUpTo(\'"""\', \'failed to find closing \\\'"""\\\'\');\n      } else {\n        for (; next();) {\n          if (\'"\' === ch) return next(), string;\n          if ("\\\\" === ch) {\n            if (next(), "u" === ch) {\n              for (uffff = 0, i = 0; 4 > i && (hex = parseInt(next(), 16), isFinite(hex)); i += 1) uffff = 16 * uffff + hex;\n\n              string += String.fromCharCode(uffff);\n            } else {\n              if ("string" != typeof escapee[ch]) break;\n              string += escapee[ch];\n            }\n          } else string += ch;\n        }\n      }\n    }\n\n    error("Bad string");\n  },\n      white = function () {\n    for (; ch && " " >= ch;) next();\n  },\n      word = function () {\n    switch (ch) {\n      case "t":\n        return next("t"), next("r"), next("u"), next("e"), !0;\n\n      case "f":\n        return next("f"), next("a"), next("l"), next("s"), next("e"), !1;\n\n      case "n":\n        return next("n"), next("u"), next("l"), next("l"), null;\n    }\n\n    error("Unexpected \'" + ch + "\'");\n  },\n      array = function () {\n    var array = [];\n\n    if ("[" === ch) {\n      if (next("["), white(), "]" === ch) return next("]"), array;\n\n      for (; ch;) {\n        if (array.push(value()), white(), "]" === ch) return next("]"), array;\n        next(","), white();\n      }\n    }\n\n    error("Bad array");\n  },\n      object = function () {\n    var key,\n        object = {};\n\n    if ("{" === ch) {\n      if (next("{"), white(), "}" === ch) return next("}"), object;\n\n      for (; ch;) {\n        if (key = string(), white(), next(":"), Object.hasOwnProperty.call(object, key) && error(\'Duplicate key "\' + key + \'"\'), object[key] = value(), white(), "}" === ch) return next("}"), object;\n        next(","), white();\n      }\n    }\n\n    error("Bad object");\n  };\n\n  return value = function () {\n    switch (white(), ch) {\n      case "{":\n        return object();\n\n      case "[":\n        return array();\n\n      case \'"\':\n        return string();\n\n      case "-":\n        return number();\n\n      default:\n        return ch >= "0" && "9" >= ch ? number() : word();\n    }\n  }, function (source, reviver) {\n    var result;\n    return text = source, at = 0, ch = " ", result = value(), white(), ch && error("Syntax error"), "function" == typeof reviver ? function walk(holder, key) {\n      var k,\n          v,\n          value = holder[key];\n      if (value && "object" == typeof value) for (k in value) Object.hasOwnProperty.call(value, k) && (v = walk(value, k), void 0 !== v ? value[k] = v : delete value[k]);\n      return reviver.call(holder, key, value);\n    }({\n      "": result\n    }, "") : result;\n  };\n}), ace.define("ace/mode/json_worker", ["require", "exports", "module", "ace/lib/oop", "ace/worker/mirror", "ace/mode/json/json_parse"], function (acequire, exports) {\n  "use strict";\n\n  var oop = acequire("../lib/oop"),\n      Mirror = acequire("../worker/mirror").Mirror,\n      parse = acequire("./json/json_parse"),\n      JsonWorker = exports.JsonWorker = function (sender) {\n    Mirror.call(this, sender), this.setTimeout(200);\n  };\n\n  oop.inherits(JsonWorker, Mirror), function () {\n    this.onUpdate = function () {\n      var value = this.doc.getValue(),\n          errors = [];\n\n      try {\n        value && parse(value);\n      } catch (e) {\n        var pos = this.doc.indexToPosition(e.at - 1);\n        errors.push({\n          row: pos.row,\n          column: pos.column,\n          text: e.message,\n          type: "error"\n        });\n      }\n\n      this.sender.emit("annotate", errors);\n    };\n  }.call(JsonWorker.prototype);\n}), ace.define("ace/lib/es5-shim", ["require", "exports", "module"], function () {\n  function Empty() {}\n\n  function doesDefinePropertyWork(object) {\n    try {\n      return Object.defineProperty(object, "sentinel", {}), "sentinel" in object;\n    } catch (exception) {}\n  }\n\n  function toInteger(n) {\n    return n = +n, n !== n ? n = 0 : 0 !== n && n !== 1 / 0 && n !== -(1 / 0) && (n = (n > 0 || -1) * Math.floor(Math.abs(n))), n;\n  }\n\n  Function.prototype.bind || (Function.prototype.bind = function (that) {\n    var target = this;\n    if ("function" != typeof target) throw new TypeError("Function.prototype.bind called on incompatible " + target);\n\n    var args = slice.call(arguments, 1),\n        bound = function () {\n      if (this instanceof bound) {\n        var result = target.apply(this, args.concat(slice.call(arguments)));\n        return Object(result) === result ? result : this;\n      }\n\n      return target.apply(that, args.concat(slice.call(arguments)));\n    };\n\n    return target.prototype && (Empty.prototype = target.prototype, bound.prototype = new Empty(), Empty.prototype = null), bound;\n  });\n\n  var defineGetter,\n      defineSetter,\n      lookupGetter,\n      lookupSetter,\n      supportsAccessors,\n      call = Function.prototype.call,\n      prototypeOfArray = Array.prototype,\n      prototypeOfObject = Object.prototype,\n      slice = prototypeOfArray.slice,\n      _toString = call.bind(prototypeOfObject.toString),\n      owns = call.bind(prototypeOfObject.hasOwnProperty);\n\n  if ((supportsAccessors = owns(prototypeOfObject, "__defineGetter__")) && (defineGetter = call.bind(prototypeOfObject.__defineGetter__), defineSetter = call.bind(prototypeOfObject.__defineSetter__), lookupGetter = call.bind(prototypeOfObject.__lookupGetter__), lookupSetter = call.bind(prototypeOfObject.__lookupSetter__)), 2 != [1, 2].splice(0).length) if (function () {\n    function makeArray(l) {\n      var a = Array(l + 2);\n      return a[0] = a[1] = 0, a;\n    }\n\n    var lengthBefore,\n        array = [];\n    return array.splice.apply(array, makeArray(20)), array.splice.apply(array, makeArray(26)), lengthBefore = array.length, array.splice(5, 0, "XXX"), lengthBefore + 1 == array.length, lengthBefore + 1 == array.length ? !0 : void 0;\n  }()) {\n    var array_splice = Array.prototype.splice;\n\n    Array.prototype.splice = function (start, deleteCount) {\n      return arguments.length ? array_splice.apply(this, [void 0 === start ? 0 : start, void 0 === deleteCount ? this.length - start : deleteCount].concat(slice.call(arguments, 2))) : [];\n    };\n  } else Array.prototype.splice = function (pos, removeCount) {\n    var length = this.length;\n    pos > 0 ? pos > length && (pos = length) : void 0 == pos ? pos = 0 : 0 > pos && (pos = Math.max(length + pos, 0)), length > pos + removeCount || (removeCount = length - pos);\n    var removed = this.slice(pos, pos + removeCount),\n        insert = slice.call(arguments, 2),\n        add = insert.length;\n    if (pos === length) add && this.push.apply(this, insert);else {\n      var remove = Math.min(removeCount, length - pos),\n          tailOldPos = pos + remove,\n          tailNewPos = tailOldPos + add - remove,\n          tailCount = length - tailOldPos,\n          lengthAfterRemove = length - remove;\n      if (tailOldPos > tailNewPos) for (var i = 0; tailCount > i; ++i) this[tailNewPos + i] = this[tailOldPos + i];else if (tailNewPos > tailOldPos) for (i = tailCount; i--;) this[tailNewPos + i] = this[tailOldPos + i];\n      if (add && pos === lengthAfterRemove) this.length = lengthAfterRemove, this.push.apply(this, insert);else for (this.length = lengthAfterRemove + add, i = 0; add > i; ++i) this[pos + i] = insert[i];\n    }\n    return removed;\n  };\n  Array.isArray || (Array.isArray = function (obj) {\n    return "[object Array]" == _toString(obj);\n  });\n  var boxedString = Object("a"),\n      splitString = "a" != boxedString[0] || !(0 in boxedString);\n\n  if (Array.prototype.forEach || (Array.prototype.forEach = function (fun) {\n    var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        thisp = arguments[1],\n        i = -1,\n        length = self.length >>> 0;\n    if ("[object Function]" != _toString(fun)) throw new TypeError();\n\n    for (; length > ++i;) i in self && fun.call(thisp, self[i], i, object);\n  }), Array.prototype.map || (Array.prototype.map = function (fun) {\n    var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        result = Array(length),\n        thisp = arguments[1];\n    if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n\n    for (var i = 0; length > i; i++) i in self && (result[i] = fun.call(thisp, self[i], i, object));\n\n    return result;\n  }), Array.prototype.filter || (Array.prototype.filter = function (fun) {\n    var value,\n        object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        result = [],\n        thisp = arguments[1];\n    if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n\n    for (var i = 0; length > i; i++) i in self && (value = self[i], fun.call(thisp, value, i, object) && result.push(value));\n\n    return result;\n  }), Array.prototype.every || (Array.prototype.every = function (fun) {\n    var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        thisp = arguments[1];\n    if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n\n    for (var i = 0; length > i; i++) if (i in self && !fun.call(thisp, self[i], i, object)) return !1;\n\n    return !0;\n  }), Array.prototype.some || (Array.prototype.some = function (fun) {\n    var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        thisp = arguments[1];\n    if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n\n    for (var i = 0; length > i; i++) if (i in self && fun.call(thisp, self[i], i, object)) return !0;\n\n    return !1;\n  }), Array.prototype.reduce || (Array.prototype.reduce = function (fun) {\n    var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0;\n    if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n    if (!length && 1 == arguments.length) throw new TypeError("reduce of empty array with no initial value");\n    var result,\n        i = 0;\n    if (arguments.length >= 2) result = arguments[1];else for (;;) {\n      if (i in self) {\n        result = self[i++];\n        break;\n      }\n\n      if (++i >= length) throw new TypeError("reduce of empty array with no initial value");\n    }\n\n    for (; length > i; i++) i in self && (result = fun.call(void 0, result, self[i], i, object));\n\n    return result;\n  }), Array.prototype.reduceRight || (Array.prototype.reduceRight = function (fun) {\n    var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0;\n    if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n    if (!length && 1 == arguments.length) throw new TypeError("reduceRight of empty array with no initial value");\n    var result,\n        i = length - 1;\n    if (arguments.length >= 2) result = arguments[1];else for (;;) {\n      if (i in self) {\n        result = self[i--];\n        break;\n      }\n\n      if (0 > --i) throw new TypeError("reduceRight of empty array with no initial value");\n    }\n\n    do i in this && (result = fun.call(void 0, result, self[i], i, object)); while (i--);\n\n    return result;\n  }), Array.prototype.indexOf && -1 == [0, 1].indexOf(1, 2) || (Array.prototype.indexOf = function (sought) {\n    var self = splitString && "[object String]" == _toString(this) ? this.split("") : toObject(this),\n        length = self.length >>> 0;\n    if (!length) return -1;\n    var i = 0;\n\n    for (arguments.length > 1 && (i = toInteger(arguments[1])), i = i >= 0 ? i : Math.max(0, length + i); length > i; i++) if (i in self && self[i] === sought) return i;\n\n    return -1;\n  }), Array.prototype.lastIndexOf && -1 == [0, 1].lastIndexOf(0, -3) || (Array.prototype.lastIndexOf = function (sought) {\n    var self = splitString && "[object String]" == _toString(this) ? this.split("") : toObject(this),\n        length = self.length >>> 0;\n    if (!length) return -1;\n    var i = length - 1;\n\n    for (arguments.length > 1 && (i = Math.min(i, toInteger(arguments[1]))), i = i >= 0 ? i : length - Math.abs(i); i >= 0; i--) if (i in self && sought === self[i]) return i;\n\n    return -1;\n  }), Object.getPrototypeOf || (Object.getPrototypeOf = function (object) {\n    return object.__proto__ || (object.constructor ? object.constructor.prototype : prototypeOfObject);\n  }), !Object.getOwnPropertyDescriptor) {\n    var ERR_NON_OBJECT = "Object.getOwnPropertyDescriptor called on a non-object: ";\n\n    Object.getOwnPropertyDescriptor = function (object, property) {\n      if ("object" != typeof object && "function" != typeof object || null === object) throw new TypeError(ERR_NON_OBJECT + object);\n\n      if (owns(object, property)) {\n        var descriptor, getter, setter;\n\n        if (descriptor = {\n          enumerable: !0,\n          configurable: !0\n        }, supportsAccessors) {\n          var prototype = object.__proto__;\n          object.__proto__ = prototypeOfObject;\n          var getter = lookupGetter(object, property),\n              setter = lookupSetter(object, property);\n          if (object.__proto__ = prototype, getter || setter) return getter && (descriptor.get = getter), setter && (descriptor.set = setter), descriptor;\n        }\n\n        return descriptor.value = object[property], descriptor;\n      }\n    };\n  }\n\n  if (Object.getOwnPropertyNames || (Object.getOwnPropertyNames = function (object) {\n    return Object.keys(object);\n  }), !Object.create) {\n    var createEmpty;\n    createEmpty = null === Object.prototype.__proto__ ? function () {\n      return {\n        __proto__: null\n      };\n    } : function () {\n      var empty = {};\n\n      for (var i in empty) empty[i] = null;\n\n      return empty.constructor = empty.hasOwnProperty = empty.propertyIsEnumerable = empty.isPrototypeOf = empty.toLocaleString = empty.toString = empty.valueOf = empty.__proto__ = null, empty;\n    }, Object.create = function (prototype, properties) {\n      var object;\n      if (null === prototype) object = createEmpty();else {\n        if ("object" != typeof prototype) throw new TypeError("typeof prototype[" + typeof prototype + "] != \'object\'");\n\n        var Type = function () {};\n\n        Type.prototype = prototype, object = new Type(), object.__proto__ = prototype;\n      }\n      return void 0 !== properties && Object.defineProperties(object, properties), object;\n    };\n  }\n\n  if (Object.defineProperty) {\n    var definePropertyWorksOnObject = doesDefinePropertyWork({}),\n        definePropertyWorksOnDom = "undefined" == typeof document || doesDefinePropertyWork(document.createElement("div"));\n    if (!definePropertyWorksOnObject || !definePropertyWorksOnDom) var definePropertyFallback = Object.defineProperty;\n  }\n\n  if (!Object.defineProperty || definePropertyFallback) {\n    var ERR_NON_OBJECT_DESCRIPTOR = "Property description must be an object: ",\n        ERR_NON_OBJECT_TARGET = "Object.defineProperty called on non-object: ",\n        ERR_ACCESSORS_NOT_SUPPORTED = "getters & setters can not be defined on this javascript engine";\n\n    Object.defineProperty = function (object, property, descriptor) {\n      if ("object" != typeof object && "function" != typeof object || null === object) throw new TypeError(ERR_NON_OBJECT_TARGET + object);\n      if ("object" != typeof descriptor && "function" != typeof descriptor || null === descriptor) throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR + descriptor);\n      if (definePropertyFallback) try {\n        return definePropertyFallback.call(Object, object, property, descriptor);\n      } catch (exception) {}\n      if (owns(descriptor, "value")) {\n        if (supportsAccessors && (lookupGetter(object, property) || lookupSetter(object, property))) {\n          var prototype = object.__proto__;\n          object.__proto__ = prototypeOfObject, delete object[property], object[property] = descriptor.value, object.__proto__ = prototype;\n        } else object[property] = descriptor.value;\n      } else {\n        if (!supportsAccessors) throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);\n        owns(descriptor, "get") && defineGetter(object, property, descriptor.get), owns(descriptor, "set") && defineSetter(object, property, descriptor.set);\n      }\n      return object;\n    };\n  }\n\n  Object.defineProperties || (Object.defineProperties = function (object, properties) {\n    for (var property in properties) owns(properties, property) && Object.defineProperty(object, property, properties[property]);\n\n    return object;\n  }), Object.seal || (Object.seal = function (object) {\n    return object;\n  }), Object.freeze || (Object.freeze = function (object) {\n    return object;\n  });\n\n  try {\n    Object.freeze(function () {});\n  } catch (exception) {\n    Object.freeze = function (freezeObject) {\n      return function (object) {\n        return "function" == typeof object ? object : freezeObject(object);\n      };\n    }(Object.freeze);\n  }\n\n  if (Object.preventExtensions || (Object.preventExtensions = function (object) {\n    return object;\n  }), Object.isSealed || (Object.isSealed = function () {\n    return !1;\n  }), Object.isFrozen || (Object.isFrozen = function () {\n    return !1;\n  }), Object.isExtensible || (Object.isExtensible = function (object) {\n    if (Object(object) === object) throw new TypeError();\n\n    for (var name = ""; owns(object, name);) name += "?";\n\n    object[name] = !0;\n    var returnValue = owns(object, name);\n    return delete object[name], returnValue;\n  }), !Object.keys) {\n    var hasDontEnumBug = !0,\n        dontEnums = ["toString", "toLocaleString", "valueOf", "hasOwnProperty", "isPrototypeOf", "propertyIsEnumerable", "constructor"],\n        dontEnumsLength = dontEnums.length;\n\n    for (var key in {\n      toString: null\n    }) hasDontEnumBug = !1;\n\n    Object.keys = function (object) {\n      if ("object" != typeof object && "function" != typeof object || null === object) throw new TypeError("Object.keys called on a non-object");\n      var keys = [];\n\n      for (var name in object) owns(object, name) && keys.push(name);\n\n      if (hasDontEnumBug) for (var i = 0, ii = dontEnumsLength; ii > i; i++) {\n        var dontEnum = dontEnums[i];\n        owns(object, dontEnum) && keys.push(dontEnum);\n      }\n      return keys;\n    };\n  }\n\n  Date.now || (Date.now = function () {\n    return new Date().getTime();\n  });\n  var ws = "\t\\n\v\\f\\r \\u2028\\u2029\ufeff";\n\n  if (!String.prototype.trim || ws.trim()) {\n    ws = "[" + ws + "]";\n    var trimBeginRegexp = RegExp("^" + ws + ws + "*"),\n        trimEndRegexp = RegExp(ws + ws + "*$");\n\n    String.prototype.trim = function () {\n      return (this + "").replace(trimBeginRegexp, "").replace(trimEndRegexp, "");\n    };\n  }\n\n  var toObject = function (o) {\n    if (null == o) throw new TypeError("can\'t convert " + o + " to object");\n    return Object(o);\n  };\n});';const worker_workerModule={id:"ace/mode/json_worker",src:x_json_ace_worker};const{WorkerClient:WorkerClient}=brace_default.a.acequire("ace/worker/worker_client");const x_json_oop=brace_default.a.acequire("ace/lib/oop");const{Mode:JSONMode}=brace_default.a.acequire("ace/mode/json");const{Tokenizer:AceTokenizer}=brace_default.a.acequire("ace/tokenizer");const{MatchingBraceOutdent:MatchingBraceOutdent}=brace_default.a.acequire("ace/mode/matching_brace_outdent");const{CstyleBehaviour:CstyleBehaviour}=brace_default.a.acequire("ace/mode/behaviour/cstyle");const{FoldMode:CStyleFoldMode}=brace_default.a.acequire("ace/mode/folding/cstyle");const x_json_XJsonMode=function XJsonMode(){const ruleset=new XJsonHighlightRules;ruleset.normalizeRules();this.$tokenizer=new AceTokenizer(ruleset.getRules());this.$outdent=new MatchingBraceOutdent;this.$behaviour=new CstyleBehaviour;this.foldingRules=new CStyleFoldMode};x_json_oop.inherits(x_json_XJsonMode,JSONMode);x_json_XJsonMode.prototype.createWorker=function(session){const xJsonWorker=new WorkerClient(["ace"],worker_workerModule,"JsonWorker");xJsonWorker.attachToDocument(session.getDocument());xJsonWorker.on("annotate",(function(e){session.setAnnotations(e.data)}));xJsonWorker.on("terminate",(function(){session.clearAnnotations()}));return xJsonWorker};function installXJsonMode(editor){const session=editor.getSession();session.setMode(new x_json_XJsonMode)}const script_oop=brace_default.a.acequire("ace/lib/oop");const TextMode=brace_default.a.acequire("ace/mode/text").Mode;const script_MatchingBraceOutdent=brace_default.a.acequire("ace/mode/matching_brace_outdent").MatchingBraceOutdent;const script_CstyleBehaviour=brace_default.a.acequire("ace/mode/behaviour/cstyle").CstyleBehaviour;const script_CStyleFoldMode=brace_default.a.acequire("ace/mode/folding/cstyle").FoldMode;brace_default.a.acequire("ace/tokenizer");function ScriptMode(){this.$outdent=new script_MatchingBraceOutdent;this.$behaviour=new script_CstyleBehaviour;this.foldingRules=new script_CStyleFoldMode}script_oop.inherits(ScriptMode,TextMode);(function(){this.HighlightRules=ScriptHighlightRules;this.getNextLineIndent=function(state,line,tab){let indent=this.$getIndent(line);const match=line.match(/^.*[\{\[]\s*$/);if(match){indent+=tab}return indent};this.checkOutdent=function(state,line,input){return this.$outdent.checkOutdent(line,input)};this.autoOutdent=function(state,doc,row){this.$outdent.autoOutdent(doc,row)}}).call(ScriptMode.prototype);function addEOL(tokens,reg,nextIfEOL,normalNext){if(typeof reg==="object"){reg=reg.source}return[{token:tokens.concat(["whitespace"]),regex:reg+"(\\s*)$",next:nextIfEOL},{token:tokens,regex:reg,next:normalNext}]}function mergeTokens(){return[].concat.apply([],arguments)}const input_highlight_rules_oop=brace_default.a.acequire("ace/lib/oop");const{TextHighlightRules:input_highlight_rules_TextHighlightRules}=brace_default.a.acequire("ace/mode/text_highlight_rules");function InputHighlightRules(){this.$rules={"start-sql":[{token:"whitespace",regex:"\\s+"},{token:"paren.lparen",regex:"{",next:"json-sql",push:true},{regex:"",next:"start"}],start:mergeTokens([{token:"warning",regex:"#!.*$"},{token:"comment",regex:/^#.*$/},{token:"paren.lparen",regex:"{",next:"json",push:true}],addEOL(["method"],/([a-zA-Z]+)/,"start","method_sep"),[{token:"whitespace",regex:"\\s+"},{token:"text",regex:".+?"}]),method_sep:mergeTokens(addEOL(["whitespace","url.protocol_host","url.slash"],/(\s+)(https?:\/\/[^?\/,]+)(\/)/,"start","url"),addEOL(["whitespace","url.protocol_host"],/(\s+)(https?:\/\/[^?\/,]+)/,"start","url"),addEOL(["whitespace","url.slash"],/(\s+)(\/)/,"start","url"),addEOL(["whitespace"],/(\s+)/,"start","url")),url:mergeTokens(addEOL(["url.part"],/(_sql)/,"start-sql","url-sql"),addEOL(["url.part"],/([^?\/,\s]+)/,"start"),addEOL(["url.comma"],/(,)/,"start"),addEOL(["url.slash"],/(\/)/,"start"),addEOL(["url.questionmark"],/(\?)/,"start","urlParams")),urlParams:mergeTokens(addEOL(["url.param","url.equal","url.value"],/([^&=]+)(=)([^&]*)/,"start"),addEOL(["url.param"],/([^&=]+)/,"start"),addEOL(["url.amp"],/(&)/,"start")),"url-sql":mergeTokens(addEOL(["url.part"],/([^?\/,\s]+)/,"start-sql"),addEOL(["url.comma"],/(,)/,"start-sql"),addEOL(["url.slash"],/(\/)/,"start-sql"),addEOL(["url.questionmark"],/(\?)/,"start-sql","urlParams-sql")),"urlParams-sql":mergeTokens(addEOL(["url.param","url.equal","url.value"],/([^&=]+)(=)([^&]*)/,"start-sql"),addEOL(["url.param"],/([^&=]+)/,"start-sql"),addEOL(["url.amp"],/(&)/,"start-sql"))};addToRules(this);if(this.constructor===InputHighlightRules){this.normalizeRules()}}input_highlight_rules_oop.inherits(InputHighlightRules,input_highlight_rules_TextHighlightRules);const input_oop=brace_default.a.acequire("ace/lib/oop");const input_TextMode=brace_default.a.acequire("ace/mode/text").Mode;const input_MatchingBraceOutdent=brace_default.a.acequire("ace/mode/matching_brace_outdent").MatchingBraceOutdent;const input_CstyleBehaviour=brace_default.a.acequire("ace/mode/behaviour/cstyle").CstyleBehaviour;const input_CStyleFoldMode=brace_default.a.acequire("ace/mode/folding/cstyle").FoldMode;const input_WorkerClient=brace_default.a.acequire("ace/worker/worker_client").WorkerClient;const input_AceTokenizer=brace_default.a.acequire("ace/tokenizer").Tokenizer;function Mode(){this.$tokenizer=new input_AceTokenizer((new InputHighlightRules).getRules());this.$outdent=new input_MatchingBraceOutdent;this.$behaviour=new input_CstyleBehaviour;this.foldingRules=new input_CStyleFoldMode;this.createModeDelegates({"script-":ScriptMode})}input_oop.inherits(Mode,input_TextMode);(function(){this.getCompletions=function(){return[]};this.getNextLineIndent=function(state,line,tab){let indent=this.$getIndent(line);if(state!=="string_literal"){const match=line.match(/^.*[\{\(\[]\s*$/);if(match){indent+=tab}}return indent};this.checkOutdent=function(state,line,input){return this.$outdent.checkOutdent(line,input)};this.autoOutdent=function(state,doc,row){this.$outdent.autoOutdent(doc,row)};this.createWorker=function(session){const worker=new input_WorkerClient(["ace","sense_editor"],workerModule,"SenseWorker");worker.attachToDocument(session.getDocument());worker.on("error",(function(e){session.setAnnotations([e.data])}));worker.on("ok",(function(anno){session.setAnnotations(anno.data)}));return worker}}).call(Mode.prototype);var language_tools=__webpack_require__(40);var searchbox=__webpack_require__(41);var mode_text=__webpack_require__(42);var external_osdSharedDeps_Jquery_=__webpack_require__(22);var external_osdSharedDeps_Jquery_default=__webpack_require__.n(external_osdSharedDeps_Jquery_);const toToken=(lineNumber,column,token)=>({type:token.type,value:token.value,position:{lineNumber:lineNumber,column:column}});const toTokens=(lineNumber,tokens)=>{let acc="";return tokens.map(token=>{const column=acc.length+1;acc+=token.value;return toToken(lineNumber,column,token)})};const extractTokenFromAceTokenRow=(lineNumber,column,aceTokens)=>{let acc="";for(const token of aceTokens){const start=acc.length+1;acc+=token.value;const end=acc.length;if(column<start)continue;if(column>end+1)continue;return toToken(lineNumber,start,token)}return null};class AceTokensProvider{constructor(session){this.session=session}getTokens(lineNumber){if(lineNumber<1)return null;const lineCount=this.session.getLength();if(lineNumber>lineCount){return null}const tokens=this.session.getTokens(lineNumber-1);if(!tokens||!tokens.length){return[]}return toTokens(lineNumber,tokens)}getTokenAt(pos){const tokens=this.session.getTokens(pos.lineNumber-1);if(tokens){return extractTokenFromAceTokenRow(pos.lineNumber,pos.column,tokens)}return null}}function detectCURLinLine(line){return line.match(/^\s*?curl\s+(-X[A-Z]+)?\s*['"]?.*?['"]?(\s*$|\s+?-d\s*?['"])/)}function detectCURL(text){if(!text)return false;for(const line of text.split("\n")){if(detectCURLinLine(line)){return true}}return false}function parseCURL(text){let state="NONE";const out=[];let body=[];let line="";const lines=text.trim().split("\n");let matches;const EmptyLine=/^\s*$/;const Comment=/^\s*(?:#|\/{2,})(.*)\n?$/;const ExecutionComment=/^\s*#!/;const ClosingSingleQuote=/^([^']*)'/;const ClosingDoubleQuote=/^((?:[^\\"]|\\.)*)"/;const EscapedQuotes=/^((?:[^\\"']|\\.)+)/;const LooksLikeCurl=/^\s*curl\s+/;const CurlVerb=/-X ?(GET|HEAD|POST|PUT|DELETE)/;const HasProtocol=/[\s"']https?:\/\//;const CurlRequestWithProto=/[\s"']https?:\/\/[^\/ ]+\/+([^\s"']+)/;const CurlRequestWithoutProto=/[\s"'][^\/ ]+\/+([^\s"']+)/;const CurlData=/^.+\s(--data|-d)\s*/;const SenseLine=/^\s*(GET|HEAD|POST|PUT|DELETE)\s+\/?(.+)/;if(lines.length>0&&ExecutionComment.test(lines[0])){lines.shift()}function nextLine(){if(line.length>0){return true}if(lines.length===0){return false}line=lines.shift().replace(/[\r\n]+/g,"\n")+"\n";return true}function unescapeLastBodyEl(){const str=body.pop().replace(/\\([\\"'])/g,"$1");body.push(str)}function detectQuote(){if(line.substr(0,1)==="'"){line=line.substr(1);state="SINGLE_QUOTE"}else if(line.substr(0,1)==='"'){line=line.substr(1);state="DOUBLE_QUOTE"}else{state="UNQUOTED"}}function addBodyToOut(){if(body.length>0){out.push(body.join(""));body=[]}state="LF";out.push("\n")}function consumeMatching(pattern){const result=line.match(pattern);if(result){body.push(result[1]);line=line.substr(result[0].length);detectQuote()}else{body.push(line);line=""}}function parseCurlLine(){let verb="GET";let request="";let result;if(result=line.match(CurlVerb)){verb=result[1]}const pattern=HasProtocol.test(line)?CurlRequestWithProto:CurlRequestWithoutProto;if(result=line.match(pattern)){request=result[1]}out.push(verb+" /"+request+"\n");if(result=line.match(CurlData)){line=line.substr(result[0].length);detectQuote();if(EmptyLine.test(line)){line=""}}else{state="NONE";line="";out.push("")}}while(nextLine()){if(state==="SINGLE_QUOTE"){consumeMatching(ClosingSingleQuote)}else if(state==="DOUBLE_QUOTE"){consumeMatching(ClosingDoubleQuote);unescapeLastBodyEl()}else if(state==="UNQUOTED"){consumeMatching(EscapedQuotes);if(body.length){unescapeLastBodyEl()}if(state==="UNQUOTED"){addBodyToOut();line=""}}else if(state==="BODY"){if(Comment.test(line)||EmptyLine.test(line)){addBodyToOut()}else{body.push(line);line=""}}else if(EmptyLine.test(line)){if(state!=="LF"){out.push("\n");state="LF"}line=""}else if(matches=line.match(Comment)){out.push("#"+matches[1]+"\n");state="NONE";line=""}else if(LooksLikeCurl.test(line)){parseCurlLine()}else if(matches=line.match(SenseLine)){out.push(matches[1]+" /"+matches[2]+"\n");line="";state="BODY"}else{out.push("### "+line);line=""}}addBodyToOut();return out.join("").trim()}var smart_resize=function(editor){const resize=editor.resize;const throttledResize=Object(external_osdSharedDeps_Lodash_["throttle"])(()=>{resize.call(editor,false);const userRow=Object(external_osdSharedDeps_Lodash_["get"])(throttledResize,"topRow",0);if(userRow!==0){editor.renderer.scrollToLine(userRow,false,false,()=>{})}},35);return throttledResize};function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const _AceRange=brace_default.a.acequire("ace/range").Range;const rangeToAceRange=_ref=>{let{start:start,end:end}=_ref;return new _AceRange(start.lineNumber-1,start.column-1,end.lineNumber-1,end.column-1)};class legacy_core_editor_LegacyCoreEditor{constructor(editor,actions){var _this=this;this.editor=editor;_defineProperty(this,"_aceOnPaste",void 0);_defineProperty(this,"$actions",void 0);_defineProperty(this,"resize",void 0);_defineProperty(this,"setActionsBar",(function(value){let topOrBottom=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"top";if(value===null){_this.$actions.css("visibility","hidden")}else{if(topOrBottom==="top"){_this.$actions.css({bottom:"auto",top:value,visibility:"visible"})}else{_this.$actions.css({top:"auto",bottom:value,visibility:"visible"})}}}));_defineProperty(this,"hideActionsBar",()=>{this.setActionsBar()});this.$actions=external_osdSharedDeps_Jquery_default()(actions);this.editor.setShowPrintMargin(false);const session=this.editor.getSession();session.setMode(new Mode);session.setFoldStyle("markbeginend");session.setTabSize(2);session.setUseWrapMode(true);this.resize=smart_resize(this.editor);this._aceOnPaste=this.editor.onPaste;this.editor.onPaste=this.DO_NOT_USE_onPaste.bind(this);this.editor.setOptions({enableBasicAutocompletion:true});this.editor.$blockScrolling=Infinity;this.hideActionsBar();this.editor.focus()}waitForLatestTokens(){return new Promise(resolve=>{const session=this.editor.getSession();const checkInterval=25;const check=()=>{if(session.bgTokenizer){if(session.bgTokenizer.running){setTimeout(check,checkInterval)}else{resolve()}}};setTimeout(check,0)})}getLineState(lineNumber){const session=this.editor.getSession();return session.getState(lineNumber-1)}getValueInRange(range){return this.editor.getSession().getTextRange(rangeToAceRange(range))}getTokenProvider(){return new AceTokensProvider(this.editor.getSession())}getValue(){return this.editor.getValue()}async setValue(text,forceRetokenize){const session=this.editor.getSession();session.setValue(text);if(forceRetokenize){await this.forceRetokenize()}}getLineValue(lineNumber){const session=this.editor.getSession();return session.getLine(lineNumber-1)}getCurrentPosition(){const cursorPosition=this.editor.getCursorPosition();return{lineNumber:cursorPosition.row+1,column:cursorPosition.column+1}}clearSelection(){this.editor.clearSelection()}getTokenAt(pos){const provider=this.getTokenProvider();return provider.getTokenAt(pos)}insert(valueOrPos,value){if(typeof valueOrPos==="string"){this.editor.insert(valueOrPos);return}const document=this.editor.getSession().getDocument();document.insert({column:valueOrPos.column-1,row:valueOrPos.lineNumber-1},value||"")}moveCursorToPosition(pos){this.editor.moveCursorToPosition({row:pos.lineNumber-1,column:pos.column-1})}replace(range,value){const session=this.editor.getSession();session.replace(rangeToAceRange(range),value)}getLines(startLine,endLine){const session=this.editor.getSession();return session.getLines(startLine-1,endLine-1)}replaceRange(range,value){const pos=this.editor.getCursorPosition();this.editor.getSession().replace(rangeToAceRange(range),value);const maxRow=Math.max(range.start.lineNumber-1+value.split("\n").length-1,1);pos.row=Math.min(pos.row,maxRow);this.editor.moveCursorToPosition(pos);this.editor.clearSelection()}getSelectionRange(){const result=this.editor.getSelectionRange();return{start:{lineNumber:result.start.row+1,column:result.start.column+1},end:{lineNumber:result.end.row+1,column:result.end.column+1}}}getLineCount(){return this.editor.getSession().getLength()}addMarker(range){return this.editor.getSession().addMarker(rangeToAceRange(range),"ace_snippet-marker","fullLine",false)}removeMarker(ref){this.editor.getSession().removeMarker(ref)}getWrapLimit(){return this.editor.getSession().getWrapLimit()}on(event,listener){if(event==="changeCursor"){this.editor.getSession().selection.on(event,listener)}else if(event==="changeSelection"){this.editor.on(event,listener)}else{this.editor.getSession().on(event,listener)}}off(event,listener){if(event==="changeSelection"){this.editor.off(event,listener)}}isCompleterActive(){return Boolean(this.editor.completer&&this.editor.completer.activated)}forceRetokenize(){const session=this.editor.getSession();return new Promise(resolve=>{setTimeout((function(){let i;for(i=0;i<session.getLength();i++){session.getTokens(i)}resolve()}))})}DO_NOT_USE_onPaste(text){if(text&&detectCURL(text)){const curlInput=parseCURL(text);this.editor.insert(curlInput);return}this._aceOnPaste.call(this.editor,text)}execCommand(cmd){this.editor.execCommand(cmd)}getContainer(){return this.editor.container}setStyles(styles){this.editor.getSession().setUseWrapMode(styles.wrapLines);this.editor.container.style.fontSize=styles.fontSize}registerKeyboardShortcut(opts){this.editor.commands.addCommand({exec:opts.fn,name:opts.name,bindKey:opts.keys})}legacyUpdateUI(range){if(!this.$actions){return}if(range){const offsetFromPage=external_osdSharedDeps_Jquery_default()(this.editor.container).offset().top;const startLine=range.start.lineNumber;const startColumn=range.start.column;const firstLine=this.getLineValue(startLine);const maxLineLength=this.getWrapLimit()-5;const isWrapping=firstLine.length>maxLineLength;const totalOffset=offsetFromPage-(window.pageYOffset||0);const getScreenCoords=line=>this.editor.renderer.textToScreenCoordinates(line-1,startColumn).pageY-totalOffset;const topOfReq=getScreenCoords(startLine);if(topOfReq>=0){const{bottom:maxBottom}=this.editor.container.getBoundingClientRect();if(topOfReq>maxBottom-totalOffset){this.setActionsBar(0,"bottom");return}let offset=0;if(isWrapping){const textArea=external_osdSharedDeps_Jquery_default()(this.editor.container.querySelector("textArea"));const hasRoomOnNextLine=this.getLineValue(startLine).length<maxLineLength;if(textArea&&hasRoomOnNextLine){offset+=this.getLineValue(startLine).length*textArea.height()}else{if(startLine>1){this.setActionsBar(getScreenCoords(startLine-1));return}this.setActionsBar(getScreenCoords(startLine+1));return}}this.setActionsBar(topOfReq+offset);return}const bottomOfReq=this.editor.renderer.textToScreenCoordinates(range.end.lineNumber,range.end.column).pageY-offsetFromPage;if(bottomOfReq>=0){this.setActionsBar(0);return}}}registerAutocompleter(autocompleter){brace_default.a.define("ace/autocomplete/text_completer",["require","exports","module"],(function(require,exports){exports.getCompletions=function(innerEditor,session,pos,prefix,callback){callback(null,[])}}));const langTools=brace_default.a.acequire("ace/ext/language_tools");langTools.setCompleters([{identifierRegexps:[/[a-zA-Z_0-9\.\$\-\u00A2-\uFFFF]/],getCompletions:(DO_NOT_USE_1,DO_NOT_USE_2,pos,prefix,callback)=>{const position={lineNumber:pos.row+1,column:pos.column+1};autocompleter(position,prefix,callback)}}])}destroy(){this.editor.destroy()}}const output_highlight_rules_oop=brace_default.a.acequire("ace/lib/oop");const output_highlight_rules_JsonHighlightRules=brace_default.a.acequire("ace/mode/json_highlight_rules").JsonHighlightRules;function OutputJsonHighlightRules(){this.$rules={};addToRules(this,"start");this.$rules.start.unshift({token:"warning",regex:"#!.*$"},{token:"comment",regex:"#.*$"});if(this.constructor===OutputJsonHighlightRules){this.normalizeRules()}}output_highlight_rules_oop.inherits(OutputJsonHighlightRules,output_highlight_rules_JsonHighlightRules);const output_oop=brace_default.a.acequire("ace/lib/oop");const output_JSONMode=brace_default.a.acequire("ace/mode/json").Mode;const output_MatchingBraceOutdent=brace_default.a.acequire("ace/mode/matching_brace_outdent").MatchingBraceOutdent;const output_CstyleBehaviour=brace_default.a.acequire("ace/mode/behaviour/cstyle").CstyleBehaviour;const output_CStyleFoldMode=brace_default.a.acequire("ace/mode/folding/cstyle").FoldMode;brace_default.a.acequire("ace/worker/worker_client");const output_AceTokenizer=brace_default.a.acequire("ace/tokenizer").Tokenizer;function output_Mode(){this.$tokenizer=new output_AceTokenizer((new OutputJsonHighlightRules).getRules());this.$outdent=new output_MatchingBraceOutdent;this.$behaviour=new output_CstyleBehaviour;this.foldingRules=new output_CStyleFoldMode}output_oop.inherits(output_Mode,output_JSONMode);(function(){this.createWorker=function(){return null};this.$id="sense/mode/input"}).call(output_Mode.prototype);function createReadOnlyAceEditor(element){const output=brace_default.a.acequire("ace/ace").edit(element);const outputMode=new output_Mode;output.$blockScrolling=Infinity;output.resize=smart_resize(output);output.update=(val,mode,cb)=>{if(typeof mode==="function"){cb=mode;mode=void 0}const session=output.getSession();session.setMode(val?mode||outputMode:"ace/mode/text");session.setValue(val);if(typeof cb==="function"){setTimeout(cb)}};output.append=(val,foldPrevious,cb)=>{if(typeof foldPrevious==="function"){cb=foldPrevious;foldPrevious=true}if(external_osdSharedDeps_Lodash_default.a.isUndefined(foldPrevious)){foldPrevious=true}const session=output.getSession();const lastLine=session.getLength();if(foldPrevious){output.moveCursorTo(Math.max(0,lastLine-1),0)}session.insert({row:lastLine,column:0},"\n"+val);output.moveCursorTo(lastLine+1,0);if(typeof cb==="function"){setTimeout(cb)}};(function setupSession(session){session.setMode("ace/mode/text");session.setFoldStyle("markbeginend");session.setTabSize(2);session.setUseWrapMode(true)})(output.getSession());output.setShowPrintMargin(false);output.setReadOnly(true);return output}const create=el=>{const actions=document.querySelector("#ConAppEditorActions");if(!actions){throw new Error("Could not find ConAppEditorActions element!")}const aceEditor=brace_default.a.edit(el);return new legacy_core_editor_LegacyCoreEditor(aceEditor,actions)};function applyCurrentSettings(editor,settings){if(editor.setStyles){editor.setStyles({wrapLines:settings.wrapMode,fontSize:settings.fontSize+"px"})}else{editor.getSession().setUseWrapMode(settings.wrapMode);editor.container.style.fontSize=settings.fontSize+"px"}}const inputMode=new Mode;function HistoryViewer(_ref){let{settings:settings,req:req}=_ref;const divRef=Object(external_osdSharedDeps_React_["useRef"])(null);const viewerRef=Object(external_osdSharedDeps_React_["useRef"])(null);Object(external_osdSharedDeps_React_["useEffect"])(()=>{const viewer=createReadOnlyAceEditor(divRef.current);viewerRef.current=viewer;const unsubscribe=subscribeResizeChecker(divRef.current,viewer);return()=>unsubscribe()},[]);Object(external_osdSharedDeps_React_["useEffect"])(()=>{applyCurrentSettings(viewerRef.current,settings)},[settings]);if(viewerRef.current){const{current:viewer}=viewerRef;if(req){const s=req.method+" "+req.endpoint+"\n"+(req.data||"");viewer.update(s,inputMode);viewer.clearSelection()}else{viewer.update(external_osdSharedDeps_OsdI18n_["i18n"].translate("console.historyPage.noHistoryTextMessage",{defaultMessage:"No history available"}),inputMode)}}return external_osdSharedDeps_React_default.a.createElement("div",{className:"conHistory__viewer",ref:divRef})}function editor_registry_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class EditorRegistry{constructor(){editor_registry_defineProperty(this,"inputEditor",void 0)}setInputEditor(inputEditor){this.inputEditor=inputEditor}getInputEditor(){return this.inputEditor}}const instance=new EditorRegistry;const useSetInputEditor=()=>{const dispatch=useEditorActionContext();return Object(external_osdSharedDeps_React_["useCallback"])(editor=>{dispatch({type:"setInputEditor",payload:editor});instance.setInputEditor(editor)},[dispatch])};function row_parser_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const MODE={REQUEST_START:2,IN_REQUEST:4,MULTI_DOC_CUR_DOC_END:8,REQUEST_END:16,BETWEEN_REQUESTS:32};class RowParser{constructor(editor){this.editor=editor;row_parser_defineProperty(this,"MODE",MODE)}getRowParseMode(){let lineNumber=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.editor.getCurrentPosition().lineNumber;const linesCount=this.editor.getLineCount();if(lineNumber>linesCount||lineNumber<1){return MODE.BETWEEN_REQUESTS}const mode=this.editor.getLineState(lineNumber);if(!mode){return MODE.BETWEEN_REQUESTS}if(mode!=="start"&&mode!=="start-sql"){return MODE.IN_REQUEST}let line=(this.editor.getLineValue(lineNumber)||"").trim();if(!line||line[0]==="#"){return MODE.BETWEEN_REQUESTS}if(line.indexOf("}",line.length-1)>=0){lineNumber++;if(lineNumber<linesCount+1){line=(this.editor.getLineValue(lineNumber)||"").trim();if(line.indexOf("{")===0){return MODE.MULTI_DOC_CUR_DOC_END|MODE.IN_REQUEST}}return MODE.REQUEST_END|MODE.MULTI_DOC_CUR_DOC_END}lineNumber++;if(lineNumber>=linesCount+1){return MODE.REQUEST_START|MODE.REQUEST_END}line=(this.editor.getLineValue(lineNumber)||"").trim();if(line.indexOf("{")!==0){return MODE.REQUEST_START|MODE.REQUEST_END}return MODE.REQUEST_START}rowPredicate(lineNumber,editor,value){const mode=this.getRowParseMode(lineNumber);return(mode&value)>0}isEndRequestRow(row,_e){const editor=_e||this.editor;return this.rowPredicate(row,editor,MODE.REQUEST_END)}isRequestEdge(row,_e){const editor=_e||this.editor;return this.rowPredicate(row,editor,MODE.REQUEST_END|MODE.REQUEST_START)}isStartRequestRow(row,_e){const editor=_e||this.editor;return this.rowPredicate(row,editor,MODE.REQUEST_START)}isInBetweenRequestsRow(row,_e){const editor=_e||this.editor;return this.rowPredicate(row,editor,MODE.BETWEEN_REQUESTS)}isInRequestsRow(row,_e){const editor=_e||this.editor;return this.rowPredicate(row,editor,MODE.IN_REQUEST)}isMultiDocDocEndRow(row,_e){const editor=_e||this.editor;return this.rowPredicate(row,editor,MODE.MULTI_DOC_CUR_DOC_END)}isEmptyToken(tokenOrTokenIter){const token=tokenOrTokenIter&&tokenOrTokenIter.getCurrentToken?tokenOrTokenIter.getCurrentToken():tokenOrTokenIter;return!token||token.type==="whitespace"}isUrlOrMethodToken(tokenOrTokenIter){var _getCurrentToken;const t=(_getCurrentToken=tokenOrTokenIter===null||tokenOrTokenIter===void 0?void 0:tokenOrTokenIter.getCurrentToken())!==null&&_getCurrentToken!==void 0?_getCurrentToken:tokenOrTokenIter;return t&&t.type&&(t.type==="method"||t.type.indexOf("url")===0)}nextNonEmptyToken(tokenIter){let t=tokenIter.stepForward();while(t&&this.isEmptyToken(t)){t=tokenIter.stepForward()}return t}prevNonEmptyToken(tokenIter){let t=tokenIter.stepBackward();while((t||tokenIter.getCurrentPosition().lineNumber>1)&&this.isEmptyToken(t))t=tokenIter.stepBackward();return t}}function restore_request_from_history_restoreRequestFromHistory(editor,req){const coreEditor=editor.getCoreEditor();let pos=coreEditor.getCurrentPosition();let prefix="";let suffix="\n";const parser=new RowParser(coreEditor);if(parser.isStartRequestRow(pos.lineNumber)){pos.column=1;suffix+="\n"}else if(parser.isEndRequestRow(pos.lineNumber)){const line=coreEditor.getLineValue(pos.lineNumber);pos.column=line.length+1;prefix="\n\n"}else if(parser.isInBetweenRequestsRow(pos.lineNumber)){pos.column=1}else{pos=editor.nextRequestEnd(pos);prefix="\n\n"}let s=prefix+req.method+" "+req.endpoint;if(req.data){s+="\n"+req.data}s+=suffix;coreEditor.insert(pos,s);coreEditor.moveCursorToPosition({lineNumber:pos.lineNumber+prefix.length,column:1});coreEditor.clearSelection();coreEditor.getContainer().focus()}const useRestoreRequestFromHistory=()=>Object(external_osdSharedDeps_React_["useCallback"])(req=>{const editor=instance.getInputEditor();restore_request_from_history_restoreRequestFromHistory(editor,req)},[]);const maxIntAsString=String(Number.MAX_SAFE_INTEGER);const maxIntLength=maxIntAsString.length;const longNumeralMatcherTokens=["\\d{".concat(maxIntAsString.length+1,",}")];for(let i=0;i<maxIntLength;i++){if(maxIntAsString[i]!=="9"){longNumeralMatcherTokens.push(maxIntAsString.substring(0,i)+"[".concat(parseInt(maxIntAsString[i],10)+1,"-9]")+"\\d{".concat(maxIntLength-i-1,"}"))}}const longNumeralMatcher=new RegExp('((?:\\[|,|(?<!\\\\)"\\s*:)\\s*)(-?(?:'.concat(longNumeralMatcherTokens.join("|"),"))(\\s*)(?=,|}|]|$)"),"g");const markerChars=["","",""];const getMarkerChoices=length=>{if(!length||length<0)return[];const choices=[];const arr=markerChars;const arrLength=arr.length;const temp=Array(length);(function fill(pos,start){if(pos===length)return choices.push(temp.join(""));for(let i=start;i<arrLength;i++){temp[pos]=arr[i];fill(pos+1,i)}})(0,0);return choices};const getMarker=text=>{let marker;let length=0;do{length++;getMarkerChoices(length).some(markerChoice=>{if(text.indexOf(markerChoice)===-1){marker=markerChoice;return true}})}while(!marker);return{marker:marker,length:length}};const parseStringWithLongNumerals=(text,reviver)=>{const{marker:marker,length:length}=getMarker(text);let hadException;let obj;let markedJSON=text.replace(longNumeralMatcher,'$1"'.concat(marker,'$2"$3'));const markedValueMatcher=new RegExp("^".concat(marker,"-?\\d+$"));const convertMarkedValues=val=>typeof val==="string"&&val.startsWith(marker)&&markedValueMatcher.test(val)?BigInt(val.substring(length)):val;const parseMarkedText=reviver?markedText=>JSON.parse(markedText,(function(key,val){return reviver.call(this,key,convertMarkedValues(val))})):markedText=>JSON.parse(markedText,(key,val)=>convertMarkedValues(val));do{try{hadException=false;obj=parseMarkedText(markedJSON)}catch(e){hadException=true;let{lineNumber:lineNumber,columnNumber:columnNumber}=e;if(!lineNumber||!columnNumber){var _e$message,_e$message$match,_e$message2;const match=e===null||e===void 0?void 0:(_e$message=e.message)===null||_e$message===void 0?void 0:(_e$message$match=(_e$message2=_e$message).match)===null||_e$message$match===void 0?void 0:_e$message$match.call(_e$message2,/^Unexpected token.*at position (\d+)$/);if(match){lineNumber=1;columnNumber=parseInt(match[1],10)+1}}if(lineNumber<1||columnNumber<2){throw e}const re=new RegExp("^((?:.*\\n){".concat(lineNumber-1,"}[^\\n]{").concat(columnNumber-2,'})"').concat(marker,'(-?\\d+)"'));if(!re.test(markedJSON)){throw e}markedJSON=markedJSON.replace(re,"$1$2")}}while(hadException);return obj};const stringifyObjectWithBigInts=(obj,candidate,replacer,space)=>{const{marker:marker}=getMarker(candidate);const markedBigIntMatcher=new RegExp('"'.concat(marker,'(-?\\d+)"'),"g");const addMarkerToBigInts=replacer?function(key,val){const newVal=replacer.call(this,key,val);return typeof newVal==="bigint"?"".concat(marker).concat(newVal.toString()):newVal}:(key,val)=>typeof val==="bigint"?"".concat(marker).concat(val.toString()):val;return JSON.stringify(obj,addMarkerToBigInts,space).replace(markedBigIntMatcher,"$1")};const stringify=(obj,replacer,space)=>{let text;let numeralsAreNumbers=true;const checkForBigInts=replacer?function(key,val){if(typeof val==="bigint"){numeralsAreNumbers=false;return replacer.call(this,key,Number(val))}return replacer.call(this,key,val)}:(key,val)=>{if(typeof val==="bigint"){numeralsAreNumbers=false;return Number(val)}return val};text=JSON.stringify(obj,checkForBigInts,space);if(!numeralsAreNumbers){text=stringifyObjectWithBigInts(obj,text,replacer,space)}return text};const parse=(text,reviver)=>{let obj;let numeralsAreNumbers=true;const inspectValueForLargeNumerals=val=>{if(numeralsAreNumbers&&typeof val==="number"&&(val<Number.MAX_SAFE_INTEGER||val>Number.MAX_SAFE_INTEGER)){numeralsAreNumbers=false}return val};const checkForLargeNumerals=reviver?function(key,val){return inspectValueForLargeNumerals(reviver.call(this,key,val))}:(key,val)=>inspectValueForLargeNumerals(val);obj=JSON.parse(text,checkForLargeNumerals);if(!numeralsAreNumbers){obj=parseStringWithLongNumerals(text,reviver)}return obj};var opensearchUiShared_public_=__webpack_require__(19);const{collapseLiteralStrings:collapseLiteralStrings,expandLiteralStrings:expandLiteralStrings}=opensearchUiShared_public_["XJson"];function textFromRequest(request){let data=request.data;if(typeof data!=="string"){data=data.join("\n")}return request.method+" "+request.url+"\n"+data}function jsonToString(data,indent){return stringify(data,null,indent?2:0)}function formatRequestBodyDoc(data,indent){let changed=false;const formattedData=[];for(let i=0;i<data.length;i++){const curDoc=data[i];try{let newDoc=jsonToString(parse(collapseLiteralStrings(curDoc)),indent);if(indent){newDoc=expandLiteralStrings(newDoc)}changed=changed||newDoc!==curDoc;formattedData.push(newDoc)}catch(e){console.log(e);formattedData.push(curDoc)}}return{changed:changed,data:formattedData}}function extractDeprecationMessages(warnings){const re=/\d{3} [0-9a-zA-Z!#$%&'*+-.^_`|~]+ \"((?:\t| |!|[\x23-\x5b]|[\x5d-\x7e]|[\x80-\xff]|\\\\|\\")*)\"(?: \"[^"]*\")?/;return external_osdSharedDeps_Lodash_default.a.map(splitOnUnquotedCommaSpace(warnings),warning=>{const match=re.exec(warning);return"#! Deprecation: "+(match!==null?utils_unescape(match[1]):warning)})}function utils_unescape(s){return s.replace(/\\\\/g,"\\").replace(/\\"/g,'"')}function splitOnUnquotedCommaSpace(s){let quoted=false;const arr=[];let buffer="";let i=0;while(i<s.length){let token=s.charAt(i++);if(token==="\\"&&i<s.length){token+=s.charAt(i++)}else if(token===","&&i<s.length&&s.charAt(i)===" "){token+=s.charAt(i++)}if(token==='"'){quoted=!quoted}else if(!quoted&&token===", "){arr.push(buffer);buffer="";continue}buffer+=token}arr.push(buffer);return arr}const opensearchVersion=[];function getVersion(){return opensearchVersion}function getContentType(body){if(!body)return;return"application/json"}async function send(http,method,path,data,dataSourceId){return await http.post("/api/console/proxy",{query:{path:path,method:method,dataSourceId:dataSourceId},body:data,prependBasePath:true,asResponse:true,withLongNumerals:true})}function constructOpenSearchUrl(baseUri,path){baseUri=baseUri.replace(/\/+$/,"");path=path.replace(/^\/+/,"");return baseUri+"/"+path}const{collapseLiteralStrings:send_request_to_opensearch_collapseLiteralStrings}=opensearchUiShared_public_["XJson"];let CURRENT_REQ_ID=0;function sendRequestToOpenSearch(args){const requests=args.requests.slice();return new Promise((resolve,reject)=>{const reqId=++CURRENT_REQ_ID;const results=[];if(reqId!==CURRENT_REQ_ID){return}if(requests.length===0){return}const isMultiRequest=requests.length>1;const sendNextRequest=async()=>{if(reqId!==CURRENT_REQ_ID){resolve(results);return}if(requests.length===0){resolve(results);return}const req=requests.shift();const opensearchPath=req.url;const opensearchMethod=req.method;let opensearchData=send_request_to_opensearch_collapseLiteralStrings(req.data.join("\n"));if(opensearchData){opensearchData+="\n"}const startTime=Date.now();try{var _httpResponse$respons;const httpResponse=await send(args.http,opensearchMethod,opensearchPath,opensearchData,args.dataSourceId);if(reqId!==CURRENT_REQ_ID){return}const statusCode=(_httpResponse$respons=httpResponse.response)===null||_httpResponse$respons===void 0?void 0:_httpResponse$respons.status;const isSuccess=statusCode&&(statusCode>=200&&statusCode<300||statusCode===404);if(isSuccess){const contentType=httpResponse.response.headers.get("Content-Type");let value="";if(contentType.includes("application/json")){value=stringify(httpResponse.body,null,2)}else{value=httpResponse.body}const warnings=httpResponse.response.headers.get("warning");if(warnings){const deprecationMessages=extractDeprecationMessages(warnings);value=deprecationMessages.join("\n")+"\n"+value}if(isMultiRequest){value="# "+req.method+" "+req.url+"\n"+value}results.push({response:{timeMs:Date.now()-startTime,statusCode:statusCode,statusText:httpResponse.response.statusText,contentType:contentType,value:value},request:{data:opensearchData,method:opensearchMethod,path:opensearchPath}});await sendNextRequest()}}catch(error){const httpError=error;const httpResponse=httpError.response;let value;let contentType;if(httpResponse){if(httpError.body){var _contentType;contentType=httpResponse.headers.get("Content-Type");if((_contentType=contentType)!==null&&_contentType!==void 0&&_contentType.includes("application/json")){value=stringify(httpError.body,null,2)}else{value=httpError.body}}else{value="Request failed to get to the server (status code: "+httpResponse.status+")";contentType="text/plain"}}else{value="\n\nFailed to connect to Console's backend.\nPlease check the OpenSearch Dashboards server is up and running";contentType="text/plain"}if(isMultiRequest){value="# "+req.method+" "+req.url+"\n"+value}reject({response:{value:value,contentType:contentType,timeMs:Date.now()-startTime,statusCode:httpResponse===null||httpResponse===void 0?void 0:httpResponse.status,statusText:httpResponse===null||httpResponse===void 0?void 0:httpResponse.statusText},request:{data:opensearchData,method:opensearchMethod,path:opensearchPath}})}};sendNextRequest()})}function autocomplete_component_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class AutocompleteComponent{constructor(name){autocomplete_component_defineProperty(this,"name",void 0);autocomplete_component_defineProperty(this,"next",void 0);this.name=name;this.next=[]}getTerms(context,editor){return[]}match(token,context,editor){return{next:this.next}}}function shared_component_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class shared_component_SharedComponent extends AutocompleteComponent{constructor(name,parent){super(name);shared_component_defineProperty(this,"_nextDict",void 0);shared_component_defineProperty(this,"_parent",void 0);this._nextDict={};if(parent){parent.addComponent(this)}this._parent=parent}getComponent(name){return(this._nextDict[name]||[undefined])[0]}addComponent(component){const current=this._nextDict[component.name]||[];current.push(component);this._nextDict[component.name]=current;this.next=[].concat(...Object.values(this._nextDict))}}function constant_component_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class constant_component_ConstantComponent extends shared_component_SharedComponent{constructor(name,parent,options){super(name,parent);constant_component_defineProperty(this,"options",void 0);if(external_osdSharedDeps_Lodash_default.a.isString(options)){options=[options]}this.options=options||[name]}getTerms(context,editor){return this.options}addOption(options){if(!Array.isArray(options)){options=[options]}this.options.push(...options);this.options=external_osdSharedDeps_Lodash_default.a.uniq(this.options)}match(token,context,editor){if(token!==this.name){return null}return super.match(token,context,editor)}}function list_component_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class list_component_ListComponent extends shared_component_SharedComponent{constructor(name,list,parent,multiValued,allowNonValidValues){super(name,parent);list_component_defineProperty(this,"listGenerator",void 0);list_component_defineProperty(this,"multiValued",void 0);list_component_defineProperty(this,"allowNonValidValues",void 0);this.listGenerator=Array.isArray(list)?function(){return list}:list;this.multiValued=external_osdSharedDeps_Lodash_default.a.isUndefined(multiValued)?true:multiValued;this.allowNonValidValues=external_osdSharedDeps_Lodash_default.a.isUndefined(allowNonValidValues)?false:allowNonValidValues}getTerms(context,editor){if(!this.multiValued&&context.otherTokenValues){return[]}let alreadySet=context.otherTokenValues||[];if(external_osdSharedDeps_Lodash_default.a.isString(alreadySet)){alreadySet=[alreadySet]}let ret=external_osdSharedDeps_Lodash_default.a.difference(this.listGenerator(context,editor),alreadySet);if(this.getDefaultTermMeta()){const meta=this.getDefaultTermMeta();ret=external_osdSharedDeps_Lodash_default.a.map(ret,(function(term){if(external_osdSharedDeps_Lodash_default.a.isString(term)){term={name:term}}return external_osdSharedDeps_Lodash_default.a.defaults(term,{meta:meta})}))}return ret}validateTokens(tokens){if(!this.multiValued&&tokens.length>1){return false}const list=this.listGenerator();const notFound=external_osdSharedDeps_Lodash_default.a.some(tokens,(function(token){return list.indexOf(token)===-1}));if(notFound){return false}return true}getContextKey(){return this.name}getDefaultTermMeta(){return this.name}match(token,context,editor){if(!Array.isArray(token)){token=[token]}if(!this.allowNonValidValues&&!this.validateTokens(token)){return null}const result=super.match(token,context,editor);if(result){result.context_values=result.context_values||{};result.context_values[this.getContextKey()]=token}return result}}class simple_param_component_SimpleParamComponent extends shared_component_SharedComponent{constructor(name,parent){super(name,parent)}match(token,context,editor){const result=super.match(token,context,editor);if(result){result.context_values=result.context_values||{};result.context_values[this.name]=token}return result}}function conditional_proxy_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class conditional_proxy_ConditionalProxy extends shared_component_SharedComponent{constructor(predicate,delegate){super("__condition");conditional_proxy_defineProperty(this,"predicate",void 0);conditional_proxy_defineProperty(this,"delegate",void 0);this.predicate=predicate;this.delegate=delegate}getTerms(context,editor){if(this.predicate(context,editor)){return this.delegate.getTerms(context,editor)}else{return null}}match(token,context,editor){if(this.predicate(context,editor)){return this.delegate.match(token,context,editor)}else{return false}}}class global_only_component_GlobalOnlyComponent extends shared_component_SharedComponent{getTerms(){return null}match(token,context){const result={next:[]};const globalRules=context.globalComponentResolver(token,false);if(globalRules){result.next.push.apply(result.next,globalRules)}if(result.next.length){return result}result.next=[this];return result}}function object_component_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class object_component_ObjectComponent extends shared_component_SharedComponent{constructor(name,constants,patternsAndWildCards){super(name);object_component_defineProperty(this,"constants",void 0);object_component_defineProperty(this,"patternsAndWildCards",void 0);this.constants=constants;this.patternsAndWildCards=patternsAndWildCards}getTerms(context,editor){const options=[];this.constants.forEach(component=>{options.push(...component.getTerms(context,editor))});this.patternsAndWildCards.forEach(component=>{const option=component.getTerms(context,editor);if(option){options.push(...option)}});return options}match(token,context,editor){const result={next:[]};this.constants.forEach(component=>{const componentResult=component.match(token,context,editor);if(componentResult&&componentResult.next){result.next.push(...componentResult.next)}});const globalRules=context.globalComponentResolver(token,false);if(globalRules){result.next.push.apply(result.next,globalRules)}if(result.next.length){return result}this.patternsAndWildCards.forEach(component=>{const componentResult=component.match(token,context,editor);if(componentResult&&componentResult.next){result.next.push(...componentResult.next)}});return result}}function accept_endpoint_component_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const URL_PATH_END_MARKER="__url_path_end__";class accept_endpoint_component_AcceptEndpointComponent extends shared_component_SharedComponent{constructor(endpoint,parent){super(endpoint.id,parent);accept_endpoint_component_defineProperty(this,"endpoint",void 0);this.endpoint=endpoint}match(token,context,editor){if(token!==URL_PATH_END_MARKER){return null}if(this.endpoint.methods&&!this.endpoint.methods.includes(context.method)){return null}const r=super.match(token,context,editor);if(r){r.context_values=r.context_values||{};r.context_values.endpoint=this.endpoint;if(typeof this.endpoint.priority==="number"){r.priority=this.endpoint.priority}}return r}}function full_request_component_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class full_request_component_FullRequestComponent extends constant_component_ConstantComponent{constructor(name,parent,template){super(name,parent);this.template=template;full_request_component_defineProperty(this,"name",void 0);this.name=name}getTerms(){return[{name:this.name,snippet:this.template}]}}function url_pattern_matcher_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class url_pattern_matcher_UrlPatternMatcher{constructor(parametrizedComponentFactories){url_pattern_matcher_defineProperty(this,"methodsData",void 0);url_pattern_matcher_defineProperty(this,"getTopLevelComponents",method=>{const methodRoot=this.methodsData[method];if(!methodRoot){return[]}return methodRoot.rootComponent.next});this.methodsData={};["HEAD","GET","PUT","POST","DELETE"].forEach(method=>{this.methodsData[method]={rootComponent:new shared_component_SharedComponent("ROOT"),parametrizedComponentFactories:parametrizedComponentFactories||{getComponent:()=>{}}}})}addEndpoint(pattern,endpoint){endpoint.methods.forEach(method=>{let c;let activeComponent=this.methodsData[method].rootComponent;if(endpoint.template){new full_request_component_FullRequestComponent(pattern+"[body]",activeComponent,endpoint.template)}const endpointComponents=endpoint.url_components||{};const partList=pattern.split("/");external_osdSharedDeps_Lodash_default.a.each(partList,(part,partIndex)=>{if(part.search(/^{.+}$/)>=0){part=part.substr(1,part.length-2);if(activeComponent.getComponent(part)){activeComponent=activeComponent.getComponent(part);return}if(c=endpointComponents[part]){if(Array.isArray(c)){c=new list_component_ListComponent(part,c,activeComponent)}else if(external_osdSharedDeps_Lodash_default.a.isObject(c)){const objComponent=c;if(objComponent.type==="list"){c=new list_component_ListComponent(part,objComponent.list,activeComponent,objComponent.multiValued,objComponent.allow_non_valid)}}else{console.warn("incorrectly configured url component ",part," in endpoint",endpoint);c=new shared_component_SharedComponent(part)}}else if(this.methodsData[method].parametrizedComponentFactories.getComponent(part)){c=this.methodsData[method].parametrizedComponentFactories.getComponent(part);c=c(part,activeComponent)}else{c=new simple_param_component_SimpleParamComponent(part,activeComponent)}activeComponent=c}else{let lookAhead=part;let s;for(partIndex++;partIndex<partList.length;partIndex++){s=partList[partIndex];if(s.indexOf("{")>=0){break}lookAhead+="/"+s}if(activeComponent.getComponent(part)){activeComponent=activeComponent.getComponent(part);activeComponent.addOption(lookAhead)}else{c=new constant_component_ConstantComponent(part,activeComponent,lookAhead);activeComponent=c}}});new accept_endpoint_component_AcceptEndpointComponent(endpoint,activeComponent)})}}const POLL_INTERVAL=6e4;let pollTimeoutId;let perIndexTypes={};let perAliasIndices={};let mappings_templates=[];function expandAliases(indicesOrAliases){if(!indicesOrAliases){return indicesOrAliases}if(typeof indicesOrAliases==="string"){indicesOrAliases=[indicesOrAliases]}const mappedIndicesOrAliases=indicesOrAliases.map(iOrA=>{if(perAliasIndices[iOrA]){return perAliasIndices[iOrA]}return[iOrA]});let ret=[].concat(...mappedIndicesOrAliases);ret.sort();ret=ret.reduce((result,value,index,array)=>{const last=array[index-1];if(last!==value){result.push(value)}return result},[]);return ret.length>1?ret:ret[0]}function getTemplates(){return[...mappings_templates]}function getFields(indices,types){let ret=[];indices=expandAliases(indices);if(typeof indices==="string"){const typeDict=perIndexTypes[indices];if(!typeDict){return[]}if(typeof types==="string"){const f=typeDict[types];ret=f?f:[]}else{Object.entries(typeDict).forEach(_ref=>{let[type,fields]=_ref;if(!types||types.length===0||types.includes(type)){ret.push(fields)}})}}else{Object.keys(perIndexTypes).forEach(index=>{if(!indices||indices.length===0||indices.includes(index)){ret.push(getFields(index,types))}})}return external_osdSharedDeps_Lodash_default.a.uniqBy(external_osdSharedDeps_Lodash_default.a.flatten(ret),f=>f.name+":"+f.type)}function getTypes(indices){let ret=[];indices=expandAliases(indices);if(typeof indices==="string"){const typeDict=perIndexTypes[indices];if(!typeDict){return[]}if(Array.isArray(typeDict)){typeDict.forEach(type=>{ret.push(type)})}else if(typeof typeDict==="object"){Object.keys(typeDict).forEach(type=>{ret.push(type)})}}else{Object.keys(perIndexTypes).forEach(index=>{if(!indices||indices.includes(index)){ret.push(...getTypes(index))}});ret=[].concat.apply([],ret)}return external_osdSharedDeps_Lodash_default.a.uniq(ret)}function getIndices(includeAliases){const ret=[];Object.keys(perIndexTypes).forEach(index=>{ret.push(index)});if(typeof includeAliases==="undefined"?true:includeAliases){Object.keys(perAliasIndices).forEach(alias=>{ret.push(alias)})}return ret}function getFieldNamesFromFieldMapping(fieldName,fieldMapping){if(fieldMapping.enabled===false){return[]}let nestedFields;function applyPathSettings(nestedFieldNames){const pathType=fieldMapping.path||"full";if(pathType==="full"){return nestedFieldNames.map(f=>{f.name=fieldName+"."+f.name;return f})}return nestedFieldNames}if(fieldMapping.properties){nestedFields=getFieldNamesFromProperties(fieldMapping.properties);return applyPathSettings(nestedFields)}const fieldType=fieldMapping.type;const ret={name:fieldName,type:fieldType};if(fieldMapping.index_name){ret.name=fieldMapping.index_name}if(fieldMapping.fields){nestedFields=Object.entries(fieldMapping.fields).flatMap(_ref2=>{let[nestedFieldName,nestedFieldMapping]=_ref2;return getFieldNamesFromFieldMapping(nestedFieldName,nestedFieldMapping)});nestedFields=applyPathSettings(nestedFields);nestedFields.unshift(ret);return nestedFields}return[ret]}function getFieldNamesFromProperties(){let properties=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const fieldList=Object.entries(properties).flatMap(_ref3=>{let[fieldName,fieldMapping]=_ref3;return getFieldNamesFromFieldMapping(fieldName,fieldMapping)});return external_osdSharedDeps_Lodash_default.a.uniqBy(fieldList,(function(f){return f.name+":"+f.type}))}function loadTemplates(){let templatesObject=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};mappings_templates=Object.keys(templatesObject)}function loadMappings(mappings){perIndexTypes={};if(mappings==="{}")return;Object.entries(mappings).forEach(_ref4=>{let[index,indexMapping]=_ref4;const normalizedIndexMappings={};if(indexMapping.mappings&&Object.keys(indexMapping).length===1){indexMapping=indexMapping.mappings}Object.entries(indexMapping).forEach(_ref5=>{let[typeName,typeMapping]=_ref5;if(typeName==="properties"){const fieldList=getFieldNamesFromProperties(typeMapping);normalizedIndexMappings[typeName]=fieldList}else{normalizedIndexMappings[typeName]=[]}});perIndexTypes[index]=normalizedIndexMappings})}function loadAliases(aliases){perAliasIndices={};Object.entries(aliases).forEach(_ref6=>{let[index,indexAliases]=_ref6;perIndexTypes[index]=perIndexTypes[index]||{};Object.keys(indexAliases.aliases||{}).forEach(alias=>{if(alias===index){return}let curAliases=perAliasIndices[alias];if(!curAliases){curAliases=[];perAliasIndices[alias]=curAliases}curAliases.push(index)})});perAliasIndices._all=getIndices(false)}function mappings_clear(){perIndexTypes={};perAliasIndices={};mappings_templates=[]}function retrieveSettings(http,settingsKey,settingsToRetrieve,dataSourceId){const settingKeyToPathMap={fields:"_mapping",indices:"_aliases",templates:"_template"};if(settingsToRetrieve[settingsKey]===true){return send(http,"GET",settingKeyToPathMap[settingsKey],null,dataSourceId)}else{if(settingsToRetrieve[settingsKey]===false){return Promise.resolve({})}else{return Promise.resolve()}}}function clearSubscriptions(){if(pollTimeoutId){clearTimeout(pollTimeoutId)}}function isHttpResponse(object){return object&&typeof object==="object"&&"body"in object}const retrieveMappings=async(http,settingsToRetrieve,dataSourceId)=>{const response=await retrieveSettings(http,"fields",settingsToRetrieve,dataSourceId);if(isHttpResponse(response)&&response.body){const mappings=response.body;const maxMappingSize=Object.keys(mappings).length>10*1024*1024;let mappingsResponse;if(maxMappingSize){console.warn("Mapping size is larger than 10MB (".concat(Object.keys(mappings).length/1024/1024," MB). Ignoring..."));mappingsResponse="{}"}else{mappingsResponse=mappings}loadMappings(mappingsResponse)}};const retrieveAliases=async(http,settingsToRetrieve,dataSourceId)=>{const response=await retrieveSettings(http,"fields",settingsToRetrieve,dataSourceId);if(isHttpResponse(response)&&response.body){const aliases=response.body;loadAliases(aliases)}};const retrieveTemplates=async(http,settingsToRetrieve,dataSourceId)=>{const response=await retrieveSettings(http,"fields",settingsToRetrieve,dataSourceId);if(isHttpResponse(response)&&response.body){const resTemplates=response.body;loadTemplates(resTemplates)}};function retrieveAutoCompleteInfo(http,settings,settingsToRetrieve,dataSourceId){clearSubscriptions();Promise.allSettled([retrieveMappings(http,settingsToRetrieve,dataSourceId),retrieveAliases(http,settingsToRetrieve,dataSourceId),retrieveTemplates(http,settingsToRetrieve,dataSourceId)]).then(()=>{pollTimeoutId=setTimeout(()=>{if(settings.getPolling()){retrieveAutoCompleteInfo(http,settings,settings.getAutocomplete(),dataSourceId)}},POLL_INTERVAL)})}function nonValidIndexType(token){return!(token==="_all"||token[0]!=="_")}class index_autocomplete_component_IndexAutocompleteComponent extends list_component_ListComponent{constructor(name,parent,multiValued){super(name,getIndices,parent,multiValued)}validateTokens(tokens){if(!this.multiValued&&tokens.length>1){return false}return!external_osdSharedDeps_Lodash_default.a.find(tokens,nonValidIndexType)}getDefaultTermMeta(){return"index"}getContextKey(){return"indices"}}function FieldGenerator(context){return external_osdSharedDeps_Lodash_default.a.map(getFields(context.indices,context.types),(function(field){return{name:field.name,meta:field.type}}))}class field_autocomplete_component_FieldAutocompleteComponent extends list_component_ListComponent{constructor(name,parent,multiValued){super(name,FieldGenerator,parent,multiValued)}validateTokens(tokens){if(!this.multiValued&&tokens.length>1){return false}return!external_osdSharedDeps_Lodash_default.a.find(tokens,(function(token){return token.match(/[^\w.?*]/)}))}getDefaultTermMeta(){return"field"}getContextKey(){return"fields"}}function TypeGenerator(context){return getTypes(context.indices)}function type_autocomplete_component_nonValidIndexType(token){return!(token==="_all"||token[0]!=="_")}class type_autocomplete_component_TypeAutocompleteComponent extends list_component_ListComponent{constructor(name,parent,multiValued){super(name,TypeGenerator,parent,multiValued)}validateTokens(tokens){if(!this.multiValued&&tokens.length>1){return false}return!external_osdSharedDeps_Lodash_default.a.find(tokens,type_autocomplete_component_nonValidIndexType)}getDefaultTermMeta(){return"type"}getContextKey(){return"types"}}function id_autocomplete_component_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class id_autocomplete_component_IdAutocompleteComponent extends shared_component_SharedComponent{constructor(name,parent){let multi=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;super(name,parent);id_autocomplete_component_defineProperty(this,"multi_match",void 0);this.multi_match=multi}match(token,context,editor){if(!token){return null}if(!this.multi_match&&Array.isArray(token)){return null}token=Array.isArray(token)?token:[token];if(external_osdSharedDeps_Lodash_default.a.find(token,(function(t){return t.match(/[\/,]/)}))){return null}const r=super.match(token,context,editor);if(r){r.context_values=r.context_values||{};r.context_values.id=token}return r}}class template_autocomplete_component_TemplateAutocompleteComponent extends list_component_ListComponent{constructor(name,parent){super(name,getTemplates,parent,true,true)}getContextKey(){return"template"}}function nonValidUsernameType(token){return token[0]==="_"}class username_autocomplete_component_UsernameAutocompleteComponent extends list_component_ListComponent{constructor(name,parent,multiValued){super(name,getIndices,parent,multiValued)}validateTokens(tokens){if(!this.multiValued&&tokens.length>1){return false}return!external_osdSharedDeps_Lodash_default.a.find(tokens,nonValidUsernameType)}getDefaultTermMeta(){return"username"}getContextKey(){return"username"}}function param_component_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class param_component_ParamComponent extends constant_component_ConstantComponent{constructor(name,parent,description){super(name,parent);param_component_defineProperty(this,"description",void 0);this.description=description}getTerms(){const t={name:this.name};if(this.description==="__flag__"){t.meta="flag"}else{t.meta="param";t.insertValue=this.name+"="}return[t]}}function url_params_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class url_params_UrlParams{constructor(description,defaults){url_params_defineProperty(this,"rootComponent",void 0);this.rootComponent=new shared_component_SharedComponent("ROOT");if(defaults===undefined){defaults={pretty:"__flag__",format:["json","yaml"],filter_path:""}}description={...description||{},...defaults};Object.entries(description).forEach(_ref=>{let[param,pDescription]=_ref;const component=new param_component_ParamComponent(param,this.rootComponent,pDescription);if(Array.isArray(pDescription)){new list_component_ListComponent(param,pDescription,component)}else if(pDescription==="__flag__"){new list_component_ListComponent(param,["true","false"],component)}})}getTopLevelComponents(){return this.rootComponent.next}}function engine_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function wrapComponentWithDefaults(component,defaults){const originalGetTerms=component.getTerms;component.getTerms=function(context,editor){let result=originalGetTerms.call(component,context,editor);if(!result){return result}result=result.map(term=>{if(typeof term!=="object"){term={name:term}}return{...defaults,...term}});return result};return component}const tracer=function(){if(window.engine_trace){console.log(...arguments)}};function passThroughContext(context,extensionList){const result=Object.create(context);if(extensionList){Object.assign(result,...extensionList)}return result}class WalkingState{constructor(parentName,components,contextExtensionList){let depth=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;let priority=arguments.length>4?arguments[4]:undefined;engine_defineProperty(this,"name",void 0);engine_defineProperty(this,"parentName",void 0);engine_defineProperty(this,"components",void 0);engine_defineProperty(this,"contextExtensionList",void 0);engine_defineProperty(this,"depth",void 0);engine_defineProperty(this,"priority",void 0);this.parentName=parentName;this.components=components;this.contextExtensionList=contextExtensionList;this.depth=depth;this.priority=priority}}function walkTokenPath(tokenPath,walkingStates,context,editor){if(!tokenPath||tokenPath.length===0){return walkingStates}const token=tokenPath[0];const nextWalkingStates=[];tracer("starting token evaluation ["+token+"]");walkingStates.forEach(ws=>{const contextForState=passThroughContext(context,ws.contextExtensionList);ws.components.forEach(component=>{tracer("evaluating ["+token+"] with ["+component.name+"]",component);const result=component.match(token,contextForState,editor);if(result&&Object.keys(result).length!==0){tracer("matched ["+token+"] with:",result);let next;let extensionList;if(result.next&&!Array.isArray(result.next)){next=[result.next]}else{next=result.next}if(result.context_values){extensionList=[];extensionList=[...extensionList,...ws.contextExtensionList];extensionList.push(result.context_values)}else{extensionList=ws.contextExtensionList}let priority=ws.priority;if(typeof result.priority==="number"){if(typeof priority==="number"){priority=Math.min(priority,result.priority)}else{priority=result.priority}}nextWalkingStates.push(new WalkingState(component.name,next,extensionList,ws.depth+1,priority))}})});if(nextWalkingStates.length===0){return walkingStates.map(ws=>{var _ws$name;return new WalkingState((_ws$name=ws.name)!==null&&_ws$name!==void 0?_ws$name:"",[],ws.contextExtensionList)})}return walkTokenPath(tokenPath.slice(1),nextWalkingStates,context,editor)}function populateContext(tokenPath,context,editor,includeAutoComplete,components){let walkStates=walkTokenPath(tokenPath,[new WalkingState("ROOT",components,[])],context,editor);if(includeAutoComplete){let autoCompleteSet=[];walkStates.forEach(ws=>{const contextForState=passThroughContext(context,ws.contextExtensionList);ws.components.forEach(component=>{const terms=component.getTerms(contextForState,editor);if(terms){terms.forEach(term=>{if(typeof term!=="object"){term={name:term}}autoCompleteSet.push(term)})}})});autoCompleteSet=[...new Set(autoCompleteSet)];context.autoCompleteSet=autoCompleteSet}if(walkStates.length!==0){let wsToUse;walkStates=external_osdSharedDeps_Lodash_default.a.sortBy(walkStates,(function(ws){return external_osdSharedDeps_Lodash_default.a.isNumber(ws.priority)?ws.priority:Number.MAX_VALUE}));wsToUse=external_osdSharedDeps_Lodash_default.a.find(walkStates,(function(ws){return external_osdSharedDeps_Lodash_default.a.isEmpty(ws.components)}));if(!wsToUse&&walkStates.length>1&&!includeAutoComplete){console.info("more then one context active for current path, but autocomplete isn't requested",walkStates)}if(!wsToUse){wsToUse=walkStates[0]}external_osdSharedDeps_Lodash_default.a.each(wsToUse.contextExtensionList,(function(extension){external_osdSharedDeps_Lodash_default.a.assign(context,extension)}))}}function body_completer_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class CompilingContext{constructor(endpointId,parametrizedComponentFactories){body_completer_defineProperty(this,"parametrizedComponentFactories",void 0);body_completer_defineProperty(this,"endpointId",void 0);this.parametrizedComponentFactories=parametrizedComponentFactories;this.endpointId=endpointId}}function resolvePathToComponents(tokenPath,context,editor,components){const walkStates=walkTokenPath(tokenPath,[new WalkingState("ROOT",components,[])],context,editor);const result=[].concat.apply([],external_osdSharedDeps_Lodash_default.a.map(walkStates,"components"));return result}class body_completer_ScopeResolver extends shared_component_SharedComponent{constructor(link,compilingContext){super("__scope_link");body_completer_defineProperty(this,"link",void 0);body_completer_defineProperty(this,"compilingContext",void 0);if(external_osdSharedDeps_Lodash_default.a.isString(link)&&link[0]==="."){if(link==="."){link=compilingContext.endpointId}else{link=compilingContext.endpointId+link}}this.link=link;this.compilingContext=compilingContext}resolveLinkToComponents(context,editor){if(external_osdSharedDeps_Lodash_default.a.isFunction(this.link)){const desc=this.link(context,editor);return compileDescription(desc,this.compilingContext)}if(!external_osdSharedDeps_Lodash_default.a.isString(this.link)){throw new Error("unsupported link format",this.link)}let path=this.link.replace(/\./g,"{").split(/(\{)/);const endpoint=path[0];let components;try{if(endpoint==="GLOBAL"){if(path.length<3){throw new Error("missing term in global link: "+this.link)}const term=path[2];components=context.globalComponentResolver(term);path=path.slice(3)}else{path=path.slice(1);components=context.endpointComponentResolver(endpoint)}}catch(e){throw new Error("failed to resolve link ["+this.link+"]: "+e)}return resolvePathToComponents(path,context,editor,components)}getTerms(context,editor){const options=[];const components=this.resolveLinkToComponents(context,editor);external_osdSharedDeps_Lodash_default.a.each(components,(function(component){const option=component.getTerms(context,editor);if(option){options.push.apply(options,option)}}));return options}match(token,context,editor){const result={next:[]};const components=this.resolveLinkToComponents(context,editor);external_osdSharedDeps_Lodash_default.a.each(components,(function(component){const componentResult=component.match(token,context,editor);if(componentResult&&componentResult.next){var _result$next;(_result$next=result.next)===null||_result$next===void 0?void 0:_result$next.push.apply(result.next,componentResult.next)}}));return result}}function getTemplate(description){if(Array.isArray(description)){if(description.length===1){if(external_osdSharedDeps_Lodash_default.a.isObject(description[0])){const innerTemplate=getTemplate(description[0]);return innerTemplate!=null?[innerTemplate]:[]}}return[]}else if(external_osdSharedDeps_Lodash_default.a.isString(description)){return description}else if(description.__template){if(description.__raw&&external_osdSharedDeps_Lodash_default.a.isString(description.__template)){return{__raw:true,value:description.__template}}return description.__template}else if(description.__one_of){return getTemplate(description.__one_of[0])}else if(description.__any_of){return[]}else if(description.__scope_link){return{}}else if(external_osdSharedDeps_Lodash_default.a.isObject(description)){return{}}else{return description}}function getOptions(description){const options={};const template=getTemplate(description);if(!external_osdSharedDeps_Lodash_default.a.isUndefined(template)){options.template=template}return options}function compileDescription(description,compilingContext){if(Array.isArray(description)){return[compileList(description,compilingContext)]}else if(external_osdSharedDeps_Lodash_default.a.isObject(description)){if(description.__scope_link){return[new body_completer_ScopeResolver(description.__scope_link,compilingContext)]}if(description.__any_of){return[compileList(description.__any_of,compilingContext)]}if(description.__one_of){return external_osdSharedDeps_Lodash_default.a.flatten(external_osdSharedDeps_Lodash_default.a.map(description.__one_of,(function(d){return compileDescription(d,compilingContext)})))}const obj=compileObject(description,compilingContext);if(description.__condition){return[compileCondition(description.__condition,obj)]}else{return[obj]}}else if(external_osdSharedDeps_Lodash_default.a.isString(description)&&/^\{.*\}$/.test(description)){return[compileParametrizedValue(description,compilingContext)]}else{return[new constant_component_ConstantComponent(description)]}}function compileParametrizedValue(value,compilingContext,template){var _compilingContext$par;value=value.substr(1,value.length-2).toLowerCase();const componentFactory=(_compilingContext$par=compilingContext.parametrizedComponentFactories)===null||_compilingContext$par===void 0?void 0:_compilingContext$par.getComponent(value,true);if(!componentFactory){throw new Error("no factory found for '"+value+"'")}let component=componentFactory(value,null,!!template);if(!external_osdSharedDeps_Lodash_default.a.isUndefined(template)){component=wrapComponentWithDefaults(component,{template:template})}return component}function compileObject(objDescription,compilingContext){const objectC=new constant_component_ConstantComponent("{");const constants=[];const patterns=[];external_osdSharedDeps_Lodash_default.a.each(objDescription,(function(desc,key){if(key.indexOf("__")===0){return}const options=getOptions(desc);let component;if(/^\{.*\}$/.test(key)){component=compileParametrizedValue(key,compilingContext,options.template);patterns.push(component)}else if(key==="*"){component=new shared_component_SharedComponent(key);patterns.push(component)}else{options.name=key;component=new constant_component_ConstantComponent(key,null,[options]);constants.push(component)}external_osdSharedDeps_Lodash_default.a.map(compileDescription(desc,compilingContext),(function(subComponent){component.addComponent(subComponent)}))}));objectC.addComponent(new object_component_ObjectComponent("inner",constants,patterns));return objectC}function compileList(listRule,compilingContext){const listC=new constant_component_ConstantComponent("[");external_osdSharedDeps_Lodash_default.a.each(listRule,(function(desc){external_osdSharedDeps_Lodash_default.a.each(compileDescription(desc,compilingContext),(function(component){listC.addComponent(component)}))}));return listC}function compileCondition(description,compiledObject){if(description.lines_regex){return new conditional_proxy_ConditionalProxy((function(context,editor){const lines=editor.getLines(context.requestStartRow,editor.getCurrentPosition().lineNumber).join("\n");return new RegExp(description.lines_regex,"m").test(lines)}),compiledObject)}else{throw new Error("unknown condition type - got: "+JSON.stringify(description))}}function globalsOnlyAutocompleteComponents(){return[new global_only_component_GlobalOnlyComponent("__global__")]}function compileBodyDescription(endpointId,description,parametrizedComponentFactories){return compileDescription(description,new CompilingContext(endpointId,parametrizedComponentFactories))}function api_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class api_Api{constructor(urlParametrizedComponentFactories,bodyParametrizedComponentFactories){api_defineProperty(this,"globalRules",void 0);api_defineProperty(this,"endpoints",void 0);api_defineProperty(this,"urlPatternMatcher",void 0);api_defineProperty(this,"globalBodyComponentFactories",void 0);api_defineProperty(this,"name",void 0);this.globalRules=Object.create(null);this.endpoints=Object.create(null);this.urlPatternMatcher=new url_pattern_matcher_UrlPatternMatcher(urlParametrizedComponentFactories);this.globalBodyComponentFactories=bodyParametrizedComponentFactories;this.name=""}addGlobalAutocompleteRules(parentNode,rules){this.globalRules[parentNode]=compileBodyDescription("GLOBAL."+parentNode,rules,this.globalBodyComponentFactories)}getGlobalAutocompleteComponents(term,throwOnMissing){const result=this.globalRules[term];if(external_osdSharedDeps_Lodash_default.a.isUndefined(result)&&(throwOnMissing||external_osdSharedDeps_Lodash_default.a.isUndefined(throwOnMissing))){throw new Error("failed to resolve global components for  ['"+term+"']")}return result}addEndpointDescription(endpoint,description){const copiedDescription={};external_osdSharedDeps_Lodash_default.a.assign(copiedDescription,description||{});external_osdSharedDeps_Lodash_default.a.defaults(copiedDescription,{id:endpoint,patterns:[endpoint],methods:["GET"]});external_osdSharedDeps_Lodash_default.a.each(copiedDescription.patterns,p=>{this.urlPatternMatcher.addEndpoint(p,copiedDescription)});copiedDescription.paramsAutocomplete=new url_params_UrlParams(copiedDescription.url_params);copiedDescription.bodyAutocompleteRootComponents=compileBodyDescription(copiedDescription.id,copiedDescription.data_autocomplete_rules,this.globalBodyComponentFactories);this.endpoints[endpoint]=copiedDescription}getEndpointDescriptionByEndpoint(endpoint){return this.endpoints[endpoint]}getTopLevelUrlCompleteComponents(method){return this.urlPatternMatcher.getTopLevelComponents(method)}getUnmatchedEndpointComponents(){return globalsOnlyAutocompleteComponents()}clear(){this.endpoints={};this.globalRules={}}}let ACTIVE_API=new api_Api;const isNotAnIndexName=name=>name[0]==="_"&&name!=="_all";const idAutocompleteComponentFactory=(name,parent)=>new id_autocomplete_component_IdAutocompleteComponent(name,parent);const osd_parametrizedComponentFactories={getComponent(name,parent,provideDefault){if(this[name]){return this[name]}else if(provideDefault){return idAutocompleteComponentFactory}},index(name,parent){if(isNotAnIndexName(name))return;return new index_autocomplete_component_IndexAutocompleteComponent(name,parent,false)},indices(name,parent){if(isNotAnIndexName(name))return;return new index_autocomplete_component_IndexAutocompleteComponent(name,parent,true)},type(name,parent){return new type_autocomplete_component_TypeAutocompleteComponent(name,parent,false)},types(name,parent){return new type_autocomplete_component_TypeAutocompleteComponent(name,parent,true)},id(name,parent){return idAutocompleteComponentFactory(name,parent)},transform_id(name,parent){return idAutocompleteComponentFactory(name,parent)},username(name,parent){return new username_autocomplete_component_UsernameAutocompleteComponent(name,parent)},user(name,parent){return new username_autocomplete_component_UsernameAutocompleteComponent(name,parent)},template(name,parent){return new template_autocomplete_component_TemplateAutocompleteComponent(name,parent)},task_id(name,parent){return idAutocompleteComponentFactory(name,parent)},ids(name,parent){return idAutocompleteComponentFactory(name,parent,true)},fields(name,parent){return new field_autocomplete_component_FieldAutocompleteComponent(name,parent,true)},field(name,parent){return new field_autocomplete_component_FieldAutocompleteComponent(name,parent,false)},nodes(name,parent){return new list_component_ListComponent(name,["_local","_master","_cluster_manager","data:true","data:false","master:true","cluster_manager:true","master:false","cluster_manager:false"],parent)},node(name,parent){return new list_component_ListComponent(name,[],parent,false)}};function getUnmatchedEndpointComponents(){return ACTIVE_API.getUnmatchedEndpointComponents()}function getEndpointDescriptionByEndpoint(endpoint){return ACTIVE_API.getEndpointDescriptionByEndpoint(endpoint)}function getEndpointBodyCompleteComponents(endpoint){const desc=getEndpointDescriptionByEndpoint(endpoint);if(!desc){throw new Error("failed to resolve endpoint ['"+endpoint+"']")}return desc.bodyAutocompleteRootComponents}function getTopLevelUrlCompleteComponents(method){return ACTIVE_API.getTopLevelUrlCompleteComponents(method)}function getGlobalAutocompleteComponents(term,throwOnMissing){return ACTIVE_API.getGlobalAutocompleteComponents(term,throwOnMissing)}function loadApisFromJson(json,urlParametrizedComponentFactories,bodyParametrizedComponentFactories){urlParametrizedComponentFactories=urlParametrizedComponentFactories||osd_parametrizedComponentFactories;bodyParametrizedComponentFactories=bodyParametrizedComponentFactories||urlParametrizedComponentFactories;const api=new api_Api(urlParametrizedComponentFactories,bodyParametrizedComponentFactories);const names=[];external_osdSharedDeps_Lodash_default.a.each(json,(function(apiJson,name){names.unshift(name);external_osdSharedDeps_Lodash_default.a.each(apiJson.globals||{},(function(globalJson,globalName){api.addGlobalAutocompleteRules(globalName,globalJson)}));external_osdSharedDeps_Lodash_default.a.each(apiJson.endpoints||{},(function(endpointJson,endpointName){api.addEndpointDescription(endpointName,endpointJson)}))}));api.name=names.join(",");return api}function setActiveApi(api){if(!api){external_osdSharedDeps_Jquery_default.a.ajax({url:"../api/console/api_server",dataType:"json",headers:{"osd-xsrf":"opensearch-dashboards"}}).then((function(data){setActiveApi(loadApisFromJson(data))}),(function(jqXHR){console.log("failed to load API '"+api+"': "+jqXHR.responseText)}));return}ACTIVE_API=api}setActiveApi();const _test={loadApisFromJson:loadApisFromJson};function token_iterator_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function isColumnInTokenRange(column,token){if(column<token.position.column){return false}return column<=token.position.column+token.value.length}class TokenIterator{constructor(provider,startPosition){this.provider=provider;token_iterator_defineProperty(this,"currentTokenIdx",-1);token_iterator_defineProperty(this,"currentPosition",{lineNumber:-1,column:-1});token_iterator_defineProperty(this,"tokensLineCache",void 0);this.tokensLineCache=this.provider.getTokens(startPosition.lineNumber)||[];const tokenIdx=this.tokensLineCache.findIndex(token=>isColumnInTokenRange(startPosition.column,token));if(tokenIdx>-1){this.updatePosition({tokenIdx:tokenIdx,position:this.tokensLineCache[tokenIdx].position})}else{this.updatePosition({tokenIdx:-1,position:startPosition})}}updateLineTokens(tokens){this.tokensLineCache=tokens}updatePosition(info){this.currentTokenIdx=info.tokenIdx;this.currentPosition={...info.position}}step(direction){const nextIdx=this.currentTokenIdx+direction;let nextToken=this.tokensLineCache[nextIdx];if(nextToken){this.updatePosition({tokenIdx:nextIdx,position:nextToken.position});return nextToken}const nextLineNumber=this.currentPosition.lineNumber+direction;const nextLineTokens=this.provider.getTokens(nextLineNumber);if(nextLineTokens){this.updateLineTokens(nextLineTokens);let idx;if(direction>0){nextToken=nextLineTokens[0];idx=0}else{nextToken=nextLineTokens[nextLineTokens.length-1];idx=nextToken?nextLineTokens.length-1:0}const nextPosition=nextToken?nextToken.position:{column:1,lineNumber:nextLineNumber};this.updatePosition({tokenIdx:idx,position:nextPosition});return nextToken||null}return null}getCurrentToken(){return this.tokensLineCache[this.currentTokenIdx]||null}getCurrentPosition(){return this.currentPosition}stepBackward(){return this.step(-1)}stepForward(){return this.step(1)}getCurrentTokenLineNumber(){const currentToken=this.getCurrentToken();if(currentToken){return currentToken.position.lineNumber}return null}getCurrentTokenColumn(){const currentToken=this.getCurrentToken();if(currentToken){return currentToken.position.column}return null}}function createTokenIterator(_ref){let{editor:editor,position:position}=_ref;const provider=editor.getTokenProvider();return new TokenIterator(provider,position)}let lastEvaluatedToken=null;function isUrlParamsToken(token){switch((token||{}).type){case"url.param":case"url.equal":case"url.value":case"url.questionmark":case"url.amp":return true;default:return false}}function getCurrentMethodAndTokenPaths(editor,pos,parser,forceEndOfUrl){const tokenIter=createTokenIterator({editor:editor,position:pos});const startPos=pos;let bodyTokenPath=[];const ret={};const STATES={looking_for_key:0,looking_for_scope_start:1,start:3};let state=STATES.start;let t=tokenIter.getCurrentToken();if(t){if(startPos.column===1){t=tokenIter.stepBackward();state=STATES.looking_for_scope_start}}else{if(startPos.column===1){t=tokenIter.stepBackward();state=STATES.start}}let walkedSomeBody=false;for(;t&&t.type.indexOf("url")===-1&&t.type!=="method";t=tokenIter.stepBackward()){if(t.type!=="whitespace"){walkedSomeBody=true}switch(t.type){case"variable":if(state===STATES.looking_for_key){bodyTokenPath.unshift(t.value.trim().replace(/"/g,""))}state=STATES.looking_for_scope_start;break;case"paren.lparen":bodyTokenPath.unshift(t.value);if(state===STATES.looking_for_scope_start){state=STATES.looking_for_key}break;case"paren.rparen":state=STATES.looking_for_scope_start;let parenCount=1;t=tokenIter.stepBackward();while(t&&parenCount>0){switch(t.type){case"paren.lparen":parenCount--;break;case"paren.rparen":parenCount++;break}if(parenCount>0){t=tokenIter.stepBackward()}}if(!t){return{}}continue;case"punctuation.end_triple_quote":state=STATES.looking_for_scope_start;for(t=tokenIter.stepBackward();t;t=tokenIter.stepBackward()){if(t.type==="punctuation.start_triple_quote"){t=tokenIter.stepBackward();break}}if(!t){return{}}continue;case"punctuation.start_triple_quote":if(state===STATES.start){state=STATES.looking_for_key}else if(state===STATES.looking_for_key){state=STATES.looking_for_scope_start}bodyTokenPath.unshift('"""');continue;case"string":case"constant.numeric":case"constant.language.boolean":case"text":if(state===STATES.start){state=STATES.looking_for_key}else if(state===STATES.looking_for_key){state=STATES.looking_for_scope_start}break;case"punctuation.comma":if(state===STATES.start){state=STATES.looking_for_scope_start}break;case"punctuation.colon":case"whitespace":if(state===STATES.start){state=STATES.looking_for_key}break}}if(walkedSomeBody&&(!bodyTokenPath||bodyTokenPath.length===0)&&!forceEndOfUrl){return{}}ret.urlTokenPath=[];if(tokenIter.getCurrentPosition().lineNumber===startPos.lineNumber){if(t&&(t.type==="url.part"||t.type==="url.param"||t.type==="url.value")){if(forceEndOfUrl&&t.type==="url.part"){ret.urlTokenPath.push(t.value);ret.urlTokenPath.push(URL_PATH_END_MARKER)}t=tokenIter.stepBackward();while(t.type==="whitespace"){t=tokenIter.stepBackward()}}bodyTokenPath=null}ret.bodyTokenPath=bodyTokenPath;ret.urlParamsTokenPath=null;ret.requestStartRow=tokenIter.getCurrentPosition().lineNumber;let curUrlPart;while(t&&isUrlParamsToken(t)){switch(t.type){case"url.value":if(Array.isArray(curUrlPart)){curUrlPart.unshift(t.value)}else if(curUrlPart){curUrlPart=[t.value,curUrlPart]}else{curUrlPart=t.value}break;case"url.comma":if(!curUrlPart){curUrlPart=[]}else if(!Array.isArray(curUrlPart)){curUrlPart=[curUrlPart]}break;case"url.param":const v=curUrlPart;curUrlPart={};curUrlPart[t.value]=v;break;case"url.amp":case"url.questionmark":if(!ret.urlParamsTokenPath){ret.urlParamsTokenPath=[]}ret.urlParamsTokenPath.unshift(curUrlPart||{});curUrlPart=null;break}t=tokenIter.stepBackward()}curUrlPart=null;while(t&&t.type.indexOf("url")!==-1){switch(t.type){case"url.part":if(Array.isArray(curUrlPart)){curUrlPart.unshift(t.value)}else if(curUrlPart){curUrlPart=[t.value,curUrlPart]}else{curUrlPart=t.value}break;case"url.comma":if(!curUrlPart){curUrlPart=[]}else if(!Array.isArray(curUrlPart)){curUrlPart=[curUrlPart]}break;case"url.slash":if(curUrlPart){ret.urlTokenPath.unshift(curUrlPart);curUrlPart=null}break}t=parser.prevNonEmptyToken(tokenIter)}if(curUrlPart){ret.urlTokenPath.unshift(curUrlPart)}if(!ret.bodyTokenPath&&!ret.urlParamsTokenPath){if(ret.urlTokenPath.length>0){ret.otherTokenValues=ret.urlTokenPath[0]}}else{ret.urlTokenPath.push(URL_PATH_END_MARKER)}if(t&&t.type==="method"){ret.method=t.value}return ret}var autocomplete=function(_ref){let{coreEditor:editor,parser:parser}=_ref;function isUrlPathToken(token){switch((token||{}).type){case"url.slash":case"url.comma":case"url.part":return true;default:return false}}function addMetaToTermsList(list,meta,template){return external_osdSharedDeps_Lodash_default.a.map(list,(function(t){if(typeof t!=="object"){t={name:t}}return external_osdSharedDeps_Lodash_default.a.defaults(t,{meta:meta,template:template})}))}function applyTerm(term){const context=term.context;addReplacementInfoToContext(context,editor.getCurrentPosition(),term.insertValue);let termAsString;if(context.autoCompleteType==="body"){termAsString=typeof term.insertValue==="string"?'"'+term.insertValue+'"':term.insertValue+"";if(term.insertValue==="["||term.insertValue==="{"){termAsString=""}}else{termAsString=term.insertValue+""}let valueToInsert=termAsString;let templateInserted=false;if(context.addTemplate&&!external_osdSharedDeps_Lodash_default.a.isUndefined(term.template)&&!external_osdSharedDeps_Lodash_default.a.isNull(term.template)){let indentedTemplateLines;if(term.template.__raw&&term.template.value){indentedTemplateLines=term.template.value.split("\n")}else{indentedTemplateLines=jsonToString(term.template,true).split("\n")}let currentIndentation=editor.getLineValue(context.rangeToReplace.start.lineNumber);currentIndentation=currentIndentation.match(/^\s*/)[0];for(let i=1;i<indentedTemplateLines.length;i++){indentedTemplateLines[i]=currentIndentation+indentedTemplateLines[i]}valueToInsert+=": "+indentedTemplateLines.join("\n");templateInserted=true}else{templateInserted=true;if(term.value==="["){valueToInsert+="[]"}else if(term.value==="{"){valueToInsert+="{}"}else{templateInserted=false}}valueToInsert=context.prefixToAdd+valueToInsert+context.suffixToAdd;editor.off("changeSelection",editorChangeListener);if(context.rangeToReplace.start.column!==context.rangeToReplace.end.column){editor.replace(context.rangeToReplace,valueToInsert)}else{editor.insert(valueToInsert)}editor.clearSelection();let newPos={lineNumber:context.rangeToReplace.start.lineNumber,column:context.rangeToReplace.start.column+termAsString.length+context.prefixToAdd.length+(templateInserted?0:context.suffixToAdd.length)};const tokenIter=createTokenIterator({editor:editor,position:newPos});if(context.autoCompleteType==="body"){let nonEmptyToken=parser.nextNonEmptyToken(tokenIter);switch(nonEmptyToken?nonEmptyToken.type:"NOTOKEN"){case"paren.rparen":newPos=tokenIter.getCurrentPosition();break;case"punctuation.colon":nonEmptyToken=parser.nextNonEmptyToken(tokenIter);if((nonEmptyToken||{}).type==="paren.lparen"){nonEmptyToken=parser.nextNonEmptyToken(tokenIter);newPos=tokenIter.getCurrentPosition();if(nonEmptyToken&&nonEmptyToken.value.indexOf('"')===0){newPos.column++}}break;case"paren.lparen":case"punctuation.comma":tokenIter.stepForward();newPos=tokenIter.getCurrentPosition();break}editor.moveCursorToPosition(newPos)}editor.on("changeSelection",editorChangeListener)}function getAutoCompleteContext(ctxEditor,pos){const context={autoCompleteSet:null,endpoint:null,urlPath:null,method:null,activeScheme:null,editor:ctxEditor};context.autoCompleteType=getAutoCompleteType(pos);switch(context.autoCompleteType){case"path":addPathAutoCompleteSetToContext(context,pos);break;case"url_params":addUrlParamsAutoCompleteSetToContext(context,pos);break;case"method":addMethodAutoCompleteSetToContext(context);break;case"body":addBodyAutoCompleteSetToContext(context,pos);break;default:return null}if(!context.autoCompleteSet){return null}addReplacementInfoToContext(context,pos);context.createdWithToken=external_osdSharedDeps_Lodash_default.a.clone(context.updatedForToken);return context}function getAutoCompleteType(pos){let rowMode=parser.getRowParseMode();if(rowMode&parser.MODE.IN_REQUEST){return"body"}if(rowMode&parser.MODE.REQUEST_START){const tokenIter=createTokenIterator({editor:editor,position:pos});let t=tokenIter.getCurrentToken();while(t.type==="url.comma"){t=tokenIter.stepBackward()}switch(t.type){case"method":return"method";case"whitespace":t=parser.prevNonEmptyToken(tokenIter);switch((t||{}).type){case"method":return"path";break;default:if(isUrlPathToken(t)){return"path"}if(isUrlParamsToken(t)){return"url_params"}return null}break;default:if(isUrlPathToken(t)){return"path"}if(isUrlParamsToken(t)){return"url_params"}return null}}if(rowMode&parser.MODE.REQUEST_END){return"body"}if(editor.getLineValue(pos.lineNumber).trim()===""){rowMode=parser.getRowParseMode(pos.lineNumber-1);if(rowMode&parser.MODE.REQUEST_START&&rowMode&parser.MODE.REQUEST_END){return"body"}return"method"}return null}function addReplacementInfoToContext(context,pos,replacingTerm){context.updatedForToken=external_osdSharedDeps_Lodash_default.a.clone(editor.getTokenAt({lineNumber:pos.lineNumber,column:pos.column}));if(!context.updatedForToken){context.updatedForToken={value:"",type:"",position:{column:pos.column,lineNumber:pos.lineNumber}}}let anchorToken=context.createdWithToken;if(!anchorToken){anchorToken=context.updatedForToken}switch(context.updatedForToken.type){case"variable":case"string":case"text":case"constant.numeric":case"constant.language.boolean":case"method":case"url.index":case"url.type":case"url.id":case"url.method":case"url.endpoint":case"url.part":case"url.param":case"url.value":context.rangeToReplace={start:{lineNumber:pos.lineNumber,column:anchorToken.position.column},end:{lineNumber:pos.lineNumber,column:context.updatedForToken.position.column+context.updatedForToken.value.length}};context.replacingToken=true;break;default:if(replacingTerm&&context.updatedForToken.value===replacingTerm){context.rangeToReplace={start:{lineNumber:pos.lineNumber,column:anchorToken.column},end:{lineNumber:pos.lineNumber,column:context.updatedForToken.position.column+context.updatedForToken.value.length}};context.replacingToken=true}else{context.rangeToReplace={start:{lineNumber:pos.lineNumber,column:pos.column},end:{lineNumber:pos.lineNumber,column:pos.column}};context.replacingToken=false}break}context.textBoxPosition={lineNumber:context.rangeToReplace.start.lineNumber,column:context.rangeToReplace.start.column};switch(context.autoCompleteType){case"path":addPathPrefixSuffixToContext(context);break;case"url_params":addUrlParamsPrefixSuffixToContext(context);break;case"method":addMethodPrefixSuffixToContext(context);break;case"body":addBodyPrefixSuffixToContext(context);break}}function addBodyPrefixSuffixToContext(context){context.prefixToAdd="";context.suffixToAdd="";let tokenIter=createTokenIterator({editor:editor,position:editor.getCurrentPosition()});let nonEmptyToken=parser.nextNonEmptyToken(tokenIter);switch(nonEmptyToken?nonEmptyToken.type:"NOTOKEN"){case"NOTOKEN":case"paren.lparen":case"paren.rparen":case"punctuation.comma":context.addTemplate=true;break;case"punctuation.colon":context.addTemplate=false;nonEmptyToken=parser.nextNonEmptyToken(tokenIter);if(!(nonEmptyToken&&nonEmptyToken.value==="{")){break}nonEmptyToken=parser.nextNonEmptyToken(tokenIter);if(!(nonEmptyToken&&nonEmptyToken.value==="}")){break}context.addTemplate=true;context.rangeToReplace.end.lineNumber=tokenIter.getCurrentTokenLineNumber();context.rangeToReplace.end.column=tokenIter.getCurrentTokenColumn()+nonEmptyToken.value.length;nonEmptyToken=parser.nextNonEmptyToken(tokenIter);switch(nonEmptyToken?nonEmptyToken.type:"NOTOKEN"){case"NOTOKEN":case"paren.rparen":case"punctuation.comma":case"punctuation.colon":break;default:context.suffixToAdd=", "}break;default:context.addTemplate=true;context.suffixToAdd=", ";break}tokenIter=createTokenIterator({editor:editor,position:editor.getCurrentPosition()});nonEmptyToken=tokenIter.getCurrentToken();let insertingRelativeToToken;if(context.replacingToken){insertingRelativeToToken=0}else{const pos=editor.getCurrentPosition();if(pos.column===context.updatedForToken.position.column){insertingRelativeToToken=-1}else if(pos.column<context.updatedForToken.position.column+context.updatedForToken.value.length){insertingRelativeToToken=0}else{insertingRelativeToToken=1}}if(parser.isEmptyToken(nonEmptyToken)||insertingRelativeToToken<=0){nonEmptyToken=parser.prevNonEmptyToken(tokenIter)}switch(nonEmptyToken?nonEmptyToken.type:"NOTOKEN"){case"NOTOKEN":case"paren.lparen":case"punctuation.comma":case"punctuation.colon":case"method":break;default:if(nonEmptyToken&&nonEmptyToken.type.indexOf("url")<0){context.prefixToAdd=", "}}return context}function addUrlParamsPrefixSuffixToContext(context){context.prefixToAdd="";context.suffixToAdd=""}function addMethodPrefixSuffixToContext(context){context.prefixToAdd="";context.suffixToAdd="";const tokenIter=createTokenIterator({editor:editor,position:editor.getCurrentPosition()});const lineNumber=tokenIter.getCurrentPosition().lineNumber;const t=parser.nextNonEmptyToken(tokenIter);if(tokenIter.getCurrentPosition().lineNumber!==lineNumber||!t){context.suffixToAdd=" "}}function addPathPrefixSuffixToContext(context){context.prefixToAdd="";context.suffixToAdd=""}function addMethodAutoCompleteSetToContext(context){context.autoCompleteSet=["GET","PUT","POST","DELETE","HEAD"].map((m,i)=>({name:m,score:-i,meta:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.autocomplete.addMethodMetaText",{defaultMessage:"method"})}))}function addPathAutoCompleteSetToContext(context,pos){const ret=getCurrentMethodAndTokenPaths(editor,pos,parser);context.method=ret.method;context.token=ret.token;context.otherTokenValues=ret.otherTokenValues;context.urlTokenPath=ret.urlTokenPath;const components=getTopLevelUrlCompleteComponents(context.method);populateContext(ret.urlTokenPath,context,editor,true,components);context.autoCompleteSet=addMetaToTermsList(context.autoCompleteSet,"endpoint")}function addUrlParamsAutoCompleteSetToContext(context,pos){const ret=getCurrentMethodAndTokenPaths(editor,pos,parser);context.method=ret.method;context.otherTokenValues=ret.otherTokenValues;context.urlTokenPath=ret.urlTokenPath;if(!ret.urlTokenPath){return context}populateContext(ret.urlTokenPath,context,editor,false,getTopLevelUrlCompleteComponents(context.method));if(!context.endpoint){return context}if(!ret.urlParamsTokenPath){return context}let tokenPath=[];const currentParam=ret.urlParamsTokenPath.pop();if(currentParam){tokenPath=Object.keys(currentParam);context.otherTokenValues=currentParam[tokenPath[0]]}populateContext(tokenPath,context,editor,true,context.endpoint.paramsAutocomplete.getTopLevelComponents(context.method));return context}function addBodyAutoCompleteSetToContext(context,pos){const ret=getCurrentMethodAndTokenPaths(editor,pos,parser);context.method=ret.method;context.otherTokenValues=ret.otherTokenValues;context.urlTokenPath=ret.urlTokenPath;context.requestStartRow=ret.requestStartRow;if(!ret.urlTokenPath){return context}populateContext(ret.urlTokenPath,context,editor,false,getTopLevelUrlCompleteComponents(context.method));context.bodyTokenPath=ret.bodyTokenPath;if(!ret.bodyTokenPath){return context}context.endpointComponentResolver=getEndpointBodyCompleteComponents;context.globalComponentResolver=getGlobalAutocompleteComponents;let components;if(context.endpoint){components=context.endpoint.bodyAutocompleteRootComponents}else{components=getUnmatchedEndpointComponents()}populateContext(ret.bodyTokenPath,context,editor,true,components);return context}const evaluateCurrentTokenAfterAChange=external_osdSharedDeps_Lodash_default.a.debounce((function evaluateCurrentTokenAfterAChange(pos){let currentToken=editor.getTokenAt(pos);if(!currentToken){if(pos.lineNumber===1){lastEvaluatedToken=null;return}currentToken={position:{column:0,lineNumber:0},value:"",type:""}}currentToken.position.lineNumber=pos.lineNumber;if(parser.isEmptyToken(currentToken)){const nextToken=editor.getTokenAt({...pos,column:pos.column+1});if(parser.isEmptyToken(nextToken)){currentToken.position.column=pos.column;lastEvaluatedToken=currentToken}else{nextToken.position.lineNumber=pos.lineNumber;lastEvaluatedToken=nextToken}return}if(!lastEvaluatedToken){lastEvaluatedToken=currentToken;return}if(lastEvaluatedToken.position.column!==currentToken.position.column||lastEvaluatedToken.position.lineNumber!==currentToken.position.lineNumber||lastEvaluatedToken.value===currentToken.value){lastEvaluatedToken=currentToken;return}switch(currentToken.type||"UNKNOWN"){case"paren.lparen":case"paren.rparen":case"punctuation.colon":case"punctuation.comma":case"UNKNOWN":return}lastEvaluatedToken=currentToken;editor.execCommand("startAutocomplete")}),100);function editorChangeListener(){const position=editor.getCurrentPosition();if(position&&!editor.isCompleterActive()){evaluateCurrentTokenAfterAChange(position)}}function getCompletions(position,prefix,callback){try{const context=getAutoCompleteContext(editor,position);if(!context){callback(null,[])}else{const terms=external_osdSharedDeps_Lodash_default.a.map(context.autoCompleteSet.filter(term=>Boolean(term)&&term.name!=null),(function(term){if(typeof term!=="object"){term={name:term}}else{term=external_osdSharedDeps_Lodash_default.a.clone(term)}const defaults={value:term.name,meta:"API",score:0,context:context};if(context.autoCompleteType==="body"){defaults.completer={insertMatch(){return applyTerm(term)}}}return external_osdSharedDeps_Lodash_default.a.defaults(term,defaults)}));terms.sort((function(t1,t2){if(t1.score>t2.score){return-1}if(t1.score<t2.score){return 1}if(t1.name<t2.name){return-1}if(t1.name===t2.name){return 0}return 1}));callback(null,external_osdSharedDeps_Lodash_default.a.map(terms,(function(t,i){t.insertValue=t.insertValue||t.value;t.value=""+t.value;t.score=-i;return t})))}}catch(e){console.error(e);callback(e,null)}}editor.on("changeSelection",editorChangeListener);return{getCompletions:getCompletions,_test:{getCompletions:(_editor,_editSession,pos,prefix,callback)=>getCompletions(pos,prefix,callback),addReplacementInfoToContext:addReplacementInfoToContext,addChangeListener:()=>editor.on("changeSelection",editorChangeListener),removeChangeListener:()=>editor.off("changeSelection",editorChangeListener)}}};function getEndpointFromPosition(editor,pos,parser){const lineValue=editor.getLineValue(pos.lineNumber);const context={...getCurrentMethodAndTokenPaths(editor,{column:lineValue.length+1,lineNumber:pos.lineNumber},parser,true)};const components=getTopLevelUrlCompleteComponents(context.method);populateContext(context.urlTokenPath,context,editor,true,components);return context.endpoint}const track_track=(requests,editor,trackUiMetric)=>{const coreEditor=editor.getCoreEditor();const endpointDescription=getEndpointFromPosition(coreEditor,coreEditor.getCurrentPosition(),editor.parser);if(requests[0]&&endpointDescription){var _endpointDescription$;const eventName="".concat(requests[0].method,"_").concat((_endpointDescription$=endpointDescription.id)!==null&&_endpointDescription$!==void 0?_endpointDescription$:"unknown");trackUiMetric.count(eventName)}};const useSendCurrentRequestToOpenSearch=dataSourceId=>{const{services:{history:history,settings:settings,notifications:notifications,trackUiMetric:trackUiMetric,http:http}}=useServicesContext();const dispatch=useRequestActionContext();return Object(external_osdSharedDeps_React_["useCallback"])(async()=>{try{const editor=instance.getInputEditor();const requests=await editor.getRequestsInRange();if(!requests.length){notifications.toasts.add(external_osdSharedDeps_OsdI18n_["i18n"].translate("console.notification.error.noRequestSelectedTitle",{defaultMessage:"No request selected. Select a request by placing the cursor inside it."}));return}dispatch({type:"sendRequest",payload:undefined});setTimeout(()=>track_track(requests,editor,trackUiMetric),0);const results=await sendRequestToOpenSearch({http:http,requests:requests,dataSourceId:dataSourceId});results.forEach(_ref=>{let{request:{path:path,method:method,data:data}}=_ref;try{history.addToHistory(path,method,data)}catch(e){notifications.toasts.addError(e,{title:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.notification.error.couldNotSaveRequestTitle",{defaultMessage:"Could not save request to history."})})}});const{polling:polling}=settings.toJSON();if(polling){retrieveAutoCompleteInfo(http,settings,settings.getAutocomplete(),dataSourceId)}dispatch({type:"requestSuccess",payload:{data:results}})}catch(e){if(e!==null&&e!==void 0&&e.response){dispatch({type:"requestFail",payload:e})}else{dispatch({type:"requestFail",payload:undefined});notifications.toasts.addError(e,{title:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.notification.error.unknownErrorTitle",{defaultMessage:"Unknown Request Error"})})}}},[dispatch,http,dataSourceId,settings,notifications.toasts,trackUiMetric,history])};const WAIT_MS=500;const useSaveCurrentTextObject=()=>{const promiseChainRef=Object(external_osdSharedDeps_React_["useRef"])(Promise.resolve());const{services:{objectStorageClient:objectStorageClient}}=useServicesContext();const{currentTextObject:currentTextObject}=useEditorReadContext();return Object(external_osdSharedDeps_React_["useCallback"])(Object(external_osdSharedDeps_Lodash_["throttle"])(text=>{const{current:promise}=promiseChainRef;if(!currentTextObject)return;promise.finally(()=>objectStorageClient.text.update({...currentTextObject,text:text,updatedAt:Date.now()}))},WAIT_MS,{trailing:true}),[objectStorageClient,currentTextObject])};async function migrateToTextObjects(_ref){let{history:history,objectStorageClient:objectStorageClient}=_ref;const legacyTextContent=history.getLegacySavedEditorState();if(!legacyTextContent)return;await objectStorageClient.text.create({createdAt:Date.now(),updatedAt:Date.now(),text:legacyTextContent.content});history.deleteLegacySavedEditorState()}const DEFAULT_INPUT_VALUE='GET _search\n{\n  "query": {\n    "match_all": {}\n  }\n}';const useDataInit=()=>{const[error,setError]=Object(external_osdSharedDeps_React_["useState"])(null);const[done,setDone]=Object(external_osdSharedDeps_React_["useState"])(false);const[retryToken,setRetryToken]=Object(external_osdSharedDeps_React_["useState"])({});const retry=Object(external_osdSharedDeps_React_["useCallback"])(()=>{setRetryToken({});setDone(false);setError(null)},[]);const{services:{objectStorageClient:objectStorageClient,history:history}}=useServicesContext();const dispatch=useEditorActionContext();Object(external_osdSharedDeps_React_["useEffect"])(()=>{const load=async()=>{try{await migrateToTextObjects({history:history,objectStorageClient:objectStorageClient});const results=await objectStorageClient.text.findAll();if(!results.length){const newObject=await objectStorageClient.text.create({createdAt:Date.now(),updatedAt:Date.now(),text:DEFAULT_INPUT_VALUE});dispatch({type:"setCurrentTextObject",payload:newObject})}else{dispatch({type:"setCurrentTextObject",payload:results.sort((a,b)=>a.createdAt-b.createdAt)[0]})}}catch(e){setError(e)}finally{setDone(true)}};load()},[dispatch,objectStorageClient,history,retryToken]);return{error:error,done:done,retry:retry}};const CHILD_ELEMENT_PREFIX="historyReq";function ConsoleHistory(_ref){let{close:close}=_ref;const{services:{history:history}}=useServicesContext();const{settings:readOnlySettings}=useEditorReadContext();const[requests,setPastRequests]=Object(external_osdSharedDeps_React_["useState"])(history.getHistory());const clearHistory=Object(external_osdSharedDeps_React_["useCallback"])(()=>{history.clearHistory();setPastRequests(history.getHistory())},[history]);const listRef=Object(external_osdSharedDeps_React_["useRef"])(null);const[viewingReq,setViewingReq]=Object(external_osdSharedDeps_React_["useState"])(null);const[selectedIndex,setSelectedIndex]=Object(external_osdSharedDeps_React_["useState"])(0);const selectedReq=Object(external_osdSharedDeps_React_["useRef"])(null);const describeReq=Object(external_osdSharedDeps_React_["useMemo"])(()=>{const _describeReq=req=>{const endpoint=req.endpoint;const date=external_osdSharedDeps_Moment_default()(req.time);let formattedDate=date.format("MMM D");if(date.diff(external_osdSharedDeps_Moment_default()(),"days")>-7){formattedDate=date.fromNow()}return"".concat(endpoint," (").concat(formattedDate,")")};_describeReq.cache=new WeakMap;return Object(external_osdSharedDeps_Lodash_["memoize"])(_describeReq)},[]);const scrollIntoView=Object(external_osdSharedDeps_React_["useCallback"])(idx=>{const activeDescendant=listRef.current.querySelector("#".concat(CHILD_ELEMENT_PREFIX).concat(idx));if(activeDescendant){activeDescendant.scrollIntoView()}},[]);const initialize=Object(external_osdSharedDeps_React_["useCallback"])(()=>{const nextSelectedIndex=0;describeReq.cache=new WeakMap;setViewingReq(requests[nextSelectedIndex]);selectedReq.current=requests[nextSelectedIndex];setSelectedIndex(nextSelectedIndex);scrollIntoView(nextSelectedIndex)},[describeReq,requests,scrollIntoView]);const clear=()=>{clearHistory();initialize()};const restoreRequestFromHistory=useRestoreRequestFromHistory();Object(external_osdSharedDeps_React_["useEffect"])(()=>{initialize()},[initialize]);Object(external_osdSharedDeps_React_["useEffect"])(()=>{const done=history.change(setPastRequests);return()=>done()},[history]);return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,external_osdSharedDeps_React_default.a.createElement("div",{className:"conHistory"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_osdSharedDeps_React_default.a.createElement("h2",null,external_osdSharedDeps_OsdI18n_["i18n"].translate("console.historyPage.pageTitle",{defaultMessage:"History"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement("div",{className:"conHistory__body"},external_osdSharedDeps_React_default.a.createElement("ul",{ref:listRef,onKeyDown:ev=>{if(ev.key===external_osdSharedDeps_ElasticEui_["keys"].ENTER){restoreRequestFromHistory(selectedReq.current);return}let currentIdx=selectedIndex;if(ev.key===external_osdSharedDeps_ElasticEui_["keys"].ARROW_UP){ev.preventDefault();--currentIdx}else if(ev.key===external_osdSharedDeps_ElasticEui_["keys"].ARROW_DOWN){ev.preventDefault();++currentIdx}const nextSelectedIndex=Math.min(Math.max(0,currentIdx),requests.length-1);setViewingReq(requests[nextSelectedIndex]);selectedReq.current=requests[nextSelectedIndex];setSelectedIndex(nextSelectedIndex);scrollIntoView(nextSelectedIndex)},role:"listbox",className:"list-group conHistory__reqs",tabIndex:0,"aria-activedescendant":"".concat(CHILD_ELEMENT_PREFIX).concat(selectedIndex),"aria-label":external_osdSharedDeps_OsdI18n_["i18n"].translate("console.historyPage.requestListAriaLabel",{defaultMessage:"History of sent requests"})},requests.map((req,idx)=>{const reqDescription=describeReq(req);const isSelected=viewingReq===req;return external_osdSharedDeps_React_default.a.createElement("li",{key:idx,id:"".concat(CHILD_ELEMENT_PREFIX).concat(idx),className:"list-group-item conHistory__req ".concat(isSelected?"conHistory__req-selected":""),onClick:()=>{setViewingReq(req);selectedReq.current=req;setSelectedIndex(idx)},role:"option",onMouseEnter:()=>setViewingReq(req),onMouseLeave:()=>setViewingReq(selectedReq.current),onDoubleClick:()=>restoreRequestFromHistory(selectedReq.current),"aria-label":external_osdSharedDeps_OsdI18n_["i18n"].translate("console.historyPage.itemOfRequestListAriaLabel",{defaultMessage:"Request: {historyItem}",values:{historyItem:reqDescription}}),"aria-selected":isSelected},reqDescription,external_osdSharedDeps_React_default.a.createElement("span",{className:"conHistory__reqIcon"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIcon"],{type:"arrowRight"})))})),external_osdSharedDeps_React_default.a.createElement("div",{className:"conHistory__body__spacer"}),external_osdSharedDeps_React_default.a.createElement(HistoryViewer,{settings:readOnlySettings,req:viewingReq})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween",alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButtonEmpty"],{color:"danger",onClick:()=>clear()},external_osdSharedDeps_OsdI18n_["i18n"].translate("console.historyPage.clearHistoryButtonLabel",{defaultMessage:"Clear"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"flexEnd",alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButtonEmpty"],{color:"primary",onClick:()=>close()},external_osdSharedDeps_OsdI18n_["i18n"].translate("console.historyPage.closehistoryButtonLabel",{defaultMessage:"Close"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButton"],{color:"primary",disabled:!selectedReq,onClick:()=>restoreRequestFromHistory(selectedReq.current)},external_osdSharedDeps_OsdI18n_["i18n"].translate("console.historyPage.applyHistoryButtonLabel",{defaultMessage:"Apply"}))))))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}))}var query_string=__webpack_require__(43);const mapStatusCodeToBadgeColor=statusCode=>{if(statusCode<=199){return"default"}if(statusCode<=299){return"secondary"}if(statusCode<=399){return"primary"}if(statusCode<=499){return"warning"}return"danger"};const NetworkRequestStatusBar=_ref=>{let{requestInProgress:requestInProgress,requestResult:requestResult}=_ref;let content=null;if(requestInProgress){content=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiBadge"],{color:"hollow"},external_osdSharedDeps_OsdI18n_["i18n"].translate("console.requestInProgressBadgeText",{defaultMessage:"Request in progress"})))}else if(requestResult){const{endpoint:endpoint,method:method,statusCode:statusCode,statusText:statusText,timeElapsedMs:timeElapsedMs}=requestResult;content=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],{size:"s"},"".concat(method," ").concat(endpoint.startsWith("/")?endpoint:"/"+endpoint))},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiBadge"],{color:mapStatusCodeToBadgeColor(statusCode)},statusCode,"-",statusText))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_osdSharedDeps_OsdI18n_["i18n"].translate("console.requestTimeElapasedBadgeTooltipContent",{defaultMessage:"Time Elapsed"}))},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiBadge"],{color:"default"},timeElapsedMs,"","ms")))))}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"flexEnd",alignItems:"center",direction:"row",gutterSize:"s",responsive:false},content)};var external_osdSharedDeps_OsdI18nReact_=__webpack_require__(20);const SomethingWentWrongCallout=_ref=>{let{error:error,onButtonClick:onButtonClick}=_ref;Object(external_osdSharedDeps_React_["useEffect"])(()=>{console.error(error)},[error]);return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCallOut"],{iconType:"alert",color:"danger",title:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.loadingError.title",{defaultMessage:"Cannot load Console"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],null,external_osdSharedDeps_React_default.a.createElement("p",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.loadingError.message",defaultMessage:"Try reloading to get the latest data."}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButton"],{color:"danger",onClick:()=>onButtonClick()},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.loadingError.buttonLabel",defaultMessage:"Reload Console"})))};const TopNavMenu=_ref=>{let{items:items,disabled:disabled}=_ref;return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},items.map((item,idx)=>external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{key:idx,disabled:disabled,onClick:item.onClick,title:item.label,"data-test-subj":item.testId},item.label)))};function console_menu_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class console_menu_ConsoleMenu extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);console_menu_defineProperty(this,"mouseEnter",()=>{if(this.state.isPopoverOpen)return;this.props.getCurl().then(text=>{this.setState({curlCode:text})})});console_menu_defineProperty(this,"onButtonClick",()=>{this.setState(prevState=>({isPopoverOpen:!prevState.isPopoverOpen}))});console_menu_defineProperty(this,"closePopover",()=>{this.setState({isPopoverOpen:false})});console_menu_defineProperty(this,"openDocs",async()=>{this.closePopover();const documentation=await this.props.getDocumentation();if(!documentation){return}window.open(documentation,"_blank")});console_menu_defineProperty(this,"autoIndent",event=>{this.closePopover();this.props.autoIndent(event)});this.state={curlCode:"",isPopoverOpen:false}}async copyAsCurl(){await this.copyText(this.state.curlCode);const{addNotification:addNotification}=this.props;if(addNotification){addNotification({title:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.consoleMenu.copyAsCurlMessage",{defaultMessage:"Request copied as cURL"})})}}async copyText(text){var _window$navigator;if((_window$navigator=window.navigator)!==null&&_window$navigator!==void 0&&_window$navigator.clipboard){await window.navigator.clipboard.writeText(text)}}render(){var _window$navigator2;const button=external_osdSharedDeps_React_default.a.createElement("button",{className:"euiButtonIcon--primary",onClick:this.onButtonClick,"data-test-subj":"toggleConsoleMenu","aria-label":external_osdSharedDeps_OsdI18n_["i18n"].translate("console.requestOptionsButtonAriaLabel",{defaultMessage:"Request options"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIcon"],{type:"wrench"}));const items=[external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:"Copy as cURL",id:"ConCopyAsCurl","data-test-subj":"copyAsCurl",disabled:!((_window$navigator2=window.navigator)!==null&&_window$navigator2!==void 0&&_window$navigator2.clipboard),onClick:()=>{this.closePopover();this.copyAsCurl()}},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.requestOptions.copyAsUrlButtonLabel",defaultMessage:"Copy as cURL"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:"Open documentation","data-test-subj":"consoleMenuOpenDocs",onClick:()=>{this.openDocs()}},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.requestOptions.openDocumentationButtonLabel",defaultMessage:"Open documentation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiContextMenuItem"],{"data-test-subj":"consoleMenuAutoIndent",key:"Auto indent",onClick:this.autoIndent},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.requestOptions.autoIndentButtonLabel",defaultMessage:"Auto indent"}))];return external_osdSharedDeps_React_default.a.createElement("span",{onMouseEnter:this.mouseEnter},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPopover"],{id:"contextMenu",button:button,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downLeft"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiContextMenuPanel"],{items:items})))}}const exampleText='\n# index a doc\nPUT index/_doc/1\n{\n  "body": "here"\n}\n\n# and get it ...\nGET index/_doc/1\n';function EditorExample(props){const elemId="help-example-".concat(props.panel);const inputId="help-example-".concat(props.panel,"-input");Object(external_osdSharedDeps_React_["useEffect"])(()=>{const el=document.getElementById(elemId);el.textContent=exampleText.trim();const editor=createReadOnlyAceEditor(el);const textarea=el.querySelector("textarea");textarea.setAttribute("id",inputId);textarea.setAttribute("readonly","true");return()=>{editor.destroy()}},[elemId,inputId]);return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiScreenReaderOnly"],null,external_osdSharedDeps_React_default.a.createElement("label",{htmlFor:inputId},external_osdSharedDeps_OsdI18n_["i18n"].translate("console.exampleOutputTextarea",{defaultMessage:"Dev Tools Console editor example"}))),external_osdSharedDeps_React_default.a.createElement("div",{id:elemId,className:"conHelp__example"}))}function WelcomePanel(props){return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlyout"],{onClose:props.onDismiss,"data-test-subj":"welcomePanel",size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlyoutHeader"],{hasBorder:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"m"},external_osdSharedDeps_React_default.a.createElement("h2",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.welcomePage.pageTitle",defaultMessage:"Welcome to Console"})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlyoutBody"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],null,external_osdSharedDeps_React_default.a.createElement("h4",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.welcomePage.quickIntroTitle",defaultMessage:"Quick intro to the UI"})),external_osdSharedDeps_React_default.a.createElement("p",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.welcomePage.quickIntroDescription",defaultMessage:"The Console UI is split into two panes: an editor pane (left) and a response pane (right). Use the editor to type requests and submit them to OpenSearch. The results will be displayed in the response pane on the right side."})),external_osdSharedDeps_React_default.a.createElement("p",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.welcomePage.supportedRequestFormatTitle",defaultMessage:"Console understands requests in a compact format, similar to cURL:"})),external_osdSharedDeps_React_default.a.createElement(EditorExample,{panel:"welcome"}),external_osdSharedDeps_React_default.a.createElement("p",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.welcomePage.supportedRequestFormatDescription",defaultMessage:"While typing a request, Console will make suggestions which you can then accept by hitting Enter/Tab. These suggestions are made based on the request structure as well as your indices and types."})),external_osdSharedDeps_React_default.a.createElement("h4",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.welcomePage.quickTipsTitle",defaultMessage:"A few quick tips, while I have your attention"})),external_osdSharedDeps_React_default.a.createElement("ul",null,external_osdSharedDeps_React_default.a.createElement("li",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.welcomePage.quickTips.submitRequestDescription",defaultMessage:"Submit requests to OpenSearch using the green triangle button."})),external_osdSharedDeps_React_default.a.createElement("li",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.welcomePage.quickTips.useWrenchMenuDescription",defaultMessage:"Use the wrench menu for other useful things."})),external_osdSharedDeps_React_default.a.createElement("li",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.welcomePage.quickTips.cUrlFormatForRequestsDescription",defaultMessage:"You can paste requests in cURL format and they will be translated to the Console syntax."})),external_osdSharedDeps_React_default.a.createElement("li",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.welcomePage.quickTips.resizeEditorDescription",defaultMessage:"You can resize the editor and output panes by dragging the separator between them."})),external_osdSharedDeps_React_default.a.createElement("li",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.welcomePage.quickTips.keyboardShortcutsDescription",defaultMessage:"Study the keyboard shortcuts under the Help button. Good stuff in there!"}))))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlyoutFooter"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButton"],{fill:true,fullWidth:false,"data-test-subj":"help-close-button",onClick:props.onDismiss},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.welcomePage.closeButtonLabel",defaultMessage:"Dismiss"}))))}function DevToolsSettingsModal(props){const[fontSize,setFontSize]=Object(external_osdSharedDeps_React_["useState"])(props.settings.fontSize);const[wrapMode,setWrapMode]=Object(external_osdSharedDeps_React_["useState"])(props.settings.wrapMode);const[fields,setFields]=Object(external_osdSharedDeps_React_["useState"])(props.settings.autocomplete.fields);const[indices,setIndices]=Object(external_osdSharedDeps_React_["useState"])(props.settings.autocomplete.indices);const[templates,setTemplates]=Object(external_osdSharedDeps_React_["useState"])(props.settings.autocomplete.templates);const[polling,setPolling]=Object(external_osdSharedDeps_React_["useState"])(props.settings.polling);const[tripleQuotes,setTripleQuotes]=Object(external_osdSharedDeps_React_["useState"])(props.settings.tripleQuotes);const autoCompleteCheckboxes=[{id:"fields",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.settingsPage.fieldsLabelText",{defaultMessage:"Fields"}),stateSetter:setFields},{id:"indices",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.settingsPage.indicesAndAliasesLabelText",{defaultMessage:"Indices & Aliases"}),stateSetter:setIndices},{id:"templates",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.settingsPage.templatesLabelText",{defaultMessage:"Templates"}),stateSetter:setTemplates}];const checkboxIdToSelectedMap={fields:fields,indices:indices,templates:templates};const onAutocompleteChange=optionId=>{const option=external_osdSharedDeps_Lodash_default.a.find(autoCompleteCheckboxes,item=>item.id===optionId);if(option){option.stateSetter(!checkboxIdToSelectedMap[optionId])}};function saveSettings(){props.onSaveSettings({fontSize:fontSize,wrapMode:wrapMode,autocomplete:{fields:fields,indices:indices,templates:templates},polling:polling,tripleQuotes:tripleQuotes})}const pollingFields=fields||indices||templates?external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_["Fragment"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.settingsPage.refreshingDataLabel",defaultMessage:"Refreshing autocomplete suggestions"}),helpText:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.settingsPage.refreshingDataDescription",defaultMessage:"Console refreshes autocomplete suggestions by querying OpenSearch. Automatic refreshes may be an issue if you have a large cluster or if you have network limitations."})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSwitch"],{checked:polling,"data-test-subj":"autocompletePolling",id:"autocompletePolling",label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{defaultMessage:"Automatically refresh autocomplete suggestions",id:"console.settingsPage.pollingLabelText"}),onChange:e=>setPolling(e.target.checked)})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"autocompletePolling",id:"autocompletePolling",onClick:()=>{props.refreshAutocompleteSettings({fields:fields,indices:indices,templates:templates})}},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{defaultMessage:"Refresh autocomplete suggestions",id:"console.settingsPage.refreshButtonLabel"}))):undefined;return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiModal"],{"data-test-subj":"devToolsSettingsModal",className:"conApp__settingsModal",onClose:props.onClose},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiModalHeader"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiModalHeaderTitle"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.settingsPage.pageTitle",defaultMessage:"Console Settings"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiModalBody"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.settingsPage.fontSizeLabel",defaultMessage:"Font Size"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{autoFocus:true,"data-test-subj":"setting-font-size-input",value:fontSize,min:6,max:50,onChange:e=>{const val=parseInt(e.target.value,10);if(!val)return;setFontSize(val)}})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSwitch"],{checked:wrapMode,"data-test-subj":"settingsWrapLines",id:"wrapLines",label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{defaultMessage:"Wrap long lines",id:"console.settingsPage.wrapLongLinesLabelText"}),onChange:e=>setWrapMode(e.target.checked)})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.settingsPage.jsonSyntaxLabel",defaultMessage:"JSON syntax"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSwitch"],{checked:tripleQuotes,"data-test-subj":"tripleQuotes",id:"tripleQuotes",label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{defaultMessage:"Use triple quotes in output pane",id:"console.settingsPage.tripleQuotesMessage"}),onChange:e=>setTripleQuotes(e.target.checked)})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{labelType:"legend",label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.settingsPage.autocompleteLabel",defaultMessage:"Autocomplete"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCheckboxGroup"],{options:autoCompleteCheckboxes.map(opts=>{const{stateSetter:stateSetter,...rest}=opts;return rest}),idToSelectedMap:checkboxIdToSelectedMap,onChange:e=>{onAutocompleteChange(e)}})),pollingFields),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiModalFooter"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"settingsCancelButton",onClick:props.onClose},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.settingsPage.cancelButtonLabel",defaultMessage:"Cancel"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButton"],{fill:true,"data-test-subj":"settings-save-button",onClick:saveSettings},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.settingsPage.saveButtonLabel",defaultMessage:"Save"}))))}function HelpPanel(props){return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlyout"],{onClose:props.onClose,"data-test-subj":"helpFlyout",size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlyoutHeader"],{hasBorder:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"m"},external_osdSharedDeps_React_default.a.createElement("h2",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.helpPage.pageTitle",defaultMessage:"Help"})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlyoutBody"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],null,external_osdSharedDeps_React_default.a.createElement("h3",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{defaultMessage:"Request format",id:"console.helpPage.requestFormatTitle"})),external_osdSharedDeps_React_default.a.createElement("p",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.helpPage.requestFormatDescription",defaultMessage:"You can type one or more requests in the white editor. Console understands requests in a compact format:"})),external_osdSharedDeps_React_default.a.createElement(EditorExample,{panel:"help"}),external_osdSharedDeps_React_default.a.createElement("h3",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.helpPage.keyboardCommandsTitle",defaultMessage:"Keyboard commands"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],null),external_osdSharedDeps_React_default.a.createElement("dl",null,external_osdSharedDeps_React_default.a.createElement("dt",null,"Ctrl/Cmd + I"),external_osdSharedDeps_React_default.a.createElement("dd",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.helpPage.keyboardCommands.autoIndentDescription",defaultMessage:"Auto indent current request"})),external_osdSharedDeps_React_default.a.createElement("dt",null,"Ctrl/Cmd + /"),external_osdSharedDeps_React_default.a.createElement("dd",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.helpPage.keyboardCommands.openDocumentationDescription",defaultMessage:"Open documentation for current request"})),external_osdSharedDeps_React_default.a.createElement("dt",null,"Ctrl + Space"),external_osdSharedDeps_React_default.a.createElement("dd",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.helpPage.keyboardCommands.openAutoCompleteDescription",defaultMessage:"Open Auto complete (even if not typing)"})),external_osdSharedDeps_React_default.a.createElement("dt",null,"Ctrl/Cmd + Enter"),external_osdSharedDeps_React_default.a.createElement("dd",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.helpPage.keyboardCommands.submitRequestDescription",defaultMessage:"Submit request"})),external_osdSharedDeps_React_default.a.createElement("dt",null,"Ctrl/Cmd + Up/Down"),external_osdSharedDeps_React_default.a.createElement("dd",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.helpPage.keyboardCommands.jumpToPreviousNextRequestDescription",defaultMessage:"Jump to the previous/next request start or end."})),external_osdSharedDeps_React_default.a.createElement("dt",null,"Ctrl/Cmd + Alt + L"),external_osdSharedDeps_React_default.a.createElement("dd",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.helpPage.keyboardCommands.collapseExpandCurrentScopeDescription",defaultMessage:"Collapse/expand current scope."})),external_osdSharedDeps_React_default.a.createElement("dt",null,"Ctrl/Cmd + Option + 0"),external_osdSharedDeps_React_default.a.createElement("dd",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.helpPage.keyboardCommands.collapseAllScopesDescription",defaultMessage:"Collapse all scopes but the current one. Expand by adding a shift."})),external_osdSharedDeps_React_default.a.createElement("dt",null,"Down arrow"),external_osdSharedDeps_React_default.a.createElement("dd",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.helpPage.keyboardCommands.switchFocusToAutoCompleteMenuDescription",defaultMessage:"Switch focus to auto-complete menu. Use arrows to further select a term"})),external_osdSharedDeps_React_default.a.createElement("dt",null,"Enter/Tab"),external_osdSharedDeps_React_default.a.createElement("dd",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.helpPage.keyboardCommands.selectCurrentlySelectedInAutoCompleteMenuDescription",defaultMessage:"Select the currently selected or the top most term in auto-complete menu"})),external_osdSharedDeps_React_default.a.createElement("dt",null,"Esc"),external_osdSharedDeps_React_default.a.createElement("dd",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.helpPage.keyboardCommands.closeAutoCompleteMenuDescription",defaultMessage:"Close auto-complete menu"}))))))}const EditorContentSpinner=()=>external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPageContent"],{className:"conApp__editor__spinner"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiLoadingContent"],{lines:10}));const overwriteEnabled={id:"overwriteEnabled",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.importModeControl.overwrite.enabledLabel",{defaultMessage:"Overwrite existing queries"})};const overwriteDisabled={id:"overwriteDisabled",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.importModeControl.overwrite.disabledLabel",{defaultMessage:"Merge with existing queries"})};const importOptionsTitle=external_osdSharedDeps_OsdI18n_["i18n"].translate("console.importModeControl.importOptionsTitle",{defaultMessage:"Import options"});const ImportModeControl=_ref=>{let{initialValues:initialValues,updateSelection:updateSelection}=_ref;const[overwrite,setOverwrite]=Object(external_osdSharedDeps_React_["useState"])(initialValues.overwrite);const onChange=partial=>{if(partial.overwrite!==undefined){setOverwrite(partial.overwrite)}updateSelection({overwrite:overwrite,...partial})};const overwriteRadio=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiRadioGroup"],{options:[overwriteDisabled,overwriteEnabled],idSelected:overwrite?overwriteEnabled.id:overwriteDisabled.id,onChange:id=>onChange({overwrite:id===overwriteEnabled.id})});return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormFieldset"],{legend:{children:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_osdSharedDeps_React_default.a.createElement("span",null,importOptionsTitle))}},overwriteRadio)};const OverwriteModal=_ref=>{let{onSkip:onSkip,onConfirm:onConfirm}=_ref;return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiConfirmModal"],{title:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.overwriteModal.title",{defaultMessage:"Confirm Overwrite"}),cancelButtonText:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.overwriteModal.cancelButtonText",{defaultMessage:"Skip"}),confirmButtonText:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.overwriteModal.overwriteButtonText",{defaultMessage:"Overwrite"}),buttonColor:"danger",onCancel:onSkip,onConfirm:onConfirm,defaultFocusedButton:external_osdSharedDeps_ElasticEui_["EUI_MODAL_CONFIRM_BUTTON"],maxWidth:"500px"},external_osdSharedDeps_React_default.a.createElement("p",null,external_osdSharedDeps_OsdI18n_["i18n"].translate("console.overwriteModal.body.conflict",{defaultMessage:'Are you sure you want to overwrite the existing queries? This action cannot be undone. All existing queries will be deleted and replaced with the imported queries. If you are unsure, please choose the "{option}" option instead',values:{option:"Merge with existing queries"}})))};const OVERWRITE_ALL_DEFAULT=false;const getErrorMessage=e=>{var _e$body,_e$body2;const errorMessage=(_e$body=e.body)!==null&&_e$body!==void 0&&_e$body.error&&(_e$body2=e.body)!==null&&_e$body2!==void 0&&_e$body2.message?"".concat(e.body.error,": ").concat(e.body.message):e.message;return external_osdSharedDeps_OsdI18n_["i18n"].translate("console.ImportFlyout.importFileErrorMessage",{defaultMessage:'The file could not be processed due to error: "{error}"',values:{error:errorMessage}})};const ImportFlyout=_ref=>{let{close:close,refresh:refresh}=_ref;const[error,setError]=Object(external_osdSharedDeps_React_["useState"])();const[status,setStatus]=Object(external_osdSharedDeps_React_["useState"])("idle");const[loadingMessage,setLoadingMessage]=Object(external_osdSharedDeps_React_["useState"])();const[file,setFile]=Object(external_osdSharedDeps_React_["useState"])();const[jsonData,setJsonData]=Object(external_osdSharedDeps_React_["useState"])();const[showOverwriteModal,setShowOverwriteModal]=Object(external_osdSharedDeps_React_["useState"])(false);const[importMode,setImportMode]=Object(external_osdSharedDeps_React_["useState"])({overwrite:OVERWRITE_ALL_DEFAULT});const{services:{objectStorageClient:objectStorageClient,uiSettings:uiSettings,notifications:{toasts:toasts}}}=useServicesContext();const dateFormat=uiSettings.get("dateFormat");const setImportFile=files=>{const isFirstFileMissing=!(files!==null&&files!==void 0&&files[0]);if(isFirstFileMissing){setFile(undefined);return}const fileContent=files[0];const reader=new FileReader;reader.onload=event=>{var _event$target;const fileData=(_event$target=event.target)===null||_event$target===void 0?void 0:_event$target.result;if(typeof fileData==="string"){const parsedData=JSON.parse(fileData);setJsonData(parsedData)}};reader.readAsText(fileContent);setFile(fileContent);setStatus("idle")};const renderError=()=>{if(status!=="error"){return null}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_["Fragment"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCallOut"],{title:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.importFlyout.errorCalloutTitle",defaultMessage:"Sorry, there was an error"}),color:"danger"},external_osdSharedDeps_React_default.a.createElement("p",{"data-test-subj":"importSenseObjectsErrorText"},error)),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}))};const renderBody=()=>{if(status==="loading"){return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceAround"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"xl"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],null,external_osdSharedDeps_React_default.a.createElement("p",null,loadingMessage))))}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiForm"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.ImportFlyout.selectFileToImportFormRowLabel",defaultMessage:"Select a file to import"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFilePicker"],{accept:".ndjson, .json",name:"queryFileImport",fullWidth:true,initialPromptText:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.ImportFlyout.importPromptText",defaultMessage:"Import"}),onChange:setImportFile,"data-test-subj":"queryFilePicker"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true},external_osdSharedDeps_React_default.a.createElement(ImportModeControl,{initialValues:importMode,updateSelection:newValues=>setImportMode(newValues)})))};const importFile=async isOverwriteConfirmed=>{setStatus("loading");setError(undefined);try{const results=await objectStorageClient.text.findAll();const currentText=results.sort((a,b)=>a.createdAt-b.createdAt)[0];if(jsonData!==null&&jsonData!==void 0&&jsonData.text){if(importMode.overwrite){if(!isOverwriteConfirmed){setShowOverwriteModal(true);return}else{setLoadingMessage("Importing queries and overwriting existing ones...");const newObject={createdAt:Date.now(),updatedAt:Date.now(),text:jsonData.text};if(results.length){await objectStorageClient.text.update({...currentText,...newObject})}else{await objectStorageClient.text.create({...newObject})}}toasts.addSuccess("Queries overwritten.")}else{setLoadingMessage("Importing queries and merging with existing ones...");if(results.length){await objectStorageClient.text.update({...currentText,createdAt:Date.now(),updatedAt:Date.now(),text:currentText.text.concat("\n\n#Imported on ".concat(external_osdSharedDeps_Moment_default()(Date.now()).format(dateFormat),"\n\n").concat(jsonData.text))});toasts.addSuccess("Queries merged.")}}refresh();setLoadingMessage(undefined);setStatus("idle");close()}else{setStatus("error");setError(external_osdSharedDeps_OsdI18n_["i18n"].translate("console.ImportFlyout.importFileErrorMessage",{defaultMessage:"The selected file is not valid. Please select a valid JSON file."}));return}}catch(e){setStatus("error");setError(getErrorMessage(e))}};const onConfirm=()=>{setShowOverwriteModal(false);importFile(true)};const onSkip=()=>{setShowOverwriteModal(false);setStatus("idle")};const renderFooter=()=>external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:close,size:"s",disabled:status==="loading"||status==="success","data-test-subj":"importQueriesCancelBtn"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.importFlyout.import.cancelButtonLabel",defaultMessage:"Cancel"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButton"],{disabled:!file,onClick:()=>importFile(false),size:"s",fill:true,isLoading:status==="loading","data-test-subj":"importQueriesConfirmBtn"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.importFlyout.import.confirmButtonLabel",defaultMessage:"Import"}))));return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlyout"],{onClose:close,size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlyoutHeader"],{hasBorder:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"m"},external_osdSharedDeps_React_default.a.createElement("h2",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"console.ImportFlyout.importQueriesTitle",defaultMessage:"Import queries"})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlyoutBody"],null,renderError(),renderBody()),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlyoutFooter"],null,renderFooter()),showOverwriteModal&&external_osdSharedDeps_React_default.a.createElement(OverwriteModal,{onSkip:onSkip,onConfirm:onConfirm}))};function sense_editor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const{collapseLiteralStrings:sense_editor_collapseLiteralStrings}=opensearchUiShared_public_["XJson"];class sense_editor_SenseEditor{constructor(coreEditor){var _this=this;this.coreEditor=coreEditor;sense_editor_defineProperty(this,"currentReqRange",void 0);sense_editor_defineProperty(this,"parser",void 0);sense_editor_defineProperty(this,"autocomplete",void 0);sense_editor_defineProperty(this,"prevRequestStart",rowOrPos=>{let curRow;if(rowOrPos==null){curRow=this.coreEditor.getCurrentPosition().lineNumber}else if(external_osdSharedDeps_Lodash_default.a.isObject(rowOrPos)){curRow=rowOrPos.lineNumber}else{curRow=rowOrPos}while(curRow>0&&!this.parser.isStartRequestRow(curRow,this.coreEditor))curRow--;return{lineNumber:curRow,column:1}});sense_editor_defineProperty(this,"nextRequestStart",rowOrPos=>{let curRow;if(rowOrPos==null){curRow=this.coreEditor.getCurrentPosition().lineNumber}else if(external_osdSharedDeps_Lodash_default.a.isObject(rowOrPos)){curRow=rowOrPos.lineNumber}else{curRow=rowOrPos}const maxLines=this.coreEditor.getLineCount();for(;curRow<maxLines-1;curRow++){if(this.parser.isStartRequestRow(curRow,this.coreEditor)){break}}return{row:curRow,column:0}});sense_editor_defineProperty(this,"autoIndent",external_osdSharedDeps_Lodash_default.a.debounce(async()=>{await this.coreEditor.waitForLatestTokens();const reqRange=await this.getRequestRange();if(!reqRange){return}const parsedReq=await this.getRequest();if(!parsedReq){return}if(parsedReq.data&&parsedReq.data.length>0){let indent=parsedReq.data.length===1;let formattedData=formatRequestBodyDoc(parsedReq.data,indent);if(!formattedData.changed){indent=!indent;formattedData=formatRequestBodyDoc(parsedReq.data,indent)}parsedReq.data=formattedData.data;this.replaceRequestRange(parsedReq,reqRange)}},25));sense_editor_defineProperty(this,"update",(async function(data){let reTokenizeAll=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return _this.coreEditor.setValue(data,reTokenizeAll)}));sense_editor_defineProperty(this,"replaceRequestRange",(newRequest,requestRange)=>{const text=textFromRequest(newRequest);if(requestRange){this.coreEditor.replaceRange(requestRange,text)}else{this.coreEditor.insert(this.coreEditor.getCurrentPosition(),text)}});sense_editor_defineProperty(this,"getRequestRange",async lineNumber=>{await this.coreEditor.waitForLatestTokens();if(this.parser.isInBetweenRequestsRow(lineNumber)){return null}const reqStart=this.prevRequestStart(lineNumber);const reqEnd=this.nextRequestEnd(reqStart);return{start:{...reqStart},end:{...reqEnd}}});sense_editor_defineProperty(this,"expandRangeToRequestEdges",(async function(){let range=arguments.length>0&&arguments[0]!==undefined?arguments[0]:_this.coreEditor.getSelectionRange();await _this.coreEditor.waitForLatestTokens();let startLineNumber=range.start.lineNumber;let endLineNumber=range.end.lineNumber;const maxLine=Math.max(1,_this.coreEditor.getLineCount());if(_this.parser.isInBetweenRequestsRow(startLineNumber)){}else{for(;startLineNumber>=1;startLineNumber--){if(_this.parser.isStartRequestRow(startLineNumber)){break}}}if(startLineNumber<1||startLineNumber>endLineNumber){return null}if(_this.parser.isInBetweenRequestsRow(endLineNumber)){for(;endLineNumber>=startLineNumber;endLineNumber--){if(_this.parser.isEndRequestRow(endLineNumber)){break}}}else{for(;endLineNumber<=maxLine;endLineNumber++){if(_this.parser.isEndRequestRow(endLineNumber)){break}}}if(endLineNumber<startLineNumber||endLineNumber>maxLine){return null}const endColumn=(_this.coreEditor.getLineValue(endLineNumber)||"").replace(/\s+$/,"").length+1;return{start:{lineNumber:startLineNumber,column:1},end:{lineNumber:endLineNumber,column:endColumn}}}));sense_editor_defineProperty(this,"getRequestInRange",async range=>{await this.coreEditor.waitForLatestTokens();if(!range){return null}const request={method:"",data:[],url:null,range:range};const pos=range.start;const tokenIter=createTokenIterator({editor:this.coreEditor,position:pos});let t=tokenIter.getCurrentToken();if(this.parser.isEmptyToken(t)){t=this.parser.nextNonEmptyToken(tokenIter)}if(t==null){return null}request.method=t.value;t=this.parser.nextNonEmptyToken(tokenIter);if(!t||t.type==="method"){return null}request.url="";while(t&&t.type&&t.type.indexOf("url")===0){request.url+=t.value;t=tokenIter.stepForward()}if(this.parser.isEmptyToken(t)){t=this.parser.nextNonEmptyToken(tokenIter)}let bodyStartLineNumber=(t?0:1)+tokenIter.getCurrentPosition().lineNumber;let dataEndPos;while(bodyStartLineNumber<range.end.lineNumber||bodyStartLineNumber===range.end.lineNumber&&1<range.end.column){dataEndPos=this.nextDataDocEnd({lineNumber:bodyStartLineNumber,column:1});const bodyRange={start:{lineNumber:bodyStartLineNumber,column:1},end:dataEndPos};const data=this.coreEditor.getValueInRange(bodyRange);request.data.push(data.trim());bodyStartLineNumber=dataEndPos.lineNumber+1}return request});sense_editor_defineProperty(this,"getRequestsInRange",(async function(){let range=arguments.length>0&&arguments[0]!==undefined?arguments[0]:_this.coreEditor.getSelectionRange();let includeNonRequestBlocks=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;await _this.coreEditor.waitForLatestTokens();if(!range){return[]}const expandedRange=await _this.expandRangeToRequestEdges(range);if(!expandedRange){return[]}const requests=[];let rangeStartCursor=expandedRange.start.lineNumber;const endLineNumber=expandedRange.end.lineNumber;let currentLineNumber=expandedRange.start.lineNumber;const flushNonRequestBlock=()=>{if(includeNonRequestBlocks){const nonRequestPrefixBlock=_this.coreEditor.getLines(rangeStartCursor,currentLineNumber-1).join("\n");if(nonRequestPrefixBlock){requests.push(nonRequestPrefixBlock)}}};while(currentLineNumber<=endLineNumber){if(_this.parser.isStartRequestRow(currentLineNumber)){flushNonRequestBlock();const request=await _this.getRequest(currentLineNumber);if(!request){return requests}else{requests.push(request);rangeStartCursor=currentLineNumber=request.range.end.lineNumber+1}}else{++currentLineNumber}}flushNonRequestBlock();return requests}));sense_editor_defineProperty(this,"getRequest",async row=>{await this.coreEditor.waitForLatestTokens();if(this.parser.isInBetweenRequestsRow(row)){return null}const range=await this.getRequestRange(row);return this.getRequestInRange(range)});sense_editor_defineProperty(this,"moveToPreviousRequestEdge",async()=>{await this.coreEditor.waitForLatestTokens();const pos=this.coreEditor.getCurrentPosition();for(pos.lineNumber--;pos.lineNumber>1&&!this.parser.isRequestEdge(pos.lineNumber);pos.lineNumber--){}this.coreEditor.moveCursorToPosition({lineNumber:pos.lineNumber,column:1})});sense_editor_defineProperty(this,"moveToNextRequestEdge",async moveOnlyIfNotOnEdge=>{await this.coreEditor.waitForLatestTokens();const pos=this.coreEditor.getCurrentPosition();const maxRow=this.coreEditor.getLineCount();if(!moveOnlyIfNotOnEdge){pos.lineNumber++}for(;pos.lineNumber<maxRow&&!this.parser.isRequestEdge(pos.lineNumber);pos.lineNumber++){}this.coreEditor.moveCursorToPosition({lineNumber:pos.lineNumber,column:1})});sense_editor_defineProperty(this,"nextRequestEnd",pos=>{pos=pos||this.coreEditor.getCurrentPosition();const maxLines=this.coreEditor.getLineCount();let curLineNumber=pos.lineNumber;for(;curLineNumber<=maxLines;++curLineNumber){const curRowMode=this.parser.getRowParseMode(curLineNumber);if((curRowMode&this.parser.MODE.REQUEST_END)>0){break}if(curLineNumber!==pos.lineNumber&&(curRowMode&this.parser.MODE.REQUEST_START)>0){break}}const column=(this.coreEditor.getLineValue(curLineNumber)||"").replace(/\s+$/,"").length+1;return{lineNumber:curLineNumber,column:column}});sense_editor_defineProperty(this,"nextDataDocEnd",pos=>{pos=pos||this.coreEditor.getCurrentPosition();let curLineNumber=pos.lineNumber;const maxLines=this.coreEditor.getLineCount();for(;curLineNumber<maxLines;curLineNumber++){const curRowMode=this.parser.getRowParseMode(curLineNumber);if((curRowMode&this.parser.MODE.REQUEST_END)>0){break}if((curRowMode&this.parser.MODE.MULTI_DOC_CUR_DOC_END)>0){break}if(curLineNumber!==pos.lineNumber&&(curRowMode&this.parser.MODE.REQUEST_START)>0){break}}const column=(this.coreEditor.getLineValue(curLineNumber)||"").length+1;return{lineNumber:curLineNumber,column:column}});sense_editor_defineProperty(this,"highlightCurrentRequestsAndUpdateActionBar",external_osdSharedDeps_Lodash_default.a.debounce(async()=>{await this.coreEditor.waitForLatestTokens();const expandedRange=await this.expandRangeToRequestEdges();if(expandedRange===null&&this.currentReqRange===null){return}if(expandedRange!==null&&this.currentReqRange!==null&&expandedRange.start.lineNumber===this.currentReqRange.start.lineNumber&&expandedRange.end.lineNumber===this.currentReqRange.end.lineNumber){const cursorLineNumber=this.coreEditor.getCurrentPosition().lineNumber;if(cursorLineNumber===this.currentReqRange.start.lineNumber){this.updateActionsBar()}return}if(this.currentReqRange){this.coreEditor.removeMarker(this.currentReqRange.markerRef)}this.currentReqRange=expandedRange;if(this.currentReqRange){this.currentReqRange.markerRef=this.coreEditor.addMarker(this.currentReqRange)}this.updateActionsBar()},25));sense_editor_defineProperty(this,"getRequestsAsCURL",async(opensearchBaseUrl,range)=>{const requests=await this.getRequestsInRange(range,true);const result=external_osdSharedDeps_Lodash_default.a.map(requests,req=>{if(typeof req==="string"){return req}const opensearchPath=req.url;const opensearchMethod=req.method;const opensearchData=req.data;const url=constructOpenSearchUrl(opensearchBaseUrl,opensearchPath);let ret="curl -X"+opensearchMethod+' "'+url+'"';if(opensearchData&&opensearchData.length){ret+=" -H 'Content-Type: application/json' -d'\n";const dataAsString=sense_editor_collapseLiteralStrings(opensearchData.join("\n"));ret+=dataAsString.replace(/'/g,"'\\''");if(opensearchData.length>1){ret+="\n"}ret+="'"}return ret});return result.join("\n")});sense_editor_defineProperty(this,"updateActionsBar",()=>this.coreEditor.legacyUpdateUI(this.currentReqRange));this.currentReqRange=null;this.parser=new RowParser(this.coreEditor);this.autocomplete=new autocomplete({coreEditor:coreEditor,parser:this.parser});this.coreEditor.registerAutocompleter(this.autocomplete.getCompletions);this.coreEditor.on("tokenizerUpdate",this.highlightCurrentRequestsAndUpdateActionBar.bind(this));this.coreEditor.on("changeCursor",this.highlightCurrentRequestsAndUpdateActionBar.bind(this));this.coreEditor.on("changeScrollTop",this.updateActionsBar.bind(this))}getCoreEditor(){return this.coreEditor}}function create_create(element){const coreEditor=create(element);const senseEditor=new sense_editor_SenseEditor(coreEditor);senseEditor.highlightCurrentRequestsAndUpdateActionBar();return senseEditor}async function autoIndent(editor,event){event.preventDefault();await editor.autoIndent();editor.getCoreEditor().getContainer().focus()}function getDocumentation(editor,docLinkVersion){return editor.getRequestsInRange().then(requests=>{if(!requests||requests.length===0){return null}const position=requests[0].range.end;position.column=position.column-1;const endpoint=getEndpointFromPosition(editor.getCoreEditor(),position,editor.parser);if(endpoint&&endpoint.documentation&&endpoint.documentation.indexOf("http")!==-1){return endpoint.documentation.replace("/master/","/".concat(docLinkVersion,"/")).replace("/current/","/".concat(docLinkVersion,"/"))}else{return null}})}function registerCommands(_ref){let{senseEditor:senseEditor,sendCurrentRequestToOpenSearch:sendCurrentRequestToOpenSearch,openDocumentation:openDocumentation}=_ref;const throttledAutoIndent=Object(external_osdSharedDeps_Lodash_["throttle"])(()=>senseEditor.autoIndent(),500,{leading:true,trailing:true});const coreEditor=senseEditor.getCoreEditor();coreEditor.registerKeyboardShortcut({keys:{win:"Ctrl-Enter",mac:"Command-Enter"},name:"send to OpenSearch",fn:()=>sendCurrentRequestToOpenSearch()});coreEditor.registerKeyboardShortcut({name:"open documentation",keys:{win:"Ctrl-/",mac:"Command-/"},fn:()=>{openDocumentation()}});coreEditor.registerKeyboardShortcut({name:"auto indent request",keys:{win:"Ctrl-I",mac:"Command-I"},fn:()=>{throttledAutoIndent()}});coreEditor.registerKeyboardShortcut({name:"move to previous request start or end",keys:{win:"Ctrl-Up",mac:"Command-Up"},fn:()=>{senseEditor.moveToPreviousRequestEdge()}});coreEditor.registerKeyboardShortcut({name:"move to next request start or end",keys:{win:"Ctrl-Down",mac:"Command-Down"},fn:()=>{senseEditor.moveToNextRequestEdge(false)}})}const{useUIAceKeyboardMode:useUIAceKeyboardMode}=opensearchUiShared_public_["ace"];const abs={position:"absolute",top:"0",left:"0",bottom:"0",right:"0"};const editor_DEFAULT_INPUT_VALUE='GET _search\n{\n  "query": {\n    "match_all": {}\n  }\n}';const editor_inputId="ConAppInputTextarea";function EditorUI(_ref){let{initialTextValue:initialTextValue,dataSourceId:dataSourceId}=_ref;const{services:{history:history,notifications:notifications,settings:settingsService,opensearchHostService:opensearchHostService,http:http},docLinkVersion:docLinkVersion}=useServicesContext();const{settings:settings}=useEditorReadContext();const setInputEditor=useSetInputEditor();const sendCurrentRequestToOpenSearch=useSendCurrentRequestToOpenSearch(dataSourceId);const saveCurrentTextObject=useSaveCurrentTextObject();const editorRef=Object(external_osdSharedDeps_React_["useRef"])(null);const editorInstanceRef=Object(external_osdSharedDeps_React_["useRef"])(null);const[textArea,setTextArea]=Object(external_osdSharedDeps_React_["useState"])(null);useUIAceKeyboardMode(textArea);const openDocumentation=Object(external_osdSharedDeps_React_["useCallback"])(async()=>{const documentation=await getDocumentation(editorInstanceRef.current,docLinkVersion);if(!documentation){return}window.open(documentation,"_blank")},[docLinkVersion]);Object(external_osdSharedDeps_React_["useEffect"])(()=>{editorInstanceRef.current=create_create(editorRef.current);const editor=editorInstanceRef.current;const textareaElement=editorRef.current.querySelector("textarea");if(textareaElement){textareaElement.setAttribute("id",editor_inputId)}const readQueryParams=()=>{const[,queryString]=(window.location.hash||"").split("?");return Object(query_string["parse"])(queryString||"",{sort:false})};const loadBufferFromRemote=url=>{if(/^https?:\/\//.test(url)){const loadFrom={url:url,dataType:"text",osdXsrfToken:false};if(/https?:\/\/api\.github\.com/.test(url)){loadFrom.headers={Accept:"application/vnd.github.v3.raw"}}$.ajax(loadFrom).done(async data=>{const coreEditor=editor.getCoreEditor();await editor.update(data,true);editor.moveToNextRequestEdge(false);coreEditor.clearSelection();editor.highlightCurrentRequestsAndUpdateActionBar();coreEditor.getContainer().focus()})}};const onHashChange=Object(external_osdSharedDeps_Lodash_["debounce"])(()=>{const{load_from:url}=readQueryParams();if(!url){return}loadBufferFromRemote(url)},200);window.addEventListener("hashchange",onHashChange);const initialQueryParams=readQueryParams();if(initialQueryParams.load_from){loadBufferFromRemote(initialQueryParams.load_from)}else{editor.update(initialTextValue||editor_DEFAULT_INPUT_VALUE)}function setupAutosave(){let timer;const saveDelay=500;editor.getCoreEditor().on("change",()=>{if(timer){clearTimeout(timer)}timer=window.setTimeout(saveCurrentState,saveDelay)})}function saveCurrentState(){try{const content=editor.getCoreEditor().getValue();saveCurrentTextObject(content)}catch(e){}}setInputEditor(editor);setTextArea(editorRef.current.querySelector("textarea"));retrieveAutoCompleteInfo(http,settingsService,settingsService.getAutocomplete(),dataSourceId);const unsubscribeResizer=subscribeResizeChecker(editorRef.current,editor);setupAutosave();return()=>{unsubscribeResizer();clearSubscriptions();window.removeEventListener("hashchange",onHashChange);if(editorInstanceRef.current){editorInstanceRef.current.getCoreEditor().destroy()}}},[saveCurrentTextObject,initialTextValue,history,setInputEditor,settingsService,http,dataSourceId]);Object(external_osdSharedDeps_React_["useEffect"])(()=>{const{current:editor}=editorInstanceRef;applyCurrentSettings(editor.getCoreEditor(),settings);editor.getCoreEditor().getContainer().focus()},[settings]);Object(external_osdSharedDeps_React_["useEffect"])(()=>{registerCommands({senseEditor:editorInstanceRef.current,sendCurrentRequestToOpenSearch:sendCurrentRequestToOpenSearch,openDocumentation:openDocumentation})},[sendCurrentRequestToOpenSearch,openDocumentation]);return external_osdSharedDeps_React_default.a.createElement("div",{style:abs,className:"conApp"},external_osdSharedDeps_React_default.a.createElement("div",{className:"conApp__editor"},external_osdSharedDeps_React_default.a.createElement("ul",{className:"conApp__autoComplete",id:"autocomplete"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{className:"conApp__editorActions",id:"ConAppEditorActions",gutterSize:"none",responsive:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiToolTip"],{content:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.sendRequestButtonTooltip",{defaultMessage:"Click to send request"})},external_osdSharedDeps_React_default.a.createElement("button",{onClick:sendCurrentRequestToOpenSearch,"data-test-subj":"sendRequestButton","aria-label":external_osdSharedDeps_OsdI18n_["i18n"].translate("console.sendRequestButtonTooltip",{defaultMessage:"Click to send request"}),className:"conApp__editorActionButton conApp__editorActionButton--success"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIcon"],{type:"play"})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(console_menu_ConsoleMenu,{getCurl:()=>editorInstanceRef.current.getRequestsAsCURL(opensearchHostService.getHost()),getDocumentation:()=>getDocumentation(editorInstanceRef.current,docLinkVersion),autoIndent:event=>{autoIndent(editorInstanceRef.current,event)},addNotification:_ref2=>{let{title:title}=_ref2;return notifications.toasts.add({title:title})}}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiScreenReaderOnly"],null,external_osdSharedDeps_React_default.a.createElement("label",{htmlFor:editor_inputId},external_osdSharedDeps_OsdI18n_["i18n"].translate("console.inputTextarea",{defaultMessage:"Dev Tools Console"}))),external_osdSharedDeps_React_default.a.createElement("div",{ref:editorRef,id:"ConAppEditor",className:"conApp__editorContent","data-test-subj":"request-editor"})))}const Editor=external_osdSharedDeps_React_default.a.memo(EditorUI);const{collapseLiteralStrings:shared_imports_collapseLiteralStrings,expandLiteralStrings:shared_imports_expandLiteralStrings}=opensearchUiShared_public_["XJson"];function modeForContentType(contentType){if(!contentType){return"ace/mode/text"}if(contentType.indexOf("application/json")>=0){return"ace/mode/json"}else if(contentType.indexOf("application/yaml")>=0){return"ace/mode/yaml"}return"ace/mode/text"}function EditorOutputUI(){const editorRef=Object(external_osdSharedDeps_React_["useRef"])(null);const editorInstanceRef=Object(external_osdSharedDeps_React_["useRef"])(null);const{services:services}=useServicesContext();const{settings:readOnlySettings}=useEditorReadContext();const{lastResult:{data:data,error:error}}=useRequestReadContext();const inputId="ConAppOutputTextarea";Object(external_osdSharedDeps_React_["useEffect"])(()=>{editorInstanceRef.current=createReadOnlyAceEditor(editorRef.current);const unsubscribe=subscribeResizeChecker(editorRef.current,editorInstanceRef.current);const textarea=editorRef.current.querySelector("textarea");textarea.setAttribute("id",inputId);textarea.setAttribute("readonly","true");return()=>{unsubscribe();editorInstanceRef.current.destroy()}},[services.settings]);Object(external_osdSharedDeps_React_["useEffect"])(()=>{const editor=editorInstanceRef.current;if(data){const mode=modeForContentType(data[0].response.contentType);editor.session.setMode(mode);editor.update(data.map(d=>d.response.value).map(readOnlySettings.tripleQuotes?shared_imports_expandLiteralStrings:a=>a).join("\n"))}else if(error){editor.session.setMode(modeForContentType(error.response.contentType));editor.update(error.response.value)}else{editor.update("")}},[readOnlySettings,data,error]);Object(external_osdSharedDeps_React_["useEffect"])(()=>{applyCurrentSettings(editorInstanceRef.current,readOnlySettings)},[readOnlySettings]);return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiScreenReaderOnly"],null,external_osdSharedDeps_React_default.a.createElement("label",{htmlFor:inputId},external_osdSharedDeps_OsdI18n_["i18n"].translate("console.outputTextarea",{defaultMessage:"Dev Tools Console output"}))),external_osdSharedDeps_React_default.a.createElement("div",{ref:editorRef,className:"conApp__output","data-test-subj":"response-editor"},external_osdSharedDeps_React_default.a.createElement("div",{className:"conApp__outputContent",id:"ConAppOutput"})))}const EditorOutput=external_osdSharedDeps_React_default.a.memo(EditorOutputUI);var opensearchDashboardsReact_public_=__webpack_require__(26);var external_osdSharedDeps_Rxjs_=__webpack_require__(27);function history_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class history_History{constructor(storage){this.storage=storage;history_defineProperty(this,"changeEmitter",new external_osdSharedDeps_Rxjs_["BehaviorSubject"](this.getHistory()||[]))}getHistoryKeys(){return this.storage.keys().filter(key=>key.indexOf("hist_elem")===0).sort().reverse()}getHistory(){return this.getHistoryKeys().map(key=>this.storage.get(key))}change(listener){const subscription=this.changeEmitter.subscribe(listener);return()=>subscription.unsubscribe()}addToHistory(endpoint,method,data){const keys=this.getHistoryKeys();keys.splice(0,500);keys.forEach(key=>{this.storage.delete(key)});const timestamp=(new Date).getTime();const k="hist_elem_"+timestamp;this.storage.set(k,{time:timestamp,endpoint:endpoint,method:method,data:data});this.changeEmitter.next(this.getHistory())}updateCurrentState(content){const timestamp=(new Date).getTime();this.storage.set("editor_state",{time:timestamp,content:content})}getLegacySavedEditorState(){const saved=this.storage.get("editor_state");if(!saved)return;const{time:time,content:content}=saved;return{time:time,content:content}}deleteLegacySavedEditorState(){this.storage.delete("editor_state")}clearHistory(){this.getHistoryKeys().forEach(key=>this.storage.delete(key))}}function createHistory(deps){return new history_History(deps.storage)}let StorageKeys;(function(StorageKeys){StorageKeys["WIDTH"]="widths"})(StorageKeys||(StorageKeys={}));class storage_Storage{constructor(engine,prefix){this.engine=engine;this.prefix=prefix}encode(val){return stringify(val)}decode(val){if(typeof val==="string"){return parse(val)}}encodeKey(key){return"".concat(this.prefix).concat(key)}decodeKey(key){if(Object(external_osdSharedDeps_Lodash_["startsWith"])(key,this.prefix)){return"".concat(key.slice(this.prefix.length))}}set(key,val){this.engine.setItem(this.encodeKey(key),this.encode(val));return val}has(key){return this.engine.getItem(this.encodeKey(key))!=null}get(key,_default){if(this.has(key)){return this.decode(this.engine.getItem(this.encodeKey(key)))}else{return _default}}delete(key){return this.engine.removeItem(this.encodeKey(key))}keys(){return Object(external_osdSharedDeps_Lodash_["transform"])(Object(external_osdSharedDeps_Lodash_["keys"])(this.engine),(ours,key)=>{const ourKey=this.decodeKey(key);if(ourKey!=null)ours.push(ourKey)})}}function createStorage(deps){return new storage_Storage(deps.engine,deps.prefix)}class Settings{constructor(storage){this.storage=storage}getFontSize(){return this.storage.get("font_size",14)}setFontSize(size){this.storage.set("font_size",size);return true}getWrapMode(){return this.storage.get("wrap_mode",true)}setWrapMode(mode){this.storage.set("wrap_mode",mode);return true}setTripleQuotes(tripleQuotes){this.storage.set("triple_quotes",tripleQuotes);return true}getTripleQuotes(){return this.storage.get("triple_quotes",true)}getAutocomplete(){return this.storage.get("autocomplete_settings",{fields:true,indices:true,templates:true})}setAutocomplete(settings){this.storage.set("autocomplete_settings",settings);return true}getPolling(){return this.storage.get("console_polling",true)}setPolling(polling){this.storage.set("console_polling",polling);return true}toJSON(){return{autocomplete:this.getAutocomplete(),wrapMode:this.getWrapMode(),tripleQuotes:this.getTripleQuotes(),fontSize:parseFloat(this.getFontSize()),polling:Boolean(this.getPolling())}}updateSettings(_ref){let{fontSize:fontSize,wrapMode:wrapMode,tripleQuotes:tripleQuotes,autocomplete:autocomplete,polling:polling}=_ref;this.setFontSize(fontSize);this.setWrapMode(wrapMode);this.setTripleQuotes(tripleQuotes);this.setAutocomplete(autocomplete);this.setPolling(polling)}}function createSettings(_ref2){let{storage:storage}=_ref2;return new Settings(storage)}const INITIAL_PANEL_WIDTH=50;const PANEL_MIN_WIDTH="100px";const editor_Editor=Object(external_osdSharedDeps_React_["memo"])(_ref=>{let{loading:loading,dataSourceId:dataSourceId}=_ref;const{services:{storage:storage}}=useServicesContext();const{currentTextObject:currentTextObject}=useEditorReadContext();const{requestInFlight:requestInFlight}=useRequestReadContext();const dispatch=useRequestActionContext();const[firstPanelWidth,secondPanelWidth]=storage.get(StorageKeys.WIDTH,[INITIAL_PANEL_WIDTH,INITIAL_PANEL_WIDTH]);Object(external_osdSharedDeps_React_["useEffect"])(()=>{dispatch({type:"resetLastResult",payload:undefined})},[dispatch,dataSourceId]);const onPanelWidthChange=Object(external_osdSharedDeps_React_["useCallback"])(Object(external_osdSharedDeps_Lodash_["debounce"])(widths=>{storage.set(StorageKeys.WIDTH,widths)},300),[]);if(!currentTextObject)return null;return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,requestInFlight?external_osdSharedDeps_React_default.a.createElement("div",{className:"conApp__requestProgressBarContainer"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiProgress"],{size:"xs",color:"accent",position:"absolute"})):null,external_osdSharedDeps_React_default.a.createElement(opensearchDashboardsReact_public_["PanelsContainer"],{onPanelWidthChange:onPanelWidthChange,resizerClassName:"conApp__resizer"},external_osdSharedDeps_React_default.a.createElement(opensearchDashboardsReact_public_["Panel"],{style:{height:"100%",position:"relative",minWidth:PANEL_MIN_WIDTH},initialWidth:firstPanelWidth},loading?external_osdSharedDeps_React_default.a.createElement(EditorContentSpinner,null):external_osdSharedDeps_React_default.a.createElement(Editor,{initialTextValue:currentTextObject.text,dataSourceId:dataSourceId})),external_osdSharedDeps_React_default.a.createElement(opensearchDashboardsReact_public_["Panel"],{style:{height:"100%",position:"relative",minWidth:PANEL_MIN_WIDTH},initialWidth:secondPanelWidth},loading?external_osdSharedDeps_React_default.a.createElement(EditorContentSpinner,null):external_osdSharedDeps_React_default.a.createElement(EditorOutput,null))))});const getAutocompleteDiff=(newSettings,prevSettings)=>Object.keys(newSettings.autocomplete).filter(key=>prevSettings.autocomplete[key]!==newSettings.autocomplete[key]);const refreshAutocompleteSettings=(http,settings,selectedSettings,dataSourceId)=>{retrieveAutoCompleteInfo(http,settings,selectedSettings,dataSourceId)};const fetchAutocompleteSettingsIfNeeded=(http,settings,newSettings,prevSettings)=>{if(newSettings.polling){const autocompleteDiff=getAutocompleteDiff(newSettings,prevSettings);const isSettingsChanged=autocompleteDiff.length>0;const isPollingChanged=prevSettings.polling!==newSettings.polling;if(isSettingsChanged){const changedSettings=autocompleteDiff.reduce((changedSettingsAccum,setting)=>{changedSettingsAccum[setting]=newSettings.autocomplete[setting];return changedSettingsAccum},{});retrieveAutoCompleteInfo(http,settings,changedSettings,dataSourceId)}else if(isPollingChanged&&newSettings.polling){retrieveAutoCompleteInfo(http,settings,settings.getAutocomplete(),dataSourceId)}}};function settings_Settings(_ref){let{onClose:onClose,dataSourceId:dataSourceId}=_ref;const{services:{settings:settings,http:http}}=useServicesContext();const dispatch=useEditorActionContext();const onSaveSettings=newSettings=>{const prevSettings=settings.toJSON();fetchAutocompleteSettingsIfNeeded(http,settings,newSettings,prevSettings);settings.updateSettings(newSettings);dispatch({type:"updateSettings",payload:newSettings});onClose()};return external_osdSharedDeps_React_default.a.createElement(DevToolsSettingsModal,{onClose:onClose,onSaveSettings:onSaveSettings,refreshAutocompleteSettings:selectedSettings=>refreshAutocompleteSettings(http,settings,selectedSettings,dataSourceId),settings:settings.toJSON()})}function getTopNavConfig(_ref){let{onClickHistory:onClickHistory,onClickSettings:onClickSettings,onClickHelp:onClickHelp,onClickExport:onClickExport,onClickImport:onClickImport}=_ref;return[{id:"history",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.topNav.historyTabLabel",{defaultMessage:"History"}),description:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.topNav.historyTabDescription",{defaultMessage:"History"}),onClick:()=>{onClickHistory()},testId:"consoleHistoryButton"},{id:"settings",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.topNav.settingsTabLabel",{defaultMessage:"Settings"}),description:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.topNav.settingsTabDescription",{defaultMessage:"Settings"}),onClick:()=>{onClickSettings()},testId:"consoleSettingsButton"},{id:"help",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.topNav.helpTabLabel",{defaultMessage:"Help"}),description:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.topNav.helpTabDescription",{defaultMessage:"Help"}),onClick:()=>{onClickHelp()},testId:"consoleHelpButton"},{id:"export",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.topNav.exportTabLabel",{defaultMessage:"Export"}),description:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.topNav.exportTabDescription",{defaultMessage:"Export"}),onClick:()=>{onClickExport()},testId:"consoleExportButton"},{id:"import",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.topNav.importTabLabel",{defaultMessage:"Import"}),description:external_osdSharedDeps_OsdI18n_["i18n"].translate("console.topNav.importTabDescription",{defaultMessage:"Import"}),onClick:()=>{onClickImport()},testId:"consoleImportButton"}]}function Main(_ref){var _requestData;let{dataSourceId:dataSourceId}=_ref;const{services:{storage:storage,objectStorageClient:objectStorageClient}}=useServicesContext();const{ready:editorsReady}=useEditorReadContext();const{requestInFlight:requestInProgress,lastResult:{data:requestData,error:requestError}}=useRequestReadContext();const[showWelcome,setShowWelcomePanel]=Object(external_osdSharedDeps_React_["useState"])(()=>storage.get("version_welcome_shown")!=="@@SENSE_REVISION");const[showingHistory,setShowHistory]=Object(external_osdSharedDeps_React_["useState"])(false);const[showSettings,setShowSettings]=Object(external_osdSharedDeps_React_["useState"])(false);const[showHelp,setShowHelp]=Object(external_osdSharedDeps_React_["useState"])(false);const[showImportFlyout,setShowImportFlyout]=Object(external_osdSharedDeps_React_["useState"])(false);const onExport=async()=>{const results=await objectStorageClient.text.findAll();const senseData=results.sort((a,b)=>a.createdAt-b.createdAt)[0];const blob=new Blob([JSON.stringify(senseData||{})],{type:"application/json"});Object(file_saver["saveAs"])(blob,"sense.json")};const renderConsoleHistory=()=>editorsReady?external_osdSharedDeps_React_default.a.createElement(ConsoleHistory,{close:()=>setShowHistory(false)}):null;const{done:done,error:error,retry:retry}=useDataInit();if(error){return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPageContent"],null,external_osdSharedDeps_React_default.a.createElement(SomethingWentWrongCallout,{onButtonClick:retry,error:error}))}const lastDatum=(_requestData=requestData===null||requestData===void 0?void 0:requestData[requestData.length-1])!==null&&_requestData!==void 0?_requestData:requestError;return external_osdSharedDeps_React_default.a.createElement("div",{id:"consoleRoot"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{className:"consoleContainer",gutterSize:"none",direction:"column",responsive:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{className:"euiScreenReaderOnly"},external_osdSharedDeps_React_default.a.createElement("h1",null,external_osdSharedDeps_OsdI18n_["i18n"].translate("console.pageHeading",{defaultMessage:"Console"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(TopNavMenu,{disabled:!done,items:getTopNavConfig({onClickHistory:()=>setShowHistory(!showingHistory),onClickSettings:()=>setShowSettings(true),onClickHelp:()=>setShowHelp(!showHelp),onClickExport:()=>onExport(),onClickImport:()=>setShowImportFlyout(!showImportFlyout)})})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,className:"conApp__tabsExtension"},external_osdSharedDeps_React_default.a.createElement(NetworkRequestStatusBar,{requestInProgress:requestInProgress,requestResult:lastDatum?{method:lastDatum.request.method.toUpperCase(),endpoint:lastDatum.request.path,statusCode:lastDatum.response.statusCode,statusText:lastDatum.response.statusText,timeElapsedMs:lastDatum.response.timeMs}:undefined})))),showingHistory?external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},renderConsoleHistory()):null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(editor_Editor,{loading:!done,dataSourceId:dataSourceId}))),done&&showWelcome?external_osdSharedDeps_React_default.a.createElement(WelcomePanel,{onDismiss:()=>{storage.set("version_welcome_shown","@@SENSE_REVISION");setShowWelcomePanel(false)}}):null,showSettings?external_osdSharedDeps_React_default.a.createElement(settings_Settings,{onClose:()=>setShowSettings(false),dataSourceId:dataSourceId}):null,showHelp?external_osdSharedDeps_React_default.a.createElement(HelpPanel,{onClose:()=>setShowHelp(false)}):null,showImportFlyout?external_osdSharedDeps_React_default.a.createElement(ImportFlyout,{refresh:retry,close:()=>setShowImportFlyout(false)}):null)}const textObjectTypeName="text-object";var uuid=__webpack_require__(48);var uuid_default=__webpack_require__.n(uuid);function local_storage_object_client_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class local_storage_object_client_LocalObjectStorage{constructor(client,type){this.client=client;local_storage_object_client_defineProperty(this,"prefix",void 0);this.prefix="console_local_".concat(type)}async create(obj){const id=uuid_default.a.v4();const newObj={id:id,...obj};this.client.set("".concat(this.prefix,"_").concat(id),newObj);return newObj}async update(obj){this.client.set("".concat(this.prefix,"_").concat(obj.id),obj)}async findAll(){const allLocalKeys=this.client.keys().filter(key=>key.includes(this.prefix));const result=[];for(const key of allLocalKeys){result.push(this.client.get(key))}return result}}const local_storage_object_client_create_create=storage=>({text:new local_storage_object_client_LocalObjectStorage(storage,textObjectTypeName)});function wrapArray(subj){return Array.isArray(subj)?subj:[subj]}class UnreachableCaseError extends Error{constructor(val){super("Unreachable case: ".concat(val))}}function createUiStatsMetric(_ref){let{type:type,appName:appName,eventName:eventName,count:count=1}=_ref;return{type:type,appName:appName,eventName:eventName,count:count}}function trackUsageAgent(appName){const userAgent=window&&window.navigator&&window.navigator.userAgent||"";return{type:METRIC_TYPE.USER_AGENT,appName:appName,userAgent:userAgent}}var external_osdSharedDeps_MomentTimezone_=__webpack_require__(23);var external_osdSharedDeps_MomentTimezone_default=__webpack_require__.n(external_osdSharedDeps_MomentTimezone_);function application_usage_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class application_usage_ApplicationUsage{constructor(){application_usage_defineProperty(this,"currentUsage",void 0)}start(){if(window)window.addEventListener("click",()=>this.currentUsage&&this.currentUsage.numberOfClicks++)}appChanged(appId){const currentUsage=this.currentUsage;if(appId){this.currentUsage={type:METRIC_TYPE.APPLICATION_USAGE,appId:appId,startTime:external_osdSharedDeps_MomentTimezone_default()(),numberOfClicks:0}}else{this.currentUsage=void 0}return currentUsage}}let METRIC_TYPE;(function(METRIC_TYPE){METRIC_TYPE["COUNT"]="count";METRIC_TYPE["LOADED"]="loaded";METRIC_TYPE["CLICK"]="click";METRIC_TYPE["USER_AGENT"]="user_agent";METRIC_TYPE["APPLICATION_USAGE"]="application_usage"})(METRIC_TYPE||(METRIC_TYPE={}));function storage_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class ReportStorageManager{constructor(storageKey,storage){storage_defineProperty(this,"storageKey",void 0);storage_defineProperty(this,"storage",void 0);this.storageKey=storageKey;this.storage=storage}get(){if(!this.storage)return;return this.storage.get(this.storageKey)}store(report){if(!this.storage)return;this.storage.set(this.storageKey,report)}}function report_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const REPORT_VERSION=1;class report_ReportManager{constructor(report){report_defineProperty(this,"report",void 0);this.report=report||report_ReportManager.createReport()}static createReport(){return{reportVersion:REPORT_VERSION}}clearReport(){this.report=report_ReportManager.createReport()}isReportEmpty(){const{uiStatsMetrics:uiStatsMetrics,userAgent:userAgent,application_usage:appUsage}=this.report;const noUiStats=!uiStatsMetrics||Object.keys(uiStatsMetrics).length===0;const noUserAgent=!userAgent||Object.keys(userAgent).length===0;const noAppUsage=!appUsage||Object.keys(appUsage).length===0;return noUiStats&&noUserAgent&&noAppUsage}incrementStats(count,stats){const{min:min=0,max:max=0,sum:sum=0}=stats||{};const newMin=Math.min(min,count);const newMax=Math.max(max,count);const newAvg=newMin+newMax/2;const newSum=sum+count;return{min:newMin,max:newMax,avg:newAvg,sum:newSum}}assignReports(newMetrics){wrapArray(newMetrics).forEach(newMetric=>this.assignReport(this.report,newMetric));return{report:this.report}}static createMetricKey(metric){switch(metric.type){case METRIC_TYPE.USER_AGENT:{const{appName:appName,type:type}=metric;return"".concat(appName,"-").concat(type)}case METRIC_TYPE.CLICK:case METRIC_TYPE.LOADED:case METRIC_TYPE.COUNT:{const{appName:appName,eventName:eventName,type:type}=metric;return"".concat(appName,"-").concat(type,"-").concat(eventName)}case METRIC_TYPE.APPLICATION_USAGE:return metric.appId;default:throw new UnreachableCaseError(metric)}}assignReport(report,metric){const key=report_ReportManager.createMetricKey(metric);switch(metric.type){case METRIC_TYPE.USER_AGENT:{const{appName:appName,type:type,userAgent:userAgent}=metric;if(userAgent){report.userAgent={[key]:{key:key,appName:appName,type:type,userAgent:metric.userAgent}}}return}case METRIC_TYPE.CLICK:case METRIC_TYPE.LOADED:case METRIC_TYPE.COUNT:{const{appName:appName,type:type,eventName:eventName,count:count}=metric;report.uiStatsMetrics=report.uiStatsMetrics||{};const existingStats=(report.uiStatsMetrics[key]||{}).stats;report.uiStatsMetrics[key]={key:key,appName:appName,eventName:eventName,type:type,stats:this.incrementStats(count,existingStats)};return}case METRIC_TYPE.APPLICATION_USAGE:const{numberOfClicks:numberOfClicks,startTime:startTime}=metric;const minutesOnScreen=external_osdSharedDeps_MomentTimezone_default()().diff(startTime,"minutes",true);report.application_usage=report.application_usage||{};const appExistingData=report.application_usage[key]||{minutesOnScreen:0,numberOfClicks:0};report.application_usage[key]={minutesOnScreen:appExistingData.minutesOnScreen+minutesOnScreen,numberOfClicks:appExistingData.numberOfClicks+numberOfClicks};break;default:throw new UnreachableCaseError(metric)}}}report_defineProperty(report_ReportManager,"REPORT_VERSION",REPORT_VERSION);function reporter_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class reporter_Reporter{constructor(config){reporter_defineProperty(this,"checkInterval",void 0);reporter_defineProperty(this,"interval",void 0);reporter_defineProperty(this,"lastAppId",void 0);reporter_defineProperty(this,"reportManager",void 0);reporter_defineProperty(this,"storageManager",void 0);reporter_defineProperty(this,"applicationUsage",void 0);reporter_defineProperty(this,"debug",void 0);reporter_defineProperty(this,"retryCount",0);reporter_defineProperty(this,"maxRetries",3);reporter_defineProperty(this,"started",false);reporter_defineProperty(this,"start",()=>{if(!this.interval){this.interval=setTimeout(()=>{this.interval=undefined;this.sendReports()},this.checkInterval)}if(this.started){return}if(window&&document){window.addEventListener("beforeunload",()=>this.reportApplicationUsage());document.addEventListener("visibilitychange",()=>{if(document.visibilityState==="visible"&&this.lastAppId){this.reportApplicationUsage(this.lastAppId)}else if(document.visibilityState==="hidden"){this.reportApplicationUsage();this.sendReports()}})}this.started=true;this.applicationUsage.start()});reporter_defineProperty(this,"reportUiStats",(appName,type,eventNames,count)=>{const metrics=wrapArray(eventNames).map(eventName=>{this.log("".concat(type," Metric -> (").concat(appName,":").concat(eventName,"):"));const report=createUiStatsMetric({type:type,appName:appName,eventName:eventName,count:count});this.log(report);return report});this.saveToReport(metrics)});reporter_defineProperty(this,"reportUserAgent",appName=>{this.log("Reporting user-agent.");const report=trackUsageAgent(appName);this.saveToReport([report])});reporter_defineProperty(this,"sendReports",async()=>{if(!this.reportManager.isReportEmpty()){try{this.flushReport()}catch(err){this.log("Error Sending Metrics Report ".concat(err));this.retryCount=this.retryCount+1;const versionMismatch=this.reportManager.report.reportVersion!==report_ReportManager.REPORT_VERSION;if(versionMismatch||this.retryCount>this.maxRetries){this.flushReport()}}}this.start()});const{storage:storage,debug:debug,checkInterval:checkInterval=9e4,storageKey:storageKey="analytics"}=config;this.checkInterval=checkInterval;this.applicationUsage=new application_usage_ApplicationUsage;this.storageManager=new ReportStorageManager(storageKey,storage);const storedReport=this.storageManager.get();this.reportManager=new report_ReportManager(storedReport);this.debug=!!debug}saveToReport(newMetrics){this.reportManager.assignReports(newMetrics);this.storageManager.store(this.reportManager.report)}flushReport(){this.retryCount=0;this.reportManager.clearReport();this.storageManager.store(this.reportManager.report)}log(message){if(this.debug){console.debug(message)}}reportApplicationUsage(appId){this.log("Reporting application changed to ".concat(appId));this.lastAppId=appId||this.lastAppId}}const APP_TRACKER_NAME="console";const createUsageTracker=usageCollection=>{const track=(type,name)=>usageCollection===null||usageCollection===void 0?void 0:usageCollection.reportUiStats(APP_TRACKER_NAME,type,name);return{count:eventName=>{track(METRIC_TYPE.COUNT,eventName)},load:eventName=>{track(METRIC_TYPE.LOADED,eventName)}}};const createApi=_ref=>{let{http:http}=_ref;return{getOpenSearchConfig:()=>Object(opensearchUiShared_public_["sendRequest"])(http,{path:"/api/console/opensearch_config",method:"get"})}};function opensearch_host_service_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class OpenSearchHostService{constructor(api){this.api=api;opensearch_host_service_defineProperty(this,"host","http://localhost:9200")}setHost(host){this.host=host}async init(){const{data:data}=await this.api.getOpenSearchConfig();if(data&&data.host){this.setHost(data.host)}}getHost(){return this.host}}const createOpenSearchHostService=_ref=>{let{api:api}=_ref;return new OpenSearchHostService(api)};function renderApp(_ref){let{I18nContext:I18nContext,notifications:notifications,docLinkVersion:docLinkVersion,usageCollection:usageCollection,element:element,http:http,dataSourceId:dataSourceId,uiSettings:uiSettings}=_ref;const trackUiMetric=createUsageTracker(usageCollection);trackUiMetric.load("opened_app");const storage=createStorage({engine:window.localStorage,prefix:"sense:"});const history=createHistory({storage:storage});const settings=createSettings({storage:storage});const objectStorageClient=local_storage_object_client_create_create(storage);const api=createApi({http:http});const opensearchHostService=createOpenSearchHostService({api:api});Object(external_osdSharedDeps_ReactDom_["render"])(external_osdSharedDeps_React_default.a.createElement(I18nContext,null,external_osdSharedDeps_React_default.a.createElement(ServicesContextProvider,{value:{docLinkVersion:docLinkVersion,services:{opensearchHostService:opensearchHostService,storage:storage,history:history,settings:settings,notifications:notifications,trackUiMetric:trackUiMetric,objectStorageClient:objectStorageClient,http:http,uiSettings:uiSettings}}},external_osdSharedDeps_React_default.a.createElement(RequestContextProvider,null,external_osdSharedDeps_React_default.a.createElement(EditorContextProvider,{settings:settings.toJSON()},external_osdSharedDeps_React_default.a.createElement(Main,{dataSourceId:dataSourceId}))))),element);return()=>Object(external_osdSharedDeps_ReactDom_["unmountComponentAtNode"])(element)}}}]);