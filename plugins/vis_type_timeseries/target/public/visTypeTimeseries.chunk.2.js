(window["visTypeTimeseries_bundle_jsonpfunction"]=window["visTypeTimeseries_bundle_jsonpfunction"]||[]).push([[2],{135:function(module,exports,__webpack_require__){var assignValue=__webpack_require__(100),castPath=__webpack_require__(97),isFunction=__webpack_require__(90),isIndex=__webpack_require__(85),isObject=__webpack_require__(52),toKey=__webpack_require__(62);function baseSet(object,path,value,customizer){if(!isObject(object)){return object}path=castPath(path,object);var index=-1,length=path.length,lastIndex=length-1,nested=object;while(nested!=null&&++index<length){var key=toKey(path[index]),newValue=value;if(key=="prototype"&&isFunction(nested)){throw new Error("Illegal access of function prototype")}if(index!=lastIndex){var objValue=hasOwnProperty.call(nested,key)?nested[key]:undefined;newValue=customizer?customizer(objValue,key,nested):undefined;if(newValue===undefined){newValue=isObject(objValue)?objValue:isIndex(path[index+1])?[]:{}}}assignValue(nested,key,newValue);nested=nested[key]}return object}module.exports=baseSet},272:function(module,exports,__webpack_require__){exports.set=__webpack_require__(273);exports.setWith=__webpack_require__(274)},273:function(module,exports,__webpack_require__){var baseSet=__webpack_require__(135);function set(object,path,value){return object==null?object:baseSet(object,path,value)}module.exports=set},274:function(module,exports,__webpack_require__){var baseSet=__webpack_require__(135);function setWith(object,path,value,customizer){customizer=typeof customizer=="function"?customizer:undefined;return object==null?object:baseSet(object,path,value,customizer)}module.exports=setWith},332:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"VisEditor",(function(){return vis_editor_VisEditor}));__webpack_require__.d(__webpack_exports__,"default",(function(){return vis_editor_VisEditor}));var external_osdSharedDeps_React_=__webpack_require__(1);var external_osdSharedDeps_React_default=__webpack_require__.n(external_osdSharedDeps_React_);var external_osdSharedDeps_Rxjs_=__webpack_require__(35);var external_osdSharedDeps_RxjsOperators_=__webpack_require__(36);var external_osdSharedDeps_Lodash_=__webpack_require__(5);var external_osdSharedDeps_Lodash_default=__webpack_require__.n(external_osdSharedDeps_Lodash_);var external_osdSharedDeps_ElasticEui_=__webpack_require__(6);var external_osdSharedDeps_OsdI18nReact_=__webpack_require__(32);var external_osdSharedDeps_Moment_=__webpack_require__(18);var external_osdSharedDeps_Moment_default=__webpack_require__.n(external_osdSharedDeps_Moment_);var external_osdSharedDeps_OsdI18n_=__webpack_require__(2);var public_=__webpack_require__(11);var interval_regexp=__webpack_require__(16);const{parseOpenSearchInterval:parseOpenSearchInterval}=public_["search"].aggs;const AUTO_INTERVAL="auto";const unitLookup={s:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.getInterval.secondsLabel",{defaultMessage:"seconds"}),m:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.getInterval.minutesLabel",{defaultMessage:"minutes"}),h:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.getInterval.hoursLabel",{defaultMessage:"hours"}),d:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.getInterval.daysLabel",{defaultMessage:"days"}),w:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.getInterval.weeksLabel",{defaultMessage:"weeks"}),M:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.getInterval.monthsLabel",{defaultMessage:"months"}),y:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.getInterval.yearsLabel",{defaultMessage:"years"})};const convertIntervalIntoUnit=function(interval){let hasTranslateUnitString=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;const units=Object.keys(unitLookup).reverse();const duration=external_osdSharedDeps_Moment_default.a.duration(interval,"ms");for(let i=0;i<units.length;i++){const as=duration.as(units[i]);if(Math.abs(as)>1){return{unitValue:Math.round(Math.abs(as)),unitString:hasTranslateUnitString?unitLookup[units[i]]:units[i]}}}};const isGteInterval=interval=>interval_regexp["a"].test(interval);const isAutoInterval=interval=>!interval||interval===AUTO_INTERVAL;const validateReInterval=intervalValue=>{const validationResult={};try{parseOpenSearchInterval(intervalValue)}catch({message:message}){validationResult.errorMessage=message}finally{validationResult.isValid=!validationResult.errorMessage}return validationResult};const getInterval=(visData,model)=>{let series;if(model&&model.type==="table"){series=Object(external_osdSharedDeps_Lodash_["get"])(visData,"series[0].series",[])}else{series=Object(external_osdSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[])}return series.reduce((currentInterval,item)=>{if(item.data.length>1){const seriesInterval=item.data[1][0]-item.data[0][0];if(!currentInterval||seriesInterval<currentInterval)return seriesInterval}return currentInterval},0)};var panel_types=__webpack_require__(12);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const MIN_CHART_HEIGHT=300;class vis_editor_visualization_VisEditorVisualizationUI extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);_defineProperty(this,"handleMouseDown",()=>{window.addEventListener("mouseup",this.handleMouseUp);this.setState({dragging:true})});_defineProperty(this,"handleMouseUp",()=>{window.removeEventListener("mouseup",this.handleMouseUp);this.setState({dragging:false})});_defineProperty(this,"handleMouseMove",event=>{if(this.state.dragging){this.setState(prevState=>({height:Math.max(MIN_CHART_HEIGHT,prevState.height+event.movementY)}))}});_defineProperty(this,"onSizeHandleKeyDown",ev=>{const{key:key}=ev;if(key===external_osdSharedDeps_ElasticEui_["keys"].ARROW_UP||key===external_osdSharedDeps_ElasticEui_["keys"].ARROW_DOWN){ev.preventDefault();this.setState(prevState=>{const newHeight=prevState.height+(key===external_osdSharedDeps_ElasticEui_["keys"].ARROW_UP?-15:15);return{height:Math.max(MIN_CHART_HEIGHT,newHeight)}})}});this.state={height:MIN_CHART_HEIGHT,dragging:false,panelInterval:0};this._visEl=external_osdSharedDeps_React_default.a.createRef();this._subscription=null}async _loadVisualization(){if(!this._visEl.current){return}const{onDataChange:onDataChange,embeddableHandler:embeddableHandler}=this.props;this._handler=embeddableHandler;await this._handler.render(this._visEl.current);this.props.eventEmitter.emit("embeddableRendered");this._subscription=this._handler.handler.data$.subscribe(data=>{this.setPanelInterval(data.value.visData);onDataChange(data.value)})}setPanelInterval(visData){const panelInterval=getInterval(visData,this.props.model);if(this.state.panelInterval!==panelInterval){this.setState({panelInterval:panelInterval})}}hasShowPanelIntervalValue(){const type=Object(external_osdSharedDeps_Lodash_["get"])(this.props,"model.type","");const interval=Object(external_osdSharedDeps_Lodash_["get"])(this.props,"model.interval",AUTO_INTERVAL);return[panel_types["a"].METRIC,panel_types["a"].TOP_N,panel_types["a"].GAUGE,panel_types["a"].MARKDOWN,panel_types["a"].TABLE].includes(type)&&(isAutoInterval(interval)||isGteInterval(interval))}getFormattedPanelInterval(){const interval=convertIntervalIntoUnit(this.state.panelInterval,false);return interval?"".concat(interval.unitValue).concat(interval.unitString):null}componentWillUnmount(){window.removeEventListener("mousemove",this.handleMouseMove);window.removeEventListener("mouseup",this.handleMouseUp);if(this._handler){this._handler.destroy()}if(this._subscription){this._subscription.unsubscribe()}}componentDidMount(){window.addEventListener("mousemove",this.handleMouseMove);this._loadVisualization()}componentDidUpdate(){if(this._handler){this._handler.updateInput({timeRange:this.props.timeRange,filters:this.props.filters||[],query:this.props.query})}}render(){const{dirty:dirty,autoApply:autoApply,title:title,description:description,onToggleAutoApply:onToggleAutoApply,onCommit:onCommit}=this.props;const style={height:this.state.height};if(this.state.dragging){style.userSelect="none"}const panelInterval=this.hasShowPanelIntervalValue()&&this.getFormattedPanelInterval();let applyMessage=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.visEditorVisualization.changesSuccessfullyAppliedMessage",defaultMessage:"The latest changes have been applied."});if(dirty){applyMessage=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.visEditorVisualization.changesHaveNotBeenAppliedMessage",defaultMessage:"The changes to this visualization have not been applied."})}if(autoApply){applyMessage=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.visEditorVisualization.changesWillBeAutomaticallyAppliedMessage",defaultMessage:"The changes will be automatically applied."})}const applyButton=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{className:"tvbEditorVisualization__apply",alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSwitch"],{id:"tsvbAutoApplyInput",label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.visEditorVisualization.autoApplyLabel",defaultMessage:"Auto apply"}),checked:autoApply,onChange:onToggleAutoApply})),panelInterval&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],{color:"default",size:"xs"},external_osdSharedDeps_React_default.a.createElement("p",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.visEditorVisualization.panelInterval",defaultMessage:"Interval: {panelInterval}",values:{panelInterval:panelInterval}})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],{color:dirty?"default":"subdued",size:"xs"},external_osdSharedDeps_React_default.a.createElement("p",null,applyMessage))),!autoApply&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButton"],{iconType:"play",fill:true,size:"s",onClick:onCommit,disabled:!dirty,"data-test-subj":"applyBtn"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.visEditorVisualization.applyChangesLabel",defaultMessage:"Apply changes"}))));return external_osdSharedDeps_React_default.a.createElement("div",null,external_osdSharedDeps_React_default.a.createElement("div",{style:style,className:"tvbEditorVisualization","data-shared-items-container":true,"data-title":title,"data-description":description,ref:this._visEl}),external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbEditor--hideForReporting"},applyButton,external_osdSharedDeps_React_default.a.createElement("button",{className:"tvbEditorVisualization__draghandle",onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onKeyDown:this.onSizeHandleKeyDown,"aria-label":this.props.intl.formatMessage({id:"visTypeTimeseries.colorRules.adjustChartSizeAriaLabel",defaultMessage:"Press up/down to adjust the chart size"})},external_osdSharedDeps_React_default.a.createElement("i",{className:"fa fa-ellipsis-h"}))))}}const VisEditorVisualization=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(vis_editor_visualization_VisEditorVisualizationUI);var lib=__webpack_require__(59);var lib_default=__webpack_require__.n(lib);var external_osdSharedDeps_ElasticCharts_=__webpack_require__(33);var handlebars=__webpack_require__(130);var handlebars_default=__webpack_require__.n(handlebars);const durationBaseOptions=[{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.durationOptions.millisecondsLabel",{defaultMessage:"Milliseconds"}),value:"ms"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.durationOptions.secondsLabel",{defaultMessage:"Seconds"}),value:"s"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.durationOptions.minutesLabel",{defaultMessage:"Minutes"}),value:"m"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.durationOptions.hoursLabel",{defaultMessage:"Hours"}),value:"h"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.durationOptions.daysLabel",{defaultMessage:"Days"}),value:"d"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.durationOptions.weeksLabel",{defaultMessage:"Weeks"}),value:"w"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.durationOptions.monthsLabel",{defaultMessage:"Months"}),value:"M"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.durationOptions.yearsLabel",{defaultMessage:"Years"}),value:"Y"}];const durationOutputOptions=[{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.durationOptions.humanize",{defaultMessage:"Human readable"}),value:"humanize"},...durationBaseOptions];const durationInputOptions=[{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.durationOptions.picosecondsLabel",{defaultMessage:"Picoseconds"}),value:"ps"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.durationOptions.nanosecondsLabel",{defaultMessage:"Nanoseconds"}),value:"ns"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.durationOptions.microsecondsLabel",{defaultMessage:"Microseconds"}),value:"us"},...durationBaseOptions];const inputFormats={ps:"picoseconds",ns:"nanoseconds",us:"microseconds",ms:"milliseconds",s:"seconds",m:"minutes",h:"hours",d:"days",w:"weeks",M:"months",Y:"years"};const outputFormats={humanize:"humanize",ms:"asMilliseconds",s:"asSeconds",m:"asMinutes",h:"asHours",d:"asDays",w:"asWeeks",M:"asMonths",Y:"asYears"};const isDuration=format=>{const splittedFormat=format.split(",");const[input,output]=splittedFormat;return Boolean(inputFormats[input]&&outputFormats[output])&&splittedFormat.length===3};var services=__webpack_require__(0);const createTickFormatter=function(){let format=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"0,0.[00]";let template=arguments.length>1?arguments[1]:undefined;let getConfig=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;const fieldFormats=Object(services["d"])();if(!template)template="{{value}}";const render=handlebars_default.a.compile(template,{knownHelpersOnly:true});let formatter;if(isDuration(format)){const[from,to,decimals]=format.split(",");const DurationFormat=fieldFormats.getType("duration");formatter=new DurationFormat({inputFormat:inputFormats[from],outputFormat:outputFormats[to],outputPrecision:decimals})}else{let FieldFormat=fieldFormats.getType(format);if(FieldFormat){formatter=new FieldFormat(null,getConfig)}else{FieldFormat=fieldFormats.getType("number");formatter=new FieldFormat({pattern:format},getConfig)}}return val=>{let value;if(!Object(external_osdSharedDeps_Lodash_["isNumber"])(val)){value=val}else{try{value=formatter.convert(val,"text")}catch(e){value=val}}try{return render({value:value})}catch(e){return String(value)}}};var classnames=__webpack_require__(103);var classnames_default=__webpack_require__.n(classnames);var get_timezone=__webpack_require__(13);var external_osdSharedDeps_Jquery_=__webpack_require__(37);var external_osdSharedDeps_Jquery_default=__webpack_require__.n(external_osdSharedDeps_Jquery_);const ACTIVE_CURSOR="ACTIVE_CURSOR";const eventBus=external_osdSharedDeps_Jquery_default()({});const COLORS={LINE_COLOR:"rgba(105,112,125,0.2)",TEXT_COLOR:"rgba(0,0,0,0.4)",TEXT_COLOR_REVERSED:"rgba(255,255,255,0.5)",VALUE_COLOR:"rgba(0,0,0,0.7)",VALUE_COLOR_REVERSED:"rgba(255,255,255,0.8)"};const GRID_LINE_CONFIG={stroke:"rgba(125,125,125,0.1)"};const X_ACCESSOR_INDEX=0;const STACK_ACCESSORS=[0];const Y_ACCESSOR_INDEXES=[1];const Y0_ACCESSOR_INDEXES=[2];const STACKED_OPTIONS={NONE:"none",PERCENT:"percent",STACKED:"stacked",STACKED_WITHIN_SERIES:"stacked_within_series"};const bombIcon=()=>external_osdSharedDeps_React_default.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},external_osdSharedDeps_React_default.a.createElement("path",{d:"M3.92176768,4.53361616 L3.46466635,5.59664282 L2.65302767,4.14840719 L0.999875397,3.99598886 L2.12641918,2.77654518 L1.76052549,1.15720408 L3.26840652,1.85178207 L4.69542405,1.00339256 L4.500802,2.65210905 L5.74864103,3.7471166 L4.73514583,3.9490388 L5.61669633,5.03766301 C6.0459022,4.69009896 6.67559863,4.75628272 7.02316269,5.18548858 L7.15815921,5.3521954 C7.8837785,5.06498672 8.68754455,4.943927 9.51742529,5.03115098 C12.2637217,5.31979836 14.2560398,7.78010639 13.9673924,10.5264028 C13.6787451,13.2726992 11.218437,15.2650173 8.47214065,14.9763699 C5.72584427,14.6877226 3.73352611,12.2274145 4.02217349,9.48111814 C4.10939747,8.6512374 4.39492411,7.8902053 4.82672133,7.24015658 L4.6917248,7.07344975 C4.34416075,6.64424389 4.41034451,6.01454746 4.83955037,5.6669834 L3.92176768,4.53361616 Z M5.46887076,6.44412936 L6.12580983,7.24015658 C6.03489722,7.30663504 5.87952666,7.491071 5.65969815,7.79346445 C5.30650784,8.32517447 5.08508565,8.93495668 5.01669539,9.5856466 C4.78577748,11.7826837 6.37963201,13.7509301 8.57666912,13.981848 C10.7737062,14.2127659 12.7419526,12.6189114 12.9728706,10.4218743 C13.2037885,8.2248372 11.6099339,6.25659078 9.41289682,6.02567287 C8.7622069,5.95728261 8.11971364,6.04708534 7.52619036,6.28200886 C7.24048061,6.40187373 7.0242157,6.5121707 6.87739563,6.61289978 L6.24601673,5.81480897 L5.46887076,6.44412936 Z M3.34009664,3.61834468 C3.6160708,3.60870745 3.83197954,3.37717367 3.82234231,3.10119951 C3.81270508,2.82522536 3.5811713,2.60931662 3.30519715,2.61895385 C3.02922299,2.62859108 2.81331425,2.86012485 2.82295148,3.13609901 C2.83258871,3.41207317 3.06412249,3.62798191 3.34009664,3.61834468 Z M9.2038399,8.01471666 C8.92921026,7.98585193 8.72997844,7.73982112 8.75884318,7.46519148 C8.78770792,7.19056185 9.03373872,6.99133003 9.30836836,7.02019477 C10.7411945,7.17079087 11.8319627,8.30660625 11.9782919,9.68376241 C11.9842403,9.72621687 11.9855849,9.77015886 11.9808868,9.81485847 C11.9520221,10.0894881 11.7059913,10.2887199 11.4313616,10.2598552 C11.1835304,10.2338071 10.9971003,10.0309074 10.9842889,9.78973323 C10.8859009,8.87197536 10.1588372,8.11509093 9.2038399,8.01471666 Z"}));const fireIcon=()=>external_osdSharedDeps_React_default.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},external_osdSharedDeps_React_default.a.createElement("path",{d:"M10.4285489,13.2131862 C11.3850613,12.5116211 12,11.4062861 12,10.1681623 C12,8.88948911 11.7647926,7.64522527 11.315853,6.48027409 L10.7184365,8.07936372 L9.62838732,6.51595716 C8.65161637,5.11502026 7.41222171,3.90368767 5.9820674,2.94508952 C5.99399825,3.12925457 6,3.31436795 6,3.50022638 C6,5.08794888 5.48443413,6.95085436 4.74437685,7.94154468 C4.26219055,8.5870316 4,9.35779518 4,10.1681623 C4,11.4427639 4.65170744,12.5766371 5.65687647,13.2741368 C5.73557697,13.041105 5.84196228,12.8229717 5.97161458,12.624616 C6.26836682,12.1706132 6.5,11.2280234 6.5,10.4287008 C6.5,9.92871906 6.42479348,9.44813694 6.28619258,9 C7.47628141,9.64169048 8.4897566,10.6210605 9.22434324,11.8251557 C9.23213615,11.8013168 9.2406884,11.7775998 9.25,11.7540048 C9.39656041,11.3826304 9.5,11.0805724 9.5,10.6495848 C9.5,10.6240812 9.49971537,10.5986511 9.49914944,10.5732981 C9.96875289,11.3529062 10.2928315,12.2486386 10.4285489,13.2131862 Z M10.4486865,5.94402249 C10.4642723,5.90230435 10.4813768,5.86079967 10.5,5.81950846 C10.7931208,5.16960326 11,4.64100165 11,3.88677339 C11,3.84214218 10.9994307,3.79763944 10.9982989,3.7532716 C12.2630338,5.59045545 13,7.7961396 13,10.1681623 C13,12.8367126 10.7614237,15 8,15 C5.23857625,15 3,12.8367126 3,10.1681623 C3,9.11340491 3.34972471,8.13758287 3.94322917,7.34307798 C4.53673363,6.54857309 5,4.8990409 5,3.50022638 C5,2.62525836 4.84958695,1.78423964 4.57238517,1 C6.95256283,2.12295834 8.97951321,3.83685594 10.4486865,5.94402249 Z"}));const ICON_NAMES={ASTERISK:"fa-asterisk",BELL:"fa-bell",BOLT:"fa-bolt",BOMB:"fa-bomb",BUG:"fa-bug",COMMENT:"fa-comment",EXCLAMATION_CIRCLE:"fa-exclamation-circle",EXCLAMATION_TRIANGLE:"fa-exclamation-triangle",FIRE:"fa-fire",FLAG:"fa-flag",HEART:"fa-heart",MAP_MARKER:"fa-map-marker",MAP_PIN:"fa-map-pin",STAR:"fa-star",TAG:"fa-tag"};const ICON_TYPES_MAP={[ICON_NAMES.ASTERISK]:"asterisk",[ICON_NAMES.BELL]:"bell",[ICON_NAMES.BOLT]:"bolt",[ICON_NAMES.BOMB]:bombIcon,[ICON_NAMES.BUG]:"bug",[ICON_NAMES.COMMENT]:"editorComment",[ICON_NAMES.EXCLAMATION_CIRCLE]:"alert",[ICON_NAMES.EXCLAMATION_TRIANGLE]:"alert",[ICON_NAMES.FIRE]:fireIcon,[ICON_NAMES.FLAG]:"flag",[ICON_NAMES.HEART]:"heart",[ICON_NAMES.MAP_MARKER]:"mapMarker",[ICON_NAMES.MAP_PIN]:"pinFilled",[ICON_NAMES.STAR]:"starFilled",[ICON_NAMES.TAG]:"tag"};const DEFAULT_COLOR="#000";const getAreaStyles=_ref=>{let{points:points,lines:lines,color:color}=_ref;return{areaSeriesStyle:{line:{stroke:color,strokeWidth:Number(lines.lineWidth)||0,visible:Boolean(lines.show&&lines.lineWidth)},area:{fill:color,opacity:lines.fill<=0?0:lines.fill,visible:Boolean(lines.show)},point:{radius:points.radius||.5,stroke:color||DEFAULT_COLOR,strokeWidth:points.lineWidth||5,visible:points.lineWidth>0&&Boolean(points.show)}},curve:lines.steps?external_osdSharedDeps_ElasticCharts_["CurveType"].CURVE_STEP:external_osdSharedDeps_ElasticCharts_["CurveType"].LINEAR}};const getBarStyles=(_ref2,color)=>{let{show:show=true,lineWidth:lineWidth=0,fill:fill=1}=_ref2;return{barSeriesStyle:{rectBorder:{stroke:color||DEFAULT_COLOR,strokeWidth:lineWidth,visible:show},rect:{fill:color||DEFAULT_COLOR,opacity:fill}}}};var prop_types=__webpack_require__(260);var prop_types_default=__webpack_require__.n(prop_types);const Chart={seriesId:prop_types_default.a.string.isRequired,seriesGroupId:prop_types_default.a.string.isRequired,name:prop_types_default.a.string.isRequired,data:prop_types_default.a.arrayOf(prop_types_default.a.arrayOf(prop_types_default.a.number)).isRequired,hideInLegend:prop_types_default.a.bool.isRequired,color:prop_types_default.a.string.isRequired,stackMode:prop_types_default.a.oneOf(["percentage","wiggle","silhouette"]),stackAccessors:prop_types_default.a.arrayOf(prop_types_default.a.number),xScaleType:prop_types_default.a.string,yScaleType:prop_types_default.a.string,timeZone:prop_types_default.a.string.isRequired,enableHistogramMode:prop_types_default.a.bool.isRequired,useDefaultGroupDomain:prop_types_default.a.bool,sortIndex:prop_types_default.a.number};const BarChart={...Chart,bars:prop_types_default.a.shape({fill:prop_types_default.a.number,lineWidth:prop_types_default.a.number,show:prop_types_default.a.boolean}).isRequired};const AreaChart={...Chart,lines:prop_types_default.a.shape({fill:prop_types_default.a.number,lineWidth:prop_types_default.a.number,show:prop_types_default.a.bool,steps:prop_types_default.a.oneOfType([prop_types_default.a.number,prop_types_default.a.bool])}).isRequired,points:prop_types_default.a.shape({lineWidth:prop_types_default.a.number,radius:prop_types_default.a.number,show:prop_types_default.a.bool}).isRequired};const ChartsEntities={BarChart:BarChart,AreaChart:AreaChart};function AreaSeriesDecorator(_ref){let{seriesId:seriesId,seriesGroupId:seriesGroupId,name:name,data:data,hideInLegend:hideInLegend,lines:lines,color:color,stackAccessors:stackAccessors,stackMode:stackMode,points:points,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:enableHistogramMode,useDefaultGroupDomain:useDefaultGroupDomain,sortIndex:sortIndex,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,tickFormat:tickFormat}=_ref;const id=seriesId;const groupId=seriesGroupId;const areaSeriesStyle=getAreaStyles({points:points,lines:lines,color:color});const seriesSettings={id:id,name:name,groupId:groupId,data:data,color:color,hideInLegend:hideInLegend,xAccessor:X_ACCESSOR_INDEX,yAccessors:Y_ACCESSOR_INDEXES,y0Accessors:lines.mode==="band"?Y0_ACCESSOR_INDEXES:undefined,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,stackAccessors:stackAccessors,stackMode:stackMode,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:enableHistogramMode,useDefaultGroupDomain:useDefaultGroupDomain,sortIndex:sortIndex,tickFormat:tickFormat,...areaSeriesStyle};if(enableHistogramMode){seriesSettings.histogramModeAlignment="center"}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticCharts_["AreaSeries"],seriesSettings)}AreaSeriesDecorator.defaultProps={yScaleType:external_osdSharedDeps_ElasticCharts_["ScaleType"].Linear,xScaleType:external_osdSharedDeps_ElasticCharts_["ScaleType"].Time};function BarSeriesDecorator(_ref){let{seriesId:seriesId,seriesGroupId:seriesGroupId,name:name,data:data,hideInLegend:hideInLegend,bars:bars,color:color,stackAccessors:stackAccessors,stackMode:stackMode,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:enableHistogramMode,useDefaultGroupDomain:useDefaultGroupDomain,sortIndex:sortIndex,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,tickFormat:tickFormat}=_ref;const id=seriesId;const groupId=seriesGroupId;const barSeriesStyle=getBarStyles(bars,color);const seriesSettings={id:id,name:name,groupId:groupId,data:data,color:color,hideInLegend:hideInLegend,xAccessor:X_ACCESSOR_INDEX,yAccessors:Y_ACCESSOR_INDEXES,y0Accessors:bars.mode==="band"?Y0_ACCESSOR_INDEXES:undefined,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,stackAccessors:stackAccessors,stackMode:stackMode,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:enableHistogramMode,useDefaultGroupDomain:useDefaultGroupDomain,sortIndex:sortIndex,tickFormat:tickFormat,...barSeriesStyle};if(enableHistogramMode){seriesSettings.histogramModeAlignment="center"}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticCharts_["BarSeries"],seriesSettings)}BarSeriesDecorator.defaultProps={yScaleType:external_osdSharedDeps_ElasticCharts_["ScaleType"].Linear,xScaleType:external_osdSharedDeps_ElasticCharts_["ScaleType"].Time};const getStackAccessors=stack=>{switch(stack){case STACKED_OPTIONS.STACKED:case STACKED_OPTIONS.STACKED_WITHIN_SERIES:case STACKED_OPTIONS.PERCENT:return STACK_ACCESSORS;default:return undefined}};var node_modules_color=__webpack_require__(131);var color_default=__webpack_require__.n(node_modules_color);function computeRelativeLuminosity(rgb){return color_default()(rgb).luminosity()}function computeContrast(rgb1,rgb2){return color_default()(rgb1).contrast(color_default()(rgb2))}function getAAARelativeLum(bgColor,fgColor){let ratio=arguments.length>2&&arguments[2]!==undefined?arguments[2]:7;const relLum1=computeRelativeLuminosity(bgColor);const relLum2=computeRelativeLuminosity(fgColor);if(relLum1>relLum2){return(relLum1+.05-ratio*.05)/ratio}else{return Math.min(ratio*(relLum1+.05)-.05,1)}}function getGrayFromRelLum(relLum){if(relLum<=.0031308){return relLum*12.92}else{return(1+.055)*Math.pow(relLum,1/2.4)-.055}}function getGrayRGBfromGray(gray){const g=Math.round(gray*255);return"rgb(".concat(g,",").concat(g,",").concat(g,")")}function getAAAGray(bgColor,fgColor){let ratio=arguments.length>2&&arguments[2]!==undefined?arguments[2]:7;const relLum=getAAARelativeLum(bgColor,fgColor,ratio);const gray=getGrayFromRelLum(relLum);return getGrayRGBfromGray(gray)}function findBestContrastColor(bgColor,lightFgColor,darkFgColor){let ratio=arguments.length>3&&arguments[3]!==undefined?arguments[3]:4.5;const lc=computeContrast(bgColor,lightFgColor);const dc=computeContrast(bgColor,darkFgColor);if(lc>=dc){if(lc>=ratio){return lightFgColor}return getAAAGray(bgColor,lightFgColor,ratio)}if(dc>=ratio){return darkFgColor}return getAAAGray(bgColor,darkFgColor,ratio)}function isValidColor(color){if(typeof color!=="string"){return false}if(color.length===0){return false}try{color_default()(color);return true}catch{return false}}function getBaseTheme(baseTheme,bgColor){if(!isValidColor(bgColor)){return baseTheme}const bgLuminosity=computeRelativeLuminosity(bgColor);const mainTheme=bgLuminosity<=.179?external_osdSharedDeps_ElasticCharts_["DARK_THEME"]:external_osdSharedDeps_ElasticCharts_["LIGHT_THEME"];const color=findBestContrastColor(bgColor,external_osdSharedDeps_ElasticCharts_["LIGHT_THEME"].axes.axisTitle.fill,external_osdSharedDeps_ElasticCharts_["DARK_THEME"].axes.axisTitle.fill);return{...mainTheme,axes:{...mainTheme.axes,axisTitle:{...mainTheme.axes.axisTitle,fill:color},tickLabel:{...mainTheme.axes.tickLabel,fill:color},axisLine:{...mainTheme.axes.axisLine,stroke:color},tickLine:{...mainTheme.axes.tickLine,stroke:color}}}}function getChartClasses(bgColor){if(typeof bgColor!=="string"){return}const bgLuminosity=computeRelativeLuminosity(bgColor);return bgLuminosity<=.179?"tvbVisTimeSeriesDark":"tvbVisTimeSeriesLight"}const generateAnnotationData=(values,formatter)=>values.map(_ref=>{let{key:key,docs:docs}=_ref;return{dataValue:key,details:docs[0],header:formatter({value:key})}});const decorateFormatter=formatter=>_ref2=>{let{value:value}=_ref2;return formatter(value)};const handleCursorUpdate=cursor=>{eventBus.trigger(ACTIVE_CURSOR,cursor)};const TimeSeries=_ref3=>{let{backgroundColor:backgroundColor,showGrid:showGrid,legend:legend,legendPosition:legendPosition,tooltipMode:tooltipMode,xAxisLabel:xAxisLabel,series:series,yAxis:yAxis,onBrush:onBrush,xAxisFormatter:xAxisFormatter,annotations:annotations}=_ref3;const chartRef=Object(external_osdSharedDeps_React_["useRef"])();Object(external_osdSharedDeps_React_["useEffect"])(()=>{const updateCursor=(_,cursor)=>{if(chartRef.current){chartRef.current.dispatchExternalPointerEvent(cursor)}};eventBus.on(ACTIVE_CURSOR,updateCursor);return()=>{eventBus.off(ACTIVE_CURSOR,undefined,updateCursor)}},[]);const tooltipFormatter=decorateFormatter(xAxisFormatter);const uiSettings=Object(services["g"])();const timeZone=Object(get_timezone["a"])(uiSettings);const hasBarChart=series.some(_ref4=>{let{bars:bars}=_ref4;return bars===null||bars===void 0?void 0:bars.show});const classes=classnames_default()("tvbVisTimeSeries",getChartClasses(backgroundColor));const{colors:colors,theme:themeService}=Object(services["a"])();const baseTheme=getBaseTheme(themeService.useChartsBaseTheme(),backgroundColor);colors.mappedColors.mapKeys(series.filter(_ref5=>{let{color:color}=_ref5;return!color}).map(_ref6=>{let{label:label}=_ref6;return label}));const onBrushEndListener=_ref7=>{let{x:x}=_ref7;if(!x){return}const[min,max]=x;onBrush(min,max)};return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticCharts_["Chart"],{ref:chartRef,renderer:"canvas",className:classes},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticCharts_["Settings"],{showLegend:legend,showLegendExtra:true,legendPosition:legendPosition,onBrushEnd:onBrushEndListener,animateData:false,onPointerUpdate:handleCursorUpdate,theme:[hasBarChart?{}:{crosshair:{band:{fill:"#F00"}}},{background:{color:backgroundColor}}],baseTheme:baseTheme,tooltip:{snap:true,type:tooltipMode==="show_focused"?external_osdSharedDeps_ElasticCharts_["TooltipType"].Follow:external_osdSharedDeps_ElasticCharts_["TooltipType"].VerticalCursor,headerFormatter:tooltipFormatter},externalPointerEvents:{tooltip:{visible:false}}}),annotations.map(_ref8=>{let{id:id,data:data,icon:icon,color:color}=_ref8;const dataValues=generateAnnotationData(data,tooltipFormatter);const style={line:{stroke:color}};return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticCharts_["LineAnnotation"],{key:id,id:id,domainType:external_osdSharedDeps_ElasticCharts_["AnnotationDomainType"].XDomain,dataValues:dataValues,marker:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIcon"],{type:ICON_TYPES_MAP[icon]||"asterisk"}),hideLinesTooltips:true,style:style})}),series.map((_ref9,sortIndex)=>{let{id:id,label:label,bars:bars,lines:lines,data:data,hideInLegend:hideInLegend,xScaleType:xScaleType,yScaleType:yScaleType,groupId:groupId,color:color,stack:stack,points:points,useDefaultGroupDomain:useDefaultGroupDomain,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,tickFormat:tickFormat}=_ref9;const stackAccessors=getStackAccessors(stack);const isPercentage=stack===STACKED_OPTIONS.PERCENT;const isStacked=stack!==STACKED_OPTIONS.NONE;const key="".concat(id,"-").concat(label);const finalColor=color!==null&&color!==void 0?color:colors.mappedColors.mapping[label];if(bars!==null&&bars!==void 0&&bars.show){return external_osdSharedDeps_React_default.a.createElement(BarSeriesDecorator,{key:key,seriesId:id,seriesGroupId:groupId,name:label.toString(),data:data,hideInLegend:hideInLegend,bars:bars,color:finalColor,stackAccessors:stackAccessors,stackMode:isPercentage?external_osdSharedDeps_ElasticCharts_["StackMode"].Percentage:undefined,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:isStacked,useDefaultGroupDomain:useDefaultGroupDomain,sortIndex:sortIndex,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,tickFormat:tickFormat})}if(lines!==null&&lines!==void 0&&lines.show){return external_osdSharedDeps_React_default.a.createElement(AreaSeriesDecorator,{key:key,seriesId:id,seriesGroupId:groupId,name:label.toString(),data:data,hideInLegend:hideInLegend,lines:lines,color:finalColor,stackAccessors:stackAccessors,stackMode:isPercentage?external_osdSharedDeps_ElasticCharts_["StackMode"].Percentage:undefined,points:points,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:isStacked,useDefaultGroupDomain:useDefaultGroupDomain,sortIndex:sortIndex,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,tickFormat:tickFormat})}return null}),yAxis.map(_ref10=>{let{id:id,groupId:groupId,position:position,tickFormatter:tickFormatter,domain:domain,hide:hide}=_ref10;return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticCharts_["Axis"],{key:groupId,groupId:groupId,id:id,position:position,domain:domain,hide:hide,gridLine:{...GRID_LINE_CONFIG,visible:showGrid},tickFormat:tickFormatter})}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticCharts_["Axis"],{id:"bottom",position:external_osdSharedDeps_ElasticCharts_["Position"].Bottom,title:xAxisLabel,tickFormat:xAxisFormatter,gridLine:{...GRID_LINE_CONFIG,visible:showGrid}}))};TimeSeries.defaultProps={showGrid:true,legend:true,legendPosition:"right"};var opensearchDashboardsReact_public_=__webpack_require__(34);function replaceVars(str){let args=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};let vars=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};try{const template=handlebars_default.a.compile(str,{strict:true,knownHelpersOnly:true});const string=template(external_osdSharedDeps_Lodash_default.a.assign({},vars,{args:args}));return string}catch(e){if(e.toString().indexOf("Parse error")!==-1){return str}else if(e.message.indexOf("not defined in")!==-1){const badVar=e.message.split(/"/)[1];e.error={caused_by:{reason:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.replaceVars.errors.unknownVarDescription",{defaultMessage:"{badVar} is an unknown variable",values:{badVar:"{{"+badVar+"}}"}}),title:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.replaceVars.errors.unknownVarTitle",{defaultMessage:"Error processing your markdown"})}}}else{e.error={caused_by:{reason:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.replaceVars.errors.markdownErrorDescription",{defaultMessage:"Please verify you are only using markdown, known variables, and built-in Handlebars expressions"}),title:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.replaceVars.errors.markdownErrorTitle",{defaultMessage:"Error processing your markdown"})}}}return e}}function getAxisLabelString(interval){if(!interval){return""}const convertedValue=convertIntervalIntoUnit(interval);if(convertedValue){return external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.axisLabelOptions.axisLabel",{defaultMessage:"per {unitValue} {unitString}",values:{unitValue:convertedValue.unitValue,unitString:convertedValue.unitString}})}}function getFormat(interval){let rules=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];for(let i=rules.length-1;i>=0;i--){const rule=rules[i];if(!rule[0]||interval>=external_osdSharedDeps_Moment_default.a.duration(rule[0])){return rule[1]}}}function createXaxisFormatter(interval,rules,dateFormat){return val=>{var _getFormat;return external_osdSharedDeps_Moment_default()(val).format((_getFormat=getFormat(interval,rules))!==null&&_getFormat!==void 0?_getFormat:dateFormat)}}function vis_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class vis_TimeseriesVisualization extends external_osdSharedDeps_React_["Component"]{constructor(){super(...arguments);vis_defineProperty(this,"xAxisFormatter",interval=>val=>{const{scaledDataFormat:scaledDataFormat,dateFormat:dateFormat}=this.props.visData;const formatter=createXaxisFormatter(interval,scaledDataFormat,dateFormat);return formatter(val)});vis_defineProperty(this,"yAxisStackedByPercentFormatter",val=>{const n=Number(val)*100;return"".concat((Number.isNaN(n)?0:n).toFixed(0),"%")});vis_defineProperty(this,"applyDocTo",template=>doc=>{const vars=replaceVars(template,null,doc);if(vars instanceof Error){this.showToastNotification=vars.error.caused_by;return template}return vars});vis_defineProperty(this,"prepareAnnotations",()=>{const{model:model,visData:visData}=this.props;return Object(external_osdSharedDeps_Lodash_["map"])(model.annotations,_ref=>{let{id:id,color:color,icon:icon,template:template}=_ref;const annotationData=Object(external_osdSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".annotations.").concat(id),[]);const applyDocToTemplate=this.applyDocTo(template);return{id:id,color:color,icon:icon,data:annotationData.map(_ref2=>{let{docs:docs,...rest}=_ref2;return{...rest,docs:docs.map(applyDocToTemplate)}})}})})}componentDidUpdate(){const toastNotifications=Object(services["b"])().notifications.toasts;if(this.showToastNotification&&this.notificationReason!==this.showToastNotification.reason){if(this.notification){toastNotifications.remove(this.notification)}this.notificationReason=this.showToastNotification.reason;this.notification=toastNotifications.addDanger({title:this.showToastNotification.title,text:external_osdSharedDeps_React_default.a.createElement(opensearchDashboardsReact_public_["MarkdownSimple"],null,this.showToastNotification.reason)})}if(!this.showToastNotification&&this.notification){toastNotifications.remove(this.notification);this.notificationReason=null;this.notification=null}}render(){const{model:model,visData:visData,onBrush:onBrush}=this.props;const styles=lib_default()({default:{tvbVis:{borderColor:Object(external_osdSharedDeps_Lodash_["get"])(model,"background_color")}}});const series=Object(external_osdSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[]);const interval=getInterval(visData,model);const yAxisIdGenerator=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])("yaxis");const mainAxisGroupId=yAxisIdGenerator("main_group");const seriesModel=model.series.filter(s=>!s.hidden).map(s=>Object(external_osdSharedDeps_Lodash_["cloneDeep"])(s));const mainAxisScaleType=vis_TimeseriesVisualization.getAxisScaleType(model);const mainAxisDomain=vis_TimeseriesVisualization.getYAxisDomain(model);const yAxis=[];let mainDomainAdded=false;const allSeriesHaveSameFormatters=seriesModel.every(seriesGroup=>seriesGroup.formatter===seriesModel[0].formatter);this.showToastNotification=null;seriesModel.forEach(seriesGroup=>{const isStackedWithinSeries=seriesGroup.stacked===STACKED_OPTIONS.STACKED_WITHIN_SERIES;const hasSeparateAxis=Boolean(seriesGroup.separate_axis);const groupId=hasSeparateAxis||isStackedWithinSeries?seriesGroup.id:mainAxisGroupId;const domain=hasSeparateAxis?vis_TimeseriesVisualization.getYAxisDomain(seriesGroup):undefined;const isCustomDomain=groupId!==mainAxisGroupId;const seriesGroupTickFormatter=vis_TimeseriesVisualization.getTickFormatter(seriesGroup,this.props.getConfig);const yScaleType=hasSeparateAxis?vis_TimeseriesVisualization.getAxisScaleType(seriesGroup):mainAxisScaleType;if(seriesGroup.stacked===STACKED_OPTIONS.PERCENT){seriesGroup.separate_axis=true;seriesGroup.axisFormatter="percent";seriesGroup.axis_min=seriesGroup.axis_min||0;seriesGroup.axis_max=seriesGroup.axis_max||1;seriesGroup.axis_position=model.axis_position}series.filter(r=>Object(external_osdSharedDeps_Lodash_["startsWith"])(r.id,seriesGroup.id)).forEach(seriesDataRow=>{seriesDataRow.tickFormat=seriesGroupTickFormatter;seriesDataRow.groupId=groupId;seriesDataRow.yScaleType=yScaleType;seriesDataRow.hideInLegend=Boolean(seriesGroup.hide_in_legend)});if(isCustomDomain){vis_TimeseriesVisualization.addYAxis(yAxis,{domain:domain,groupId:groupId,id:yAxisIdGenerator(seriesGroup.id),position:seriesGroup.axis_position,hide:isStackedWithinSeries,tickFormatter:seriesGroup.stacked===STACKED_OPTIONS.PERCENT?this.yAxisStackedByPercentFormatter:seriesGroupTickFormatter})}else if(!mainDomainAdded){vis_TimeseriesVisualization.addYAxis(yAxis,{tickFormatter:allSeriesHaveSameFormatters?seriesGroupTickFormatter:val=>val,id:yAxisIdGenerator("main"),groupId:mainAxisGroupId,position:model.axis_position,domain:mainAxisDomain});mainDomainAdded=true}});return external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVis",style:styles.tvbVis},external_osdSharedDeps_React_default.a.createElement(TimeSeries,{series:series,yAxis:yAxis,onBrush:onBrush,backgroundColor:model.background_color,showGrid:Boolean(model.show_grid),legend:Boolean(model.show_legend),legendPosition:model.legend_position,tooltipMode:model.tooltip_mode,xAxisLabel:getAxisLabelString(interval),xAxisFormatter:this.xAxisFormatter(interval),annotations:this.prepareAnnotations()}))}}vis_defineProperty(vis_TimeseriesVisualization,"getYAxisDomain",model=>{const axisMin=Object(external_osdSharedDeps_Lodash_["get"])(model,"axis_min","").toString();const axisMax=Object(external_osdSharedDeps_Lodash_["get"])(model,"axis_max","").toString();const fit=model.series?model.series.filter(_ref3=>{let{hidden:hidden}=_ref3;return!hidden}).every(_ref4=>{let{fill:fill}=_ref4;return fill==="0"}):model.fill==="0";return{min:axisMin.length?Number(axisMin):undefined,max:axisMax.length?Number(axisMax):undefined,fit:fit}});vis_defineProperty(vis_TimeseriesVisualization,"addYAxis",(yAxis,_ref5)=>{let{id:id,groupId:groupId,position:position,tickFormatter:tickFormatter,domain:domain,hide:hide}=_ref5;yAxis.push({id:id,groupId:groupId,position:position,tickFormatter:tickFormatter,domain:domain,hide:hide})});vis_defineProperty(vis_TimeseriesVisualization,"getAxisScaleType",model=>Object(external_osdSharedDeps_Lodash_["get"])(model,"axis_scale")==="log"?external_osdSharedDeps_ElasticCharts_["ScaleType"].Log:external_osdSharedDeps_ElasticCharts_["ScaleType"].Linear);vis_defineProperty(vis_TimeseriesVisualization,"getTickFormatter",(model,getConfig)=>createTickFormatter(Object(external_osdSharedDeps_Lodash_["get"])(model,"formatter"),Object(external_osdSharedDeps_Lodash_["get"])(model,"value_template"),getConfig));function getDisplayName(Component){return Component.displayName||Component.name||"Component"}const lookup={count:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.countLabel",{defaultMessage:"Count"}),calculation:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.calculationLabel",{defaultMessage:"Calculation"}),std_deviation:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.deviationLabel",{defaultMessage:"Std. Deviation"}),variance:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.varianceLabel",{defaultMessage:"Variance"}),sum_of_squares:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.sumOfSqLabel",{defaultMessage:"Sum of Sq."}),avg:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.averageLabel",{defaultMessage:"Average"}),max:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.maxLabel",{defaultMessage:"Max"}),min:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.minLabel",{defaultMessage:"Min"}),sum:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.sumLabel",{defaultMessage:"Sum"}),percentile:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.percentileLabel",{defaultMessage:"Percentile"}),percentile_rank:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.percentileRankLabel",{defaultMessage:"Percentile Rank"}),cardinality:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.cardinalityLabel",{defaultMessage:"Cardinality"}),value_count:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.valueCountLabel",{defaultMessage:"Value Count"}),derivative:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.derivativeLabel",{defaultMessage:"Derivative"}),cumulative_sum:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.cumulativeSumLabel",{defaultMessage:"Cumulative Sum"}),moving_average:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.movingAverageLabel",{defaultMessage:"Moving Average"}),avg_bucket:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.overallAverageLabel",{defaultMessage:"Overall Average"}),min_bucket:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.overallMinLabel",{defaultMessage:"Overall Min"}),max_bucket:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.overallMaxLabel",{defaultMessage:"Overall Max"}),sum_bucket:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.overallSumLabel",{defaultMessage:"Overall Sum"}),variance_bucket:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.overallVarianceLabel",{defaultMessage:"Overall Variance"}),sum_of_squares_bucket:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.overallSumOfSqLabel",{defaultMessage:"Overall Sum of Sq."}),std_deviation_bucket:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.overallStdDeviationLabel",{defaultMessage:"Overall Std. Deviation"}),series_agg:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.seriesAggLabel",{defaultMessage:"Series Agg"}),math:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.mathLabel",{defaultMessage:"Math"}),serial_diff:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.serialDifferenceLabel",{defaultMessage:"Serial Difference"}),filter_ratio:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.filterRatioLabel",{defaultMessage:"Filter Ratio"}),positive_only:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.positiveOnlyLabel",{defaultMessage:"Positive Only"}),static:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.staticValueLabel",{defaultMessage:"Static Value"}),top_hit:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.topHitLabel",{defaultMessage:"Top Hit"}),positive_rate:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggLookup.positiveRateLabel",{defaultMessage:"Positive Rate"})};const pipeline=["calculation","derivative","cumulative_sum","moving_average","avg_bucket","min_bucket","max_bucket","sum_bucket","variance_bucket","sum_of_squares_bucket","std_deviation_bucket","series_agg","math","serial_diff","positive_only"];const byType={_all:lookup,pipeline:pipeline,basic:external_osdSharedDeps_Lodash_default.a.omit(lookup,pipeline),metrics:external_osdSharedDeps_Lodash_default.a.pick(lookup,["count","avg","min","max","sum","cardinality","value_count"])};function isBasicAgg(item){return external_osdSharedDeps_Lodash_default.a.includes(Object.keys(byType.basic),item.type)}const paths=["cumulative_sum","derivative","moving_average","avg_bucket","sum_bucket","min_bucket","max_bucket","std_deviation_bucket","variance_bucket","sum_of_squares_bucket","serial_diff","positive_only"];function calculateLabel(metric,metrics){if(!metric){return external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.unknownLabel",{defaultMessage:"Unknown"})}if(metric.alias){return metric.alias}if(metric.type==="count"){return external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.countLabel",{defaultMessage:"Count"})}if(metric.type==="calculation"){return external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.bucketScriptsLabel",{defaultMessage:"Bucket Script"})}if(metric.type==="math"){return external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.mathLabel",{defaultMessage:"Math"})}if(metric.type==="series_agg"){return external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.seriesAggLabel",{defaultMessage:"Series Agg ({metricFunction})",values:{metricFunction:metric.function}})}if(metric.type==="filter_ratio"){return external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.filterRatioLabel",{defaultMessage:"Filter Ratio"})}if(metric.type==="positive_rate"){return external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.positiveRateLabel",{defaultMessage:"Positive Rate of {field}",values:{field:metric.field}})}if(metric.type==="static"){return external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.staticValueLabel",{defaultMessage:"Static Value of {metricValue}",values:{metricValue:metric.value}})}if(Object(external_osdSharedDeps_Lodash_["includes"])(paths,metric.type)){const targetMetric=metrics.find(m=>Object(external_osdSharedDeps_Lodash_["startsWith"])(metric.field,m.id));const targetLabel=calculateLabel(targetMetric,metrics);if(targetMetric&&targetMetric.type==="percentile"){const percentileValueMatch=/\[([0-9\.]+)\]$/;const matches=metric.field.match(percentileValueMatch);if(matches){return external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.lookupMetricTypeOfTargetWithAdditionalLabel",{defaultMessage:"{lookupMetricType} of {targetLabel} ({additionalLabel})",values:{lookupMetricType:lookup[metric.type],targetLabel:targetLabel,additionalLabel:matches[1]}})}}return external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.lookupMetricTypeOfTargetLabel",{defaultMessage:"{lookupMetricType} of {targetLabel}",values:{lookupMetricType:lookup[metric.type],targetLabel:targetLabel}})}return external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.lookupMetricTypeOfMetricFieldRankLabel",{defaultMessage:"{lookupMetricType} of {metricField}",values:{lookupMetricType:lookup[metric.type],metricField:metric.field}})}function visWithSplits(WrappedComponent){function SplitVisComponent(props){const{model:model,visData:visData}=props;if(!model||!visData||!visData[model.id])return external_osdSharedDeps_React_default.a.createElement(WrappedComponent,props);if(visData[model.id].series.every(s=>s.id.split(":").length===1)){return external_osdSharedDeps_React_default.a.createElement(WrappedComponent,props)}const splitsVisData=visData[model.id].series.reduce((acc,series)=>{const[seriesId,splitId]=series.id.split(":");const seriesModel=model.series.find(s=>s.id===seriesId);if(!seriesModel||!splitId)return acc;const metric=Object(external_osdSharedDeps_Lodash_["last"])(seriesModel.metrics);const label=calculateLabel(metric,seriesModel.metrics);if(!acc[splitId]){acc[splitId]={series:[],label:series.label.toString()}}acc[splitId].series.push({...series,id:seriesId,color:series.color||seriesModel.color,label:seriesModel.label||label});return acc},{});const nonSplitSeries=Object(external_osdSharedDeps_Lodash_["first"])(visData[model.id].series.filter(series=>{const seriesModel=model.series.find(s=>s.id===series.id);if(!seriesModel)return false;return["everything","filter"].includes(seriesModel.split_mode)}));const indexOfNonSplit=nonSplitSeries?Object(external_osdSharedDeps_Lodash_["findIndex"])(model.series,s=>s.id===nonSplitSeries.id):null;const rows=Object.keys(splitsVisData).map(key=>{const splitData=splitsVisData[key];const{series:series,label:label}=splitData;const newSeries=indexOfNonSplit!=null&&indexOfNonSplit>0?[...series,nonSplitSeries]:[nonSplitSeries,...series];const newVisData={[model.id]:{id:model.id,series:newSeries||series}};return external_osdSharedDeps_React_default.a.createElement("div",{key:key,className:"tvbSplitVis__split"},external_osdSharedDeps_React_default.a.createElement(WrappedComponent,{model:model,visData:newVisData,onBrush:props.onBrush,additionalLabel:label,backgroundColor:props.backgroundColor,getConfig:props.getConfig}))});return external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbSplitVis"},rows)}SplitVisComponent.displayName="SplitVisComponent(".concat(getDisplayName(WrappedComponent),")");return SplitVisComponent}const DEFAULT_VALUE=0;const extractValue=data=>data&&data[1]||null;const getLastValue=function(data){let defaultValue=arguments.length>1&&arguments[1]!==undefined?arguments[1]:DEFAULT_VALUE;if(!Object(external_osdSharedDeps_Lodash_["isArray"])(data)){return data||defaultValue}return extractValue(Object(external_osdSharedDeps_Lodash_["last"])(data))||defaultValue};var external_osdSharedDeps_ReactDom_=__webpack_require__(8);function calcDimensions(el,scale){const newWidth=Math.floor(el.clientWidth*scale);const newHeight=Math.floor(el.clientHeight*scale);return[newWidth,newHeight]}function calculateCoordinates(innerRef,resizeRef,state){const inner=Object(external_osdSharedDeps_ReactDom_["findDOMNode"])(innerRef);const resize=Object(external_osdSharedDeps_ReactDom_["findDOMNode"])(resizeRef);let scale=state.scale;if(resize.clientWidth-resize.clientHeight<0){scale=resize.clientWidth/inner.clientWidth}else{scale=resize.clientHeight/inner.clientHeight}let[newWidth,newHeight]=calcDimensions(inner,scale);if(newWidth>resize.clientWidth){scale=resize.clientWidth/inner.clientWidth}if(newHeight>resize.clientHeight){scale=resize.clientHeight/inner.clientHeight}[newWidth,newHeight]=calcDimensions(inner,scale);const translateX=(newWidth-inner.clientWidth)/2;const translateY=(newHeight-inner.clientHeight)/2;const top=Math.floor((resize.clientHeight-newHeight)/2);const left=Math.floor((resize.clientWidth-newWidth)/2);return{scale:scale,top:top,left:left,translateY:translateY,translateX:translateX}}class metric_Metric extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);this.state={scale:1,left:0,top:0,translateX:1,translateY:1};this.handleResize=this.handleResize.bind(this)}UNSAFE_componentWillMount(){const check=()=>{this.timeout=setTimeout(()=>{const newState=calculateCoordinates(this.inner,this.resize,this.state);if(newState&&this.state&&!external_osdSharedDeps_Lodash_default.a.isEqual(newState,this.state)){this.handleResize()}check()},500)};check()}componentWillUnmount(){clearTimeout(this.timeout)}componentDidMount(){this.handleResize()}handleResize(){const newState=calculateCoordinates(this.inner,this.resize,this.state);this.setState(newState)}render(){const{metric:metric,secondary:secondary}=this.props;const{scale:scale,translateX:translateX,translateY:translateY}=this.state;const primaryFormatter=metric&&(metric.tickFormatter||metric.formatter)||(n=>n);const primaryValue=primaryFormatter(getLastValue(metric&&metric.data||0));const styles=lib_default()({default:{container:{},inner:{top:this.state.top||0,left:this.state.left||0,transform:"matrix(".concat(scale,", 0, 0, ").concat(scale,", ").concat(translateX,", ").concat(translateY,")")},primary_value:{},secondary_value:{}},reversed:{primary_value:{},secondary_value:{}}},this.props);if(this.props.backgroundColor)styles.container.backgroundColor=this.props.backgroundColor;if(metric&&metric.color)styles.primary_value.color=metric.color;let primaryLabel;if(metric&&metric.label){primaryLabel=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVisMetric__label--primary"},metric.label)}let secondarySnippet;if(secondary){const secondaryFormatter=secondary.formatter||(n=>n);const secondaryValue=secondaryFormatter(getLastValue(secondary.data));if(secondary.color)styles.secondary_value.color=secondary.color;let secondaryLabel;if(secondary.label){secondaryLabel=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVisMetric__label--secondary"},secondary.label)}secondarySnippet=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVisMetric__secondary"},secondaryLabel,external_osdSharedDeps_React_default.a.createElement("div",{style:styles.secondary_value,className:"tvbVisMetric__value--secondary"},secondaryValue))}let additionalLabel;if(this.props.additionalLabel){additionalLabel=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVisMetric__label--additional"},this.props.additionalLabel)}let className="tvbVisMetric";if(!styles.container.backgroundColor){className+=" tvbVisMetric--noBackground"}if(this.props.reversed){className+=" tvbVisMetric--reversed"}return external_osdSharedDeps_React_default.a.createElement("div",{className:className,style:styles.container},external_osdSharedDeps_React_default.a.createElement("div",{ref:el=>this.resize=el,className:"tvbVisMetric__resize"},external_osdSharedDeps_React_default.a.createElement("div",{ref:el=>this.inner=el,className:"tvbVisMetric__inner",style:styles.inner},external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVisMetric__primary"},primaryLabel,external_osdSharedDeps_React_default.a.createElement("div",{style:styles.primary_value,"data-test-subj":"tsvbMetricValue",className:"tvbVisMetric__value--primary"},primaryValue)),secondarySnippet,additionalLabel)))}}const isDarkTheme=()=>Object(services["g"])().get("theme:darkMode");const isColorDark=c=>color_default()(c).luminosity()<.45;const isThemeDark=currentTheme=>{let themeIsDark=currentTheme||isDarkTheme();if(typeof currentTheme==="string"){themeIsDark=isColorDark(currentTheme)}return themeIsDark};const isBackgroundDark=(backgroundColor,currentTheme)=>{const themeIsDark=isThemeDark(currentTheme);if(!backgroundColor||backgroundColor==="inherit"){return themeIsDark}return isColorDark(backgroundColor)};const isBackgroundInverted=(backgroundColor,currentTheme)=>{const backgroundIsDark=isBackgroundDark(backgroundColor,currentTheme);const themeIsDark=isThemeDark(currentTheme);return backgroundIsDark!==themeIsDark};function getColors(props){const{model:model,visData:visData}=props;const series=Object(external_osdSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[]).filter(s=>!Object(external_osdSharedDeps_Lodash_["isUndefined"])(s));let color;let background;if(model.background_color_rules){model.background_color_rules.forEach(rule=>{if(rule.operator&&rule.value!=null){const value=series[0]&&getLastValue(series[0].data)||0;if(external_osdSharedDeps_Lodash_default.a[rule.operator](value,rule.value)){background=rule.background_color;color=rule.color}}})}return{color:color,background:background}}function MetricVisualization(props){const{backgroundColor:backgroundColor,model:model,visData:visData}=props;const colors=getColors(props);const series=Object(external_osdSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[]).filter(row=>row).map((row,i)=>{const seriesDef=model.series.find(s=>Object(external_osdSharedDeps_Lodash_["includes"])(row.id,s.id));const newProps={};if(seriesDef){newProps.formatter=createTickFormatter(seriesDef.formatter,seriesDef.value_template,props.getConfig)}if(i===0&&colors.color)newProps.color=colors.color;return Object(external_osdSharedDeps_Lodash_["assign"])({},Object(external_osdSharedDeps_Lodash_["pick"])(row,["label","data"]),newProps)});const panelBackgroundColor=colors.background||backgroundColor;const style={backgroundColor:panelBackgroundColor};const params={metric:series[0],additionalLabel:props.additionalLabel,reversed:isBackgroundInverted(panelBackgroundColor)};if(series[1]){params.secondary=series[1]}return external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVis",style:style},external_osdSharedDeps_React_default.a.createElement(metric_Metric,params))}const vis_metric=visWithSplits(MetricVisualization);function top_n_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const RENDER_MODES={POSITIVE:"positive",NEGATIVE:"negative",MIXED:"mixed"};class top_n_TopN extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);this.tableRef=external_osdSharedDeps_React_default.a.createRef();this.state={labelMaxWidth:150}}get labelMaxWidth(){return this.tableRef.current.offsetWidth*.35}componentDidMount(){this.setState({labelMaxWidth:this.labelMaxWidth})}componentDidUpdate(prevProps,prevState){if(prevState.labelMaxWidth!==this.labelMaxWidth){this.setState({labelMaxWidth:this.labelMaxWidth})}}handleClick(item){return()=>{if(this.props.onClick){this.props.onClick(item)}}}renderRow(_ref){let{min:min,max:max}=_ref;return item=>{const renderMode=top_n_TopN.getRenderMode(min,max);const key="".concat(item.id||item.label);const lastValue=getLastValue(item.data);const formatter=item.tickFormatter||this.props.tickFormatter;const isPositiveValue=lastValue>=0;const intervalLength=top_n_TopN.calcDomain(renderMode,min,max);const width=100*(Math.abs(lastValue)/intervalLength)||0;const styles=lib_default()({default:{innerBar:{...top_n_TopN.calcInnerBarStyles(renderMode,isPositiveValue)},innerBarValue:{...top_n_TopN.calcInnerBarDivStyles(item,width,isPositiveValue)},label:{maxWidth:this.state.labelMaxWidth}},onClick:{row:{cursor:"pointer"}}},this.props);return external_osdSharedDeps_React_default.a.createElement("tr",{key:key,onClick:this.handleClick({lastValue:lastValue,...item}),style:styles.row},external_osdSharedDeps_React_default.a.createElement("td",{title:item.label,className:"tvbVisTopN__label",style:styles.label},item.label),external_osdSharedDeps_React_default.a.createElement("td",{width:"100%",className:"tvbVisTopN__bar"},external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVisTopN__innerBar",style:styles.innerBar},external_osdSharedDeps_React_default.a.createElement("div",{style:styles.innerBarValue}))),external_osdSharedDeps_React_default.a.createElement("td",{className:"tvbVisTopN__value","data-test-subj":"tsvbTopNValue"},formatter(lastValue)))}}render(){if(!this.props.series)return null;const intervalSettings=this.props.series.reduce((acc,series,index)=>{const value=getLastValue(series.data);return{min:!index||value<acc.min?value:acc.min,max:!index||value>acc.max?value:acc.max}},{min:undefined,max:undefined});const rows=this.props.series.map(this.renderRow(intervalSettings));let className="tvbVisTopN";if(this.props.reversed){className+=" tvbVisTopN--reversed"}return external_osdSharedDeps_React_default.a.createElement("div",{className:className},external_osdSharedDeps_React_default.a.createElement("table",{className:"tvbVisTopN__table","data-test-subj":"tvbVisTopNTable",ref:this.tableRef},external_osdSharedDeps_React_default.a.createElement("tbody",null,rows)))}}top_n_defineProperty(top_n_TopN,"getRenderMode",(min,max)=>{if(min>=0){return RENDER_MODES.POSITIVE}else if(max<0){return RENDER_MODES.NEGATIVE}return RENDER_MODES.MIXED});top_n_defineProperty(top_n_TopN,"calcInnerBarStyles",(renderMode,isPositive)=>{if(renderMode===RENDER_MODES.MIXED){return{[isPositive?"marginLeft":"marginRight"]:"50%"}}return{}});top_n_defineProperty(top_n_TopN,"calcInnerBarDivStyles",(item,width,isPositive)=>({backgroundColor:item.color,width:width+"%",float:isPositive?"left":"right"}));top_n_defineProperty(top_n_TopN,"calcDomain",(renderMode,min,max)=>{if(renderMode===RENDER_MODES.MIXED){return Math.max(max,Math.abs(min))}else if(renderMode===RENDER_MODES.NEGATIVE){return Math.abs(min)}return max});top_n_TopN.defaultProps={tickFormatter:n=>n,onClick:i=>i,direction:"desc"};const OPERATORS={gt:external_osdSharedDeps_Lodash_["gt"],gte:external_osdSharedDeps_Lodash_["gte"],lt:external_osdSharedDeps_Lodash_["lt"],lte:external_osdSharedDeps_Lodash_["lte"]};function sortByDirection(data,direction,fn){if(direction==="desc"){return Object(external_osdSharedDeps_Lodash_["sortBy"])(data,fn).reverse()}return Object(external_osdSharedDeps_Lodash_["sortBy"])(data,fn)}function sortSeries(visData,model){const series=Object(external_osdSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[]);return model.series.reduce((acc,item)=>{const itemSeries=series.filter(s=>{const id=Object(external_osdSharedDeps_Lodash_["first"])(s.id.split(/:/));return id===item.id});const direction=item.terms_direction||"desc";if(item.terms_order_by==="_key")return acc.concat(itemSeries);return acc.concat(sortByDirection(itemSeries,direction,s=>getLastValue(s.data)))},[])}function TopNVisualization(props){const{backgroundColor:backgroundColor,model:model,visData:visData}=props;const series=sortSeries(visData,model).map(item=>{const id=Object(external_osdSharedDeps_Lodash_["first"])(item.id.split(/:/));const seriesConfig=model.series.find(s=>s.id===id);if(seriesConfig){const tickFormatter=createTickFormatter(seriesConfig.formatter,seriesConfig.value_template,props.getConfig);const value=getLastValue(item.data);let color=item.color||seriesConfig.color;if(model.bar_color_rules){model.bar_color_rules.forEach(rule=>{if(rule.operator&&rule.value!=null&&rule.bar_color){if(OPERATORS[rule.operator](value,rule.value)){color=rule.bar_color}}})}return{...item,color:color,tickFormatter:tickFormatter}}return item});const panelBackgroundColor=model.background_color||backgroundColor;const style={backgroundColor:panelBackgroundColor};const params={series:series,reversed:isBackgroundInverted(panelBackgroundColor)};if(model.drilldown_url){params.onClick=item=>{const url=replaceVars(model.drilldown_url,{},{key:item.label});Object(services["b"])().application.navigateToUrl(url)}}return external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVis",style:style},external_osdSharedDeps_React_default.a.createElement(top_n_TopN,params))}const basicAggs=["count","avg","max","min","sum","std_deviation","variance","sum_of_squares","value_count","cardinality"];function isSortable(metric){return basicAggs.includes(metric.type)}const METRIC_TYPES={PERCENTILE:"percentile",PERCENTILE_RANK:"percentile_rank",TOP_HIT:"top_hit",COUNT:"count",DERIVATIVE:"derivative",STD_DEVIATION:"std_deviation",VARIANCE:"variance",SUM_OF_SQUARES:"sum_of_squares",CARDINALITY:"cardinality",VALUE_COUNT:"value_count",AVERAGE:"avg",SUM:"sum"};const EXTENDED_STATS_TYPES=[METRIC_TYPES.STD_DEVIATION,METRIC_TYPES.VARIANCE,METRIC_TYPES.SUM_OF_SQUARES];function table_vis_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getColor(rules,colorKey,value){let color;if(rules){rules.forEach(rule=>{if(rule.operator&&rule.value!=null){if(external_osdSharedDeps_Lodash_default.a[rule.operator](value,rule.value)){color=rule[colorKey]}}})}return color}class vis_TableVis extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);table_vis_defineProperty(this,"renderRow",row=>{const{model:model}=this.props;let rowDisplay=model.pivot_type==="date"?this.dateFormatter.convert(row.key):row.key;if(model.drilldown_url){const url=replaceVars(model.drilldown_url,{},{key:row.key});rowDisplay=external_osdSharedDeps_React_default.a.createElement("a",{href:url},rowDisplay)}const columns=row.series.filter(item=>item).map(item=>{const column=this.visibleSeries.find(c=>c.id===item.id);if(!column)return null;const formatter=createTickFormatter(column.formatter,column.value_template,this.props.getConfig);const value=formatter(item.last);let trend;if(column.trend_arrows){const trendIcon=item.slope>0?"sortUp":"sortDown";trend=external_osdSharedDeps_React_default.a.createElement("span",null,"  ",external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIcon"],{type:trendIcon,color:"subdued"}))}const style={color:getColor(column.color_rules,"text",item.last)};return external_osdSharedDeps_React_default.a.createElement("td",{key:"".concat(row.key,"-").concat(item.id),"data-test-subj":"tvbTableVis__value",className:"eui-textRight",style:style},external_osdSharedDeps_React_default.a.createElement("span",null,value),trend)});return external_osdSharedDeps_React_default.a.createElement("tr",{key:row.key},external_osdSharedDeps_React_default.a.createElement("td",null,rowDisplay),columns)});const fieldFormatsService=Object(services["d"])();const DateFormat=fieldFormatsService.getType(public_["fieldFormats"].FIELD_FORMAT_IDS.DATE);this.dateFormatter=new DateFormat({},this.props.getConfig)}get visibleSeries(){return Object(external_osdSharedDeps_Lodash_["get"])(this.props,"model.series",[]).filter(series=>!series.hidden)}renderHeader(){const{model:model,uiState:uiState,onUiState:onUiState}=this.props;const stateKey="".concat(model.type,".sort");const sort=uiState.get(stateKey,{column:"_default_",order:"asc"});const calculateHeaderLabel=(metric,item)=>{const defaultLabel=item.label||calculateLabel(metric,item.metrics);switch(metric.type){case METRIC_TYPES.PERCENTILE:return"".concat(defaultLabel," (").concat(Object(external_osdSharedDeps_Lodash_["last"])(metric.percentiles).value||0,")");case METRIC_TYPES.PERCENTILE_RANK:return"".concat(defaultLabel," (").concat(Object(external_osdSharedDeps_Lodash_["last"])(metric.values)||0,")");default:return defaultLabel}};const columns=this.visibleSeries.map(item=>{const metric=Object(external_osdSharedDeps_Lodash_["last"])(item.metrics);const label=calculateHeaderLabel(metric,item);const handleClick=()=>{if(!isSortable(metric))return;let order;if(sort.column===item.id){order=sort.order==="asc"?"desc":"asc"}else{order="asc"}onUiState(stateKey,{column:item.id,order:order})};let sortComponent;if(isSortable(metric)){let sortIcon;if(sort.column===item.id){sortIcon=sort.order==="asc"?"sortUp":"sortDown"}else{sortIcon="empty"}sortComponent=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIcon"],{type:sortIcon})}let headerContent=external_osdSharedDeps_React_default.a.createElement("span",null,label," ",sortComponent);if(!isSortable(metric)){headerContent=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiToolTip"],{content:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.columnNotSortableTooltip",defaultMessage:"This column is not sortable"})},headerContent)}return external_osdSharedDeps_React_default.a.createElement("th",{onClick:handleClick,key:item.id,scope:"col"},headerContent)});const label=model.pivot_label||model.pivot_field||model.pivot_id;let sortIcon;if(sort.column==="_default_"){sortIcon=sort.order==="asc"?"sortUp":"sortDown"}else{sortIcon="empty"}const sortComponent=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIcon"],{type:sortIcon});const handleSortClick=()=>{let order;if(sort.column==="_default_"){order=sort.order==="asc"?"desc":"asc"}else{order="asc"}onUiState(stateKey,{column:"_default_",order:order})};return external_osdSharedDeps_React_default.a.createElement("tr",null,external_osdSharedDeps_React_default.a.createElement("th",{className:"eui-textLeft",scope:"col",onClick:handleSortClick},label," ",sortComponent),columns)}render(){const{visData:visData,model:model}=this.props;const header=this.renderHeader();let rows;if(Object(external_osdSharedDeps_Lodash_["isArray"])(visData.series)&&visData.series.length){rows=visData.series.map(this.renderRow)}else{const message=model.pivot_id?external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.noResultsAvailableMessage",defaultMessage:"No results available."}):external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.noResultsAvailableWithDescriptionMessage",defaultMessage:"No results available. You must choose a group by field for this visualization."});rows=external_osdSharedDeps_React_default.a.createElement("tr",null,external_osdSharedDeps_React_default.a.createElement("td",{colSpan:this.visibleSeries.length+1},message))}return external_osdSharedDeps_React_default.a.createElement(opensearchDashboardsReact_public_["RedirectAppLinks"],{application:Object(services["b"])().application,className:"tvbVis","data-test-subj":"tableView"},external_osdSharedDeps_React_default.a.createElement("table",{className:"table"},external_osdSharedDeps_React_default.a.createElement("thead",null,header),external_osdSharedDeps_React_default.a.createElement("tbody",null,rows)))}}vis_TableVis.defaultProps={sort:{}};const getValueBy=(fn,data)=>{if(external_osdSharedDeps_Lodash_default.a.isNumber(data))return data;if(!Array.isArray(data))return 0;const values=data.map(v=>v[1]);return external_osdSharedDeps_Lodash_default.a[fn](values)};function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}class gauge_vis_GaugeVis extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);this.state={scale:1,top:0,left:0,translateX:1,translateY:1};this.handleResize=this.handleResize.bind(this)}UNSAFE_componentWillMount(){const check=()=>{this.timeout=setTimeout(()=>{const newState=calculateCoordinates(this.inner,this.resize,this.state);if(newState&&this.state&&!external_osdSharedDeps_Lodash_default.a.isEqual(newState,this.state)){this.handleResize()}check()},500)};check()}componentWillUnmount(){clearTimeout(this.timeout)}componentDidMount(){this.handleResize()}handleResize(){const newState=calculateCoordinates(this.inner,this.resize,this.state);this.setState(newState)}render(){const{type:type,value:value,max:max,color:color}=this.props;const{scale:scale,translateX:translateX,translateY:translateY}=this.state;const size=2*Math.PI*50;const sliceSize=type==="half"?.6:1;const percent=value<max?value/max:1;const styles=lib_default()({default:{resize:{position:"relative",display:"flex",rowDirection:"column",flex:"1 0 auto",overflow:"hidden"},svg:{position:"absolute",top:this.state.top,left:this.state.left,transform:"matrix(".concat(scale,", 0, 0, ").concat(scale,", ").concat(translateX,", ").concat(translateY,")")},innerLine:{strokeWidth:this.props.innerLine},gaugeLine:{strokeWidth:this.props.gaugeLine}},half:{svg:{transform:"matrix(".concat(scale,", 0, 0, ").concat(scale,", ").concat(translateX,", ").concat(translateY,")")}}},{half:type==="half"});const props={circle:{r:50,cx:60,cy:60,fill:"rgba(0,0,0,0)",stroke:color,strokeWidth:this.props.gaugeLine,strokeDasharray:"".concat(percent*sliceSize*size," ").concat(size),transform:"rotate(-90 60 60)"},circleBackground:{r:50,cx:60,cy:60,fill:"rgba(0,0,0,0)",stroke:COLORS.LINE_COLOR,strokeDasharray:"".concat(sliceSize*size," ").concat(size),strokeWidth:this.props.innerLine}};if(type==="half"){props.circle.transform="rotate(-197.8 60 60)";props.circleBackground.transform="rotate(162 60 60)"}if(this.props.innerColor){props.circleBackground.stroke=this.props.innerColor}let svg;if(type==="half"){svg=external_osdSharedDeps_React_default.a.createElement("svg",{width:120.72,height:78.72},external_osdSharedDeps_React_default.a.createElement("circle",_extends({},props.circleBackground,{style:styles.innerLine})),external_osdSharedDeps_React_default.a.createElement("circle",_extends({},props.circle,{style:styles.gaugeLine})))}else{svg=external_osdSharedDeps_React_default.a.createElement("svg",{width:120.72,height:120.72},external_osdSharedDeps_React_default.a.createElement("circle",props.circleBackground),external_osdSharedDeps_React_default.a.createElement("circle",props.circle))}return external_osdSharedDeps_React_default.a.createElement("div",{ref:el=>this.resize=el,style:styles.resize},external_osdSharedDeps_React_default.a.createElement("div",{style:styles.svg,ref:el=>this.inner=el},svg))}}gauge_vis_GaugeVis.defaultProps={innerLine:2,gaugeLine:10};class gauge_Gauge extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);this.state={scale:1,top:0,left:0,translateX:1,translateY:1};this.handleResize=this.handleResize.bind(this)}UNSAFE_componentWillMount(){const check=()=>{this.timeout=setTimeout(()=>{const newState=calculateCoordinates(this.inner,this.resize,this.state);if(newState&&this.state&&!external_osdSharedDeps_Lodash_default.a.isEqual(newState,this.state)){this.handleResize()}check()},500)};check()}componentWillUnmount(){clearTimeout(this.timeout)}componentDidMount(){this.handleResize()}handleResize(){const newState=calculateCoordinates(this.inner,this.resize,this.state);this.setState(newState)}render(){const{metric:metric,type:type}=this.props;const{scale:scale,translateX:translateX,translateY:translateY}=this.state;const value=metric&&getLastValue(metric.data)||0;const max=metric&&getValueBy("max",metric.data)||1;const formatter=metric&&(metric.tickFormatter||metric.formatter)||this.props.tickFormatter||(v=>v);const title=metric&&metric.label||"";const styles=lib_default()({default:{inner:{top:this.state.top||0,left:this.state.left||0,transform:"matrix(".concat(scale,", 0, 0, ").concat(scale,", ").concat(translateX,", ").concat(translateY,")")}},valueColor:{value:{color:this.props.valueColor}}},this.props);const gaugeProps={value:value,reversed:isBackgroundDark(this.props.backgroundColor),gaugeLine:this.props.gaugeLine,innerLine:this.props.innerLine,innerColor:this.props.innerColor,max:this.props.max||max,color:metric&&metric.color||"#8ac336",type:type};let metrics;let additionalLabel;if(this.props.additionalLabel){additionalLabel=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVisGauge__additionalLabel"},this.props.additionalLabel)}if(type==="half"){metrics=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVisHalfGauge__metrics",ref:el=>this.inner=el,style:styles.inner},external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVisGauge__label",ref:"title"},title),external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVisGauge__value",style:styles.value,ref:"label"},formatter(value)),additionalLabel)}else{metrics=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVisCircleGauge__metrics",ref:el=>this.inner=el,style:styles.inner},external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVisGauge__value",style:styles.value,ref:"label"},formatter(value)),external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVisGauge__label",ref:"title"},title),additionalLabel)}const classes=classnames_default()({tvbVisHalfGauge:type==="half",tvbVisCircleGauge:type==="circle","tvbVisGauge--reversed":isBackgroundInverted(this.props.backgroundColor)});return external_osdSharedDeps_React_default.a.createElement("div",{className:classes},external_osdSharedDeps_React_default.a.createElement("div",{ref:el=>this.resize=el,className:"tvbVisGauge__resize","data-test-subj":"tvbVisGaugeContainer"},metrics,external_osdSharedDeps_React_default.a.createElement(gauge_vis_GaugeVis,gaugeProps)))}}gauge_Gauge.defaultProps={type:"half",innerLine:2,gaugeLine:10};function vis_getColors(props){const{model:model,visData:visData}=props;const series=Object(external_osdSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[]).filter(s=>!Object(external_osdSharedDeps_Lodash_["isUndefined"])(s));let text;let gauge;if(model.gauge_color_rules){model.gauge_color_rules.forEach(rule=>{if(rule.operator&&rule.value!=null){const value=series[0]&&getLastValue(series[0].data)||0;if(external_osdSharedDeps_Lodash_default.a[rule.operator](value,rule.value)){gauge=rule.gauge;text=rule.text}}})}return{text:text,gauge:gauge}}function GaugeVisualization(props){const{backgroundColor:backgroundColor,model:model,visData:visData}=props;const colors=vis_getColors(props);const series=Object(external_osdSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[]).filter(row=>row).map((row,i)=>{const seriesDef=model.series.find(s=>Object(external_osdSharedDeps_Lodash_["includes"])(row.id,s.id));const newProps={};if(seriesDef){newProps.formatter=createTickFormatter(seriesDef.formatter,seriesDef.value_template,props.getConfig)}if(i===0&&colors.gauge)newProps.color=colors.gauge;return Object(external_osdSharedDeps_Lodash_["assign"])({},row,newProps)});const panelBackgroundColor=model.background_color||backgroundColor;const style={backgroundColor:panelBackgroundColor};const params={metric:series[0],type:model.gauge_style||"half",additionalLabel:props.additionalLabel,backgroundColor:panelBackgroundColor};if(colors.text){params.valueColor=colors.text}if(model.gauge_width)params.gaugeLine=model.gauge_width;if(model.gauge_inner_color)params.innerColor=model.gauge_inner_color;if(model.gauge_inner_width)params.innerLine=model.gauge_inner_width;if(model.gauge_max!=null)params.max=model.gauge_max;return external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVis",style:style},external_osdSharedDeps_React_default.a.createElement(gauge_Gauge,params))}const vis_gauge=visWithSplits(GaugeVisualization);var uuid=__webpack_require__(39);var uuid_default=__webpack_require__.n(uuid);const guidPattern=/\[[[a-f\d-\\]{36}\]/g;function ErrorComponent(props){const{error:error}=props;let additionalInfo;const type=external_osdSharedDeps_Lodash_default.a.get(error,"error.caused_by.type")||external_osdSharedDeps_Lodash_default.a.get(error,"error.type");let reason=external_osdSharedDeps_Lodash_default.a.get(error,"error.caused_by.reason");const title=external_osdSharedDeps_Lodash_default.a.get(error,"error.caused_by.title");if(!reason){reason=external_osdSharedDeps_Lodash_default.a.get(error,"message")}if(["runtime_exception","illegal_argument_exception"].includes(type)){reason=external_osdSharedDeps_Lodash_default.a.get(error,"error.reason").replace(guidPattern,"")}if(type==="script_exception"){const scriptStack=external_osdSharedDeps_Lodash_default.a.get(error,"error.caused_by.script_stack");reason=external_osdSharedDeps_Lodash_default.a.get(error,"error.caused_by.caused_by.reason");additionalInfo=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbError__additional"},external_osdSharedDeps_React_default.a.createElement("div",null,reason),external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbError__stack"},scriptStack.join("\n")))}else if(reason){additionalInfo=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbError__additional"},reason)}return external_osdSharedDeps_React_default.a.createElement("div",{className:"visError"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIcon"],{type:"alert",size:"m",color:"danger","aria-hidden":"true"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),title||external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.error.requestForPanelFailedErrorMessage",defaultMessage:"The request for this panel failed"}),additionalInfo))}var opensearch_safer_lodash_set=__webpack_require__(272);const convertSeriesToVars=function(series,model){let dateFormat=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"lll";let getConfig=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;const variables={};model.series.forEach(seriesModel=>{series.filter(row=>external_osdSharedDeps_Lodash_default.a.startsWith(row.id,seriesModel.id)).forEach(row=>{const varName=[external_osdSharedDeps_Lodash_default.a.snakeCase(row.label),external_osdSharedDeps_Lodash_default.a.snakeCase(seriesModel.var_name)].filter(v=>v).join(".");const formatter=createTickFormatter(seriesModel.formatter,seriesModel.value_template,getConfig);const lastValue=getLastValue(row.data);const data={last:{raw:lastValue,formatted:formatter(lastValue)},data:{raw:row.data,formatted:row.data.map(point=>[external_osdSharedDeps_Moment_default()(point[0]).format(dateFormat),formatter(point[1])])}};Object(opensearch_safer_lodash_set["set"])(variables,varName,data);Object(opensearch_safer_lodash_set["set"])(variables,"".concat(external_osdSharedDeps_Lodash_default.a.snakeCase(row.label),".label"),row.label);if(row.labelFormatted){const momemntObj=external_osdSharedDeps_Moment_default()(row.labelFormatted);let val;if(momemntObj.isValid()){val=momemntObj.format(dateFormat)}else{val=row.labelFormatted}Object(opensearch_safer_lodash_set["set"])(variables,"".concat(external_osdSharedDeps_Lodash_default.a.snakeCase(row.label),".formatted"),val)}})});return variables};const getMarkdownId=id=>"markdown-".concat(id);function MarkdownVisualization(props){const{backgroundColor:backgroundColor,model:model,visData:visData,dateFormat:dateFormat}=props;const series=Object(external_osdSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[]);const variables=convertSeriesToVars(series,model,dateFormat,props.getConfig);const markdownElementId=getMarkdownId(uuid_default.a.v1());const panelBackgroundColor=model.background_color||backgroundColor;const style={backgroundColor:panelBackgroundColor};let markdown;let markdownCss="";if(model.markdown){const markdownSource=replaceVars(model.markdown,{},{_all:variables,...variables});if(model.markdown_css){markdownCss=model.markdown_css.replace(new RegExp(getMarkdownId(model.id),"g"),markdownElementId)}const markdownClasses=classnames_default()("osdMarkdown__body",{"osdMarkdown__body--reversed":isBackgroundInverted(panelBackgroundColor)});const contentClasses=classnames_default()("tvbMarkdown__content","tvbMarkdown__content--".concat(model.markdown_vertical_align),{"tvbMarkdown__content-isScrolling":model.markdown_scrollbars},markdownClasses);const markdownError=markdownSource instanceof Error?markdownSource:null;markdown=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbMarkdown","data-test-subj":"tsvbMarkdown"},markdownError&&external_osdSharedDeps_React_default.a.createElement(ErrorComponent,{error:markdownError}),external_osdSharedDeps_React_default.a.createElement("style",{type:"text/css"},markdownCss),external_osdSharedDeps_React_default.a.createElement("div",{className:contentClasses},external_osdSharedDeps_React_default.a.createElement("div",{id:markdownElementId},!markdownError&&external_osdSharedDeps_React_default.a.createElement(opensearchDashboardsReact_public_["Markdown"],{markdown:markdownSource,openLinksInNewTab:model.markdown_openLinksInNewTab}))))}return external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbVis",style:style},markdown)}function NoDataComponent(){return external_osdSharedDeps_React_default.a.createElement("div",{className:"visError","data-test-subj":"noTSVBDataMessage"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIcon"],{type:"visualizeApp",size:"m",color:"subdued","aria-hidden":"true"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement("p",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.noDataDescription",defaultMessage:"No data to display for the selected metrics"}))))}const types={timeseries:vis_TimeseriesVisualization,metric:vis_metric,top_n:TopNVisualization,table:vis_TableVis,gauge:vis_gauge,markdown:MarkdownVisualization};function Visualization(props){const{visData:visData,model:model}=props;const error=external_osdSharedDeps_Lodash_default.a.get(visData,"".concat(model.id,".error"));if(error){return external_osdSharedDeps_React_default.a.createElement("div",{className:props.className},external_osdSharedDeps_React_default.a.createElement(ErrorComponent,{error:error}))}const path=visData.type==="table"?"series":"".concat(model.id,".series");const noData=external_osdSharedDeps_Lodash_default.a.get(visData,path,[]).length===0;if(noData){return external_osdSharedDeps_React_default.a.createElement("div",{className:props.className},external_osdSharedDeps_React_default.a.createElement(NoDataComponent,null))}const component=types[model.type];if(component){return external_osdSharedDeps_React_default.a.createElement(component,{dateFormat:props.dateFormat,backgroundColor:props.backgroundColor,model:props.model,onBrush:props.onBrush,onChange:props.onChange,onUiState:props.onUiState,uiState:props.uiState,visData:visData.type===model.type?visData:{},getConfig:props.getConfig})}return external_osdSharedDeps_React_default.a.createElement("div",{className:props.className})}Visualization.defaultProps={className:"tvbVis"};function vis_picker_extends(){vis_picker_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return vis_picker_extends.apply(this,arguments)}function VisPickerItem(props){const{label:label,type:type,selected:selected}=props;const itemClassName="tvbVisPickerItem";return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{className:itemClassName,isSelected:selected,onClick:()=>props.onClick(type),"data-test-subj":"".concat(type,"TsvbTypeBtn")},label)}const VisPicker=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])((function(props){const handleChange=type=>{props.onChange({type:type})};const{model:model,intl:intl}=props;const tabs=[{type:panel_types["a"].TIMESERIES,label:intl.formatMessage({id:"visTypeTimeseries.visPicker.timeSeriesLabel",defaultMessage:"Time Series"})},{type:panel_types["a"].METRIC,label:intl.formatMessage({id:"visTypeTimeseries.visPicker.metricLabel",defaultMessage:"Metric"})},{type:panel_types["a"].TOP_N,label:intl.formatMessage({id:"visTypeTimeseries.visPicker.topNLabel",defaultMessage:"Top N"})},{type:panel_types["a"].GAUGE,label:intl.formatMessage({id:"visTypeTimeseries.visPicker.gaugeLabel",defaultMessage:"Gauge"})},{type:panel_types["a"].MARKDOWN,label:"Markdown"},{type:panel_types["a"].TABLE,label:intl.formatMessage({id:"visTypeTimeseries.visPicker.tableLabel",defaultMessage:"Table"})}].map(item=>external_osdSharedDeps_React_default.a.createElement(VisPickerItem,vis_picker_extends({key:item.type,onClick:handleChange,selected:item.type===model.type},item)));return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTabs"],null,tabs)}));const reIdSeries=source=>{const series=external_osdSharedDeps_Lodash_default.a.cloneDeep(source);series.id=uuid_default.a.v1();series.metrics.forEach(metric=>{const id=uuid_default.a.v1();const metricId=metric.id;metric.id=id;if(series.terms_order_by===metricId)series.terms_order_by=id;series.metrics.filter(r=>r.field===metricId).forEach(r=>r.field=id);series.metrics.filter(r=>r.type==="calculation"&&r.variables.some(v=>v.field===metricId)).forEach(r=>{r.variables.filter(v=>v.field===metricId).forEach(v=>{v.id=uuid_default.a.v1();v.field=id})})});return series};const COMMAS_NUMS_ONLY_RE=/[^0-9,]/g;function ColorPicker(_ref){let{name:name,value:value,disableTrash:disableTrash=false,onChange:onChange}=_ref;const initialColorValue=value!==null&&value!==void 0&&value.includes("rgba")?value.replace(COMMAS_NUMS_ONLY_RE,""):value;const[color,setColor]=Object(external_osdSharedDeps_React_["useState"])(initialColorValue||"");const handleColorChange=(text,_ref2)=>{let{rgba:rgba,hex:hex}=_ref2;setColor(text);const part={};part[name]=hex?"rgba(".concat(rgba.join(","),")"):"";onChange(part)};const handleClear=()=>{setColor("");const part={};part[name]=null;onChange(part)};const label=value?external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.colorPicker.notAccessibleWithValueAriaLabel",{defaultMessage:"Color picker ({value}), not accessible",values:{value:value}}):external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.colorPicker.notAccessibleAriaLabel",{defaultMessage:"Color picker, not accessible"});return external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbColorPicker","data-test-subj":"tvbColorPicker"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiColorPicker"],{onChange:handleColorChange,color:color,secondaryInputDisplay:"top",showAlpha:true,button:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiColorPickerSwatch"],{color:color,"aria-label":label})}),!disableTrash&&external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbColorPicker__clear",onClick:handleClear},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIconTip"],{size:"s",type:"cross",color:"danger",content:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.colorPicker.clearIconLabel",{defaultMessage:"Clear"})})))}function AddDeleteButtons(props){const{testSubj:testSubj}=props;const createDelete=()=>{if(props.disableDelete){return null}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiToolTip"],{content:props.deleteTooltip},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"".concat(testSubj,"DeleteBtn"),"aria-label":props.deleteTooltip,color:"danger",iconType:"trash",onClick:props.onDelete})))};const createAdd=()=>{if(props.disableAdd){return null}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiToolTip"],{content:props.addTooltip},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"".concat(testSubj,"AddBtn"),"aria-label":props.addTooltip,iconType:"plusInCircle",onClick:props.onAdd})))};const createClone=()=>{let cloneBtn=null;if(props.onClone&&!props.disableAdd){cloneBtn=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiToolTip"],{content:props.cloneTooltip},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"".concat(testSubj,"CloneBtn"),"aria-label":props.cloneTooltip,iconType:"copy",onClick:props.onClone})))}return cloneBtn};const createActivatePanel=()=>{let activatePanelBtn=null;if(Object(external_osdSharedDeps_Lodash_["isBoolean"])(props.isPanelActive)){const tooltip=props.isPanelActive?props.deactivatePanelTooltip:props.activatePanelTooltip;const iconType=props.isPanelActive?"eye":"eyeClosed";activatePanelBtn=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiToolTip"],{content:tooltip},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"".concat(testSubj,"ActivatePanelBtn"),"aria-label":tooltip,iconType:iconType,onClick:props.togglePanelActivation})))}return activatePanelBtn};const deleteBtn=createDelete();const addBtn=createAdd();const cloneBtn=createClone();const activatePanelBtn=createActivatePanel();return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",responsive:props.responsive,justifyContent:"flexEnd"},activatePanelBtn,cloneBtn,addBtn,deleteBtn)}AddDeleteButtons.defaultProps={testSubj:"Add",activeTooltip:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.addDeleteButtons.addButtonDefaultTooltip",{defaultMessage:"Add"}),addTooltip:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.addDeleteButtons.addButtonDefaultTooltip",{defaultMessage:"Add"}),deleteTooltip:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.addDeleteButtons.deleteButtonDefaultTooltip",{defaultMessage:"Delete"}),cloneTooltip:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.addDeleteButtons.cloneButtonDefaultTooltip",{defaultMessage:"Clone"}),activatePanelTooltip:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.addDeleteButtons.reEnableTooltip",{defaultMessage:"Re-enable"}),deactivatePanelTooltip:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.addDeleteButtons.temporarilyDisableTooltip",{defaultMessage:"Temporarily Disable"})};function series_drag_handler_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class series_drag_handler_SeriesDragHandler extends external_osdSharedDeps_React_["PureComponent"]{render(){const{dragHandleProps:dragHandleProps,hideDragHandler:hideDragHandler}=this.props;return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement("div",dragHandleProps,!hideDragHandler&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiToolTip"],{content:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.sort.dragToSortTooltip",{defaultMessage:"Drag to sort"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIcon"],{className:"tvbSeries__sortHandle","aria-label":external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.sort.dragToSortAriaLabel",{defaultMessage:"Drag to sort"}),type:"grab"}))))}}series_drag_handler_defineProperty(series_drag_handler_SeriesDragHandler,"defaultProps",{hideDragHandler:true});function AggRow(props){let iconType="eyeClosed";let iconColor="subdued";const lastSibling=Object(external_osdSharedDeps_Lodash_["last"])(props.siblings);if(lastSibling.id===props.model.id){iconType="eye";iconColor="text"}return external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{"data-test-subj":"aggRow",gutterSize:"s",alignItems:"flexStart",responsive:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIcon"],{className:"tvbAggRow__visibilityIcon",type:iconType,color:iconColor})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{className:"tvbAggRow__children"},props.children),external_osdSharedDeps_React_default.a.createElement(series_drag_handler_SeriesDragHandler,{dragHandleProps:props.dragHandleProps,hideDragHandler:props.disableDelete}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(AddDeleteButtons,{testSubj:"addMetric",addTooltip:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggRow.addMetricButtonTooltip",{defaultMessage:"Add Metric"}),deleteTooltip:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggRow.deleteMetricButtonTooltip",{defaultMessage:"Delete Metric"}),onAdd:props.onAdd,onDelete:props.onDelete,disableDelete:props.disableDelete}))))}let RESTRICTIONS_KEYS;(function(RESTRICTIONS_KEYS){RESTRICTIONS_KEYS["WHITE_LISTED_GROUP_BY_FIELDS"]="whiteListedGroupByFields";RESTRICTIONS_KEYS["ALLOW_LISTED_GROUP_BY_FIELDS"]="allowListedGroupByFields";RESTRICTIONS_KEYS["WHITE_LISTED_METRICS"]="whiteListedMetrics";RESTRICTIONS_KEYS["ALLOW_LISTED_METRICS"]="allowListedMetrics";RESTRICTIONS_KEYS["WHITE_LISTED_TIMERANGE_MODES"]="whiteListedTimerangeModes";RESTRICTIONS_KEYS["ALLOW_LISTED_TIMERANGE_MODES"]="allowListedTimerangeModes"})(RESTRICTIONS_KEYS||(RESTRICTIONS_KEYS={}));const DEFAULT_UI_RESTRICTION={"*":true};const limitOfSeries={[panel_types["a"].GAUGE]:1,[panel_types["a"].METRIC]:2};const checkUIRestrictions=function(key){let restrictions=arguments.length>1&&arguments[1]!==undefined?arguments[1]:DEFAULT_UI_RESTRICTION;let type=arguments.length>2?arguments[2]:undefined;const isAllEnabled=Object(external_osdSharedDeps_Lodash_["get"])(restrictions,"".concat(type,".*"),true);return isAllEnabled||Boolean(Object(external_osdSharedDeps_Lodash_["get"])(restrictions,type,{})[key])};const isMetricEnabled=(key,restrictions)=>checkUIRestrictions(key,restrictions,RESTRICTIONS_KEYS.ALLOW_LISTED_METRICS);const isFieldEnabled=function(field,metricType){let restrictions=arguments.length>2&&arguments[2]!==undefined?arguments[2]:DEFAULT_UI_RESTRICTION;if(isMetricEnabled(metricType,restrictions)){return checkUIRestrictions(field,restrictions[RESTRICTIONS_KEYS.ALLOW_LISTED_METRICS],metricType)}return false};const isGroupByFieldsEnabled=(key,restrictions)=>checkUIRestrictions(key,restrictions,RESTRICTIONS_KEYS.ALLOW_LISTED_GROUP_BY_FIELDS);const isTimerangeModeEnabled=(key,restrictions)=>checkUIRestrictions(key,restrictions,RESTRICTIONS_KEYS.ALLOW_LISTED_TIMERANGE_MODES);function agg_select_extends(){agg_select_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return agg_select_extends.apply(this,arguments)}const metricAggs=[{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.averageLabel",{defaultMessage:"Average"}),value:"avg"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.cardinalityLabel",{defaultMessage:"Cardinality"}),value:"cardinality"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.countLabel",{defaultMessage:"Count"}),value:"count"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.filterRatioLabel",{defaultMessage:"Filter Ratio"}),value:"filter_ratio"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.positiveRateLabel",{defaultMessage:"Positive Rate"}),value:"positive_rate"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.maxLabel",{defaultMessage:"Max"}),value:"max"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.minLabel",{defaultMessage:"Min"}),value:"min"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.percentileLabel",{defaultMessage:"Percentile"}),value:"percentile"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.percentileRankLabel",{defaultMessage:"Percentile Rank"}),value:"percentile_rank"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.staticValueLabel",{defaultMessage:"Static Value"}),value:"static"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.stdDeviationLabel",{defaultMessage:"Std. Deviation"}),value:"std_deviation"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.sumLabel",{defaultMessage:"Sum"}),value:"sum"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.sumOfSquaresLabel",{defaultMessage:"Sum of Squares"}),value:"sum_of_squares"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.topHitLabel",{defaultMessage:"Top Hit"}),value:"top_hit"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.valueCountLabel",{defaultMessage:"Value Count"}),value:"value_count"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.varianceLabel",{defaultMessage:"Variance"}),value:"variance"}];const pipelineAggs=[{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.pipelineAggs.bucketScriptLabel",{defaultMessage:"Bucket Script"}),value:"calculation"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.pipelineAggs.cumulativeSumLabel",{defaultMessage:"Cumulative Sum"}),value:"cumulative_sum"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.pipelineAggs.derivativeLabel",{defaultMessage:"Derivative"}),value:"derivative"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.pipelineAggs.movingAverageLabel",{defaultMessage:"Moving Average"}),value:"moving_average"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.pipelineAggs.positiveOnlyLabel",{defaultMessage:"Positive Only"}),value:"positive_only"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.pipelineAggs.serialDifferenceLabel",{defaultMessage:"Serial Difference"}),value:"serial_diff"}];const siblingAggs=[{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.siblingAggs.overallAverageLabel",{defaultMessage:"Overall Average"}),value:"avg_bucket"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.siblingAggs.overallMaxLabel",{defaultMessage:"Overall Max"}),value:"max_bucket"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.siblingAggs.overallMinLabel",{defaultMessage:"Overall Min"}),value:"min_bucket"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.siblingAggs.overallStdDeviationLabel",{defaultMessage:"Overall Std. Deviation"}),value:"std_deviation_bucket"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.siblingAggs.overallSumLabel",{defaultMessage:"Overall Sum"}),value:"sum_bucket"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.siblingAggs.overallSumOfSquaresLabel",{defaultMessage:"Overall Sum of Squares"}),value:"sum_of_squares_bucket"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.siblingAggs.overallVarianceLabel",{defaultMessage:"Overall Variance"}),value:"variance_bucket"}];const specialAggs=[{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.specialAggs.seriesAggLabel",{defaultMessage:"Series Agg"}),value:"series_agg"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.specialAggs.mathLabel",{defaultMessage:"Math"}),value:"math"}];const FILTER_RATIO_AGGS=["avg","cardinality","count","positive_rate","max","min","sum","value_count"];const HISTOGRAM_AGGS=["avg","count","sum","value_count"];const allAggOptions=[...metricAggs,...pipelineAggs,...siblingAggs,...specialAggs];function filterByPanelType(panelType){return agg=>{if(panelType==="table")return agg.value!=="series_agg";return true}}function AggSelect(props){const{siblings:siblings,panelType:panelType,value:value,onChange:onChange,uiRestrictions:uiRestrictions,...rest}=props;const selectedOptions=allAggOptions.filter(option=>value===option.value&&isMetricEnabled(option.value,uiRestrictions));let enablePipelines=siblings.some(s=>!!metricAggs.find(m=>m.value===s.type));if(siblings.length<=1)enablePipelines=false;let options;if(panelType==="metrics"){options=metricAggs}else if(panelType==="filter_ratio"){options=metricAggs.filter(m=>FILTER_RATIO_AGGS.includes("".concat(m.value)))}else if(panelType==="histogram"){options=metricAggs.filter(m=>HISTOGRAM_AGGS.includes("".concat(m.value)))}else{const disableSiblingAggs=agg=>({...agg,disabled:!enablePipelines||!isMetricEnabled(agg.value,uiRestrictions)});options=[{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.aggGroups.metricAggLabel",{defaultMessage:"Metric Aggregations"}),options:metricAggs.map(agg=>({...agg,disabled:!isMetricEnabled(agg.value,uiRestrictions)}))},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.aggGroups.parentPipelineAggLabel",{defaultMessage:"Parent Pipeline Aggregations"}),options:pipelineAggs.filter(filterByPanelType(panelType)).map(disableSiblingAggs)},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.aggGroups.siblingPipelineAggLabel",{defaultMessage:"Sibling Pipeline Aggregations"}),options:siblingAggs.map(disableSiblingAggs)},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.aggGroups.specialAggLabel",{defaultMessage:"Special Aggregations"}),options:specialAggs.map(disableSiblingAggs)}]}const handleChange=currentlySelectedOptions=>{if(!currentlySelectedOptions||currentlySelectedOptions.length<=0)return;onChange(currentlySelectedOptions)};return external_osdSharedDeps_React_default.a.createElement("div",{"data-test-subj":"aggSelector"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],agg_select_extends({isClearable:false,placeholder:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.aggSelect.selectAggPlaceholder",{defaultMessage:"Select aggregation"}),options:options,selectedOptions:selectedOptions,onChange:handleChange,singleSelection:{asPlainText:true}},rest)))}function getAncestors(siblings,item){const ancestors=item.id&&[item.id]||[];siblings.forEach(sib=>{if(external_osdSharedDeps_Lodash_default.a.includes(ancestors,sib.field)){ancestors.push(sib.id)}});return ancestors}const calculateSiblings=(siblings,model)=>{const ancestors=getAncestors(siblings,model);return siblings.filter(row=>!external_osdSharedDeps_Lodash_default.a.includes(ancestors,row.id))};const percentileNumberTest=/\d+\.\d+/;const toPercentileNumber=value=>percentileNumberTest.test("".concat(value))?value:"".concat(value,".0");function metric_select_extends(){metric_select_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return metric_select_extends.apply(this,arguments)}function createTypeFilter(restrict,exclude){return metric=>{if(Object(external_osdSharedDeps_Lodash_["includes"])(exclude,metric.type))return false;switch(restrict){case"basic":return Object(external_osdSharedDeps_Lodash_["includes"])(basicAggs,metric.type);default:return true}}}function filterRows(includeSiblings){return row=>{if(includeSiblings){return!/^series/.test(row.type)&&!/^percentile/.test(row.type)&&row.type!=="math"}return!/_bucket$/.test(row.type)&&!/^series/.test(row.type)&&!/^percentile/.test(row.type)&&row.type!=="math"}}function MetricSelectUi(props){const{additionalOptions:additionalOptions,restrict:restrict,metric:metric,metrics:metrics,onChange:onChange,value:value,exclude:exclude,includeSiblings:includeSiblings,clearable:clearable,intl:intl,...rest}=props;const calculatedMetrics=metrics.filter(createTypeFilter(restrict,exclude));const siblings=calculateSiblings(calculatedMetrics,metric);const percentileOptions=siblings.filter(row=>/^percentile/.test(row.type)).reduce((acc,row)=>{const label=calculateLabel(row,calculatedMetrics);switch(row.type){case METRIC_TYPES.PERCENTILE_RANK:(row.values||[]).forEach(p=>{const value=toPercentileNumber(p);acc.push({value:"".concat(row.id,"[").concat(value,"]"),label:"".concat(label," (").concat(value,")")})});case METRIC_TYPES.PERCENTILE:(row.percentiles||[]).forEach(p=>{if(p.value){const value=toPercentileNumber(p.value);acc.push({value:"".concat(row.id,"[").concat(value,"]"),label:"".concat(label," (").concat(value,")")})}})}return acc},[]);const options=siblings.filter(filterRows(includeSiblings)).map(row=>{const label=calculateLabel(row,calculatedMetrics);return{value:row.id,label:label}});const allOptions=[...options,...additionalOptions,...percentileOptions];const selectedOption=allOptions.find(option=>value===option.value);const selectedOptions=selectedOption?[selectedOption]:[];return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],metric_select_extends({placeholder:intl.formatMessage({id:"visTypeTimeseries.metricSelect.selectMetricPlaceholder",defaultMessage:"Select metric…"}),options:allOptions,selectedOptions:selectedOptions,onChange:onChange,singleSelection:{asPlainText:true},isClearable:clearable},rest))}MetricSelectUi.defaultProps={additionalOptions:[],exclude:[],metric:{},restrict:"none",includeSiblings:false};const MetricSelect=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(MetricSelectUi);const createChangeHandler=(handleChange,model)=>part=>{const doc=external_osdSharedDeps_Lodash_default.a.assign({},model,part);handleChange(doc)};const createSelectHandler=handleChange=>name=>selectedOptions=>handleChange===null||handleChange===void 0?void 0:handleChange({[name]:external_osdSharedDeps_Lodash_default.a.get(selectedOptions,"[0].value",null)});function detectIE(){const ua=window.navigator.userAgent;const msie=ua.indexOf("MSIE ");if(msie>0){return parseInt(ua.substring(msie+5,ua.indexOf(".",msie)),10)}const trident=ua.indexOf("Trident/");if(trident>0){const rv=ua.indexOf("rv:");return parseInt(ua.substring(rv+3,ua.indexOf(".",rv)),10)}const edge=ua.indexOf("Edge/");if(edge>0){return parseInt(ua.substring(edge+5,ua.indexOf(".",edge)),10)}return false}const createNumberHandler=handleChange=>(name,defaultValue)=>e=>{if(!detectIE()||e.keyCode===13)e.preventDefault();const value=Number(external_osdSharedDeps_Lodash_default.a.get(e,"target.value",defaultValue));return handleChange===null||handleChange===void 0?void 0:handleChange({[name]:value})};const MODEL_TYPES={UNWEIGHTED:"simple",WEIGHTED_EXPONENTIAL:"ewma",WEIGHTED_EXPONENTIAL_DOUBLE:"holt",WEIGHTED_EXPONENTIAL_TRIPLE:"holt_winters",WEIGHTED_LINEAR:"linear"};const DEFAULTS={model_type:MODEL_TYPES.UNWEIGHTED,alpha:.3,beta:.1,gamma:.3,period:1,multiplicative:true,window:5};const shouldShowHint=_ref=>{let{model_type:type,window:window,period:period}=_ref;return type===MODEL_TYPES.WEIGHTED_EXPONENTIAL_TRIPLE&&period*2>window};const MovingAverageAgg=props=>{const{siblings:siblings}=props;const model={...DEFAULTS,...props.model};const modelOptions=[{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.modelOptions.simpleLabel",{defaultMessage:"Simple"}),value:MODEL_TYPES.UNWEIGHTED},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.modelOptions.linearLabel",{defaultMessage:"Linear"}),value:MODEL_TYPES.WEIGHTED_LINEAR},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.modelOptions.exponentiallyWeightedLabel",{defaultMessage:"Exponentially Weighted"}),value:MODEL_TYPES.WEIGHTED_EXPONENTIAL},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.modelOptions.holtLinearLabel",{defaultMessage:"Holt-Linear"}),value:MODEL_TYPES.WEIGHTED_EXPONENTIAL_DOUBLE},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.modelOptions.holtWintersLabel",{defaultMessage:"Holt-Winters"}),value:MODEL_TYPES.WEIGHTED_EXPONENTIAL_TRIPLE}];const handleChange=createChangeHandler(props.onChange,model);const handleSelectChange=createSelectHandler(handleChange);const handleNumberChange=createNumberHandler(handleChange);const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const selectedModelOption=modelOptions.find(_ref2=>{let{value:value}=_ref2;return model.model_type===value});const multiplicativeOptions=[{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.multiplicativeOptions.true",{defaultMessage:"True"}),value:true},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.multiplicativeOptions.false",{defaultMessage:"False"}),value:false}];const selectedMultiplicative=multiplicativeOptions.find(_ref3=>{let{value:value}=_ref3;return model.multiplicative===value});return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.aggregationLabel",{defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("metric"),label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.metricLabel",{defaultMessage:"Metric"})},external_osdSharedDeps_React_default.a.createElement(MetricSelect,{onChange:handleSelectChange("field"),metrics:siblings,metric:model,value:model.field})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("model_type"),label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.modelLabel",{defaultMessage:"Model"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,placeholder:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.model.selectPlaceholder",{defaultMessage:"Select"}),options:modelOptions,selectedOptions:selectedModelOption?[selectedModelOption]:[],onChange:handleSelectChange("model_type"),singleSelection:{asPlainText:true}}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("windowSize"),label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.windowSizeLabel",{defaultMessage:"Window Size"}),helpText:shouldShowHint(model)&&external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.windowSizeHint",{defaultMessage:"Window must always be at least twice the size of your period"})},external_osdSharedDeps_React_default.a.createElement("input",{className:"tvbAgg__input",type:"text",onChange:handleNumberChange("window"),value:model.window})))),(model.model_type===MODEL_TYPES.WEIGHTED_EXPONENTIAL||model.model_type===MODEL_TYPES.WEIGHTED_EXPONENTIAL_DOUBLE||model.model_type===MODEL_TYPES.WEIGHTED_EXPONENTIAL_TRIPLE)&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_["Fragment"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("alpha"),label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.alpha",{defaultMessage:"Alpha"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{step:.1,onChange:handleNumberChange("alpha"),value:model.alpha}))),(model.model_type===MODEL_TYPES.WEIGHTED_EXPONENTIAL_DOUBLE||model.model_type===MODEL_TYPES.WEIGHTED_EXPONENTIAL_TRIPLE)&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("beta"),label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.beta",{defaultMessage:"Beta"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{step:.1,onChange:handleNumberChange("beta"),value:model.beta}))),model.model_type===MODEL_TYPES.WEIGHTED_EXPONENTIAL_TRIPLE&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_["Fragment"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("gamma"),label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.gamma",{defaultMessage:"Gamma"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{step:.1,onChange:handleNumberChange("gamma"),value:model.gamma}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("period"),label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.period",{defaultMessage:"Period"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{step:1,onChange:handleNumberChange("period"),value:model.period}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("multiplicative"),label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.multiplicative",{defaultMessage:"Multiplicative"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{placeholder:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.movingAverage.multiplicative.selectPlaceholder",{defaultMessage:"Select"}),options:multiplicativeOptions,selectedOptions:selectedMultiplicative?[selectedMultiplicative]:[],onChange:handleSelectChange("multiplicative"),singleSelection:{asPlainText:true}})))))))};const createTextHandler=handleChange=>(name,defaultValue)=>e=>{if(!detectIE()||e.keyCode===13)e.preventDefault();const value=external_osdSharedDeps_Lodash_default.a.get(e,"target.value",defaultValue);return handleChange===null||handleChange===void 0?void 0:handleChange({[name]:value})};const DerivativeAgg=props=>{const{siblings:siblings}=props;const defaults={unit:""};const model={...defaults,...props.model};const handleChange=createChangeHandler(props.onChange,model);const handleSelectChange=createSelectHandler(handleChange);const handleTextChange=createTextHandler(handleChange);const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.derivative.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type"),fullWidth:true})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("metric"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.derivative.metricLabel",defaultMessage:"Metric"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(MetricSelect,{onChange:handleSelectChange("field"),metrics:siblings,metric:model,value:model.field,fullWidth:true}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("units"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.derivative.unitsLabel",defaultMessage:"Units (1s, 1m, etc)",description:"1s and 1m are required values and must not be translated."}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("unit"),value:model.unit,fullWidth:true})))))};const newFn=()=>({id:uuid_default.a.v1()});function collection_actions_handleChange(props,doc){var _props$onChange;const{model:model,name:name}=props;const collection=model[name]||[];const part={};part[name]=collection.map(row=>{if(row.id===doc.id)return doc;return row});(_props$onChange=props.onChange)===null||_props$onChange===void 0?void 0:_props$onChange.call(props,{...model,...part})}function collection_actions_handleDelete(props,doc){var _props$onChange2;const{model:model,name:name}=props;const collection=model[name]||[];const part={};part[name]=collection.filter(row=>row.id!==doc.id);(_props$onChange2=props.onChange)===null||_props$onChange2===void 0?void 0:_props$onChange2.call(props,{...model,...part})}function collection_actions_handleAdd(props){var _props$onChange3;let fn=arguments.length>1&&arguments[1]!==undefined?arguments[1]:newFn;const{model:model,name:name}=props;const collection=model[name]||[];const part={};part[name]=collection.concat([fn()]);(_props$onChange3=props.onChange)===null||_props$onChange3===void 0?void 0:_props$onChange3.call(props,{...model,...part})}const collectionActions={handleAdd:collection_actions_handleAdd,handleDelete:collection_actions_handleDelete,handleChange:collection_actions_handleChange};const newVariable=opts=>({id:uuid_default.a.v1(),name:"",field:"",...opts});class vars_CalculationVars extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);this.renderRow=this.renderRow.bind(this)}handleChange(item,name){return e=>{const handleChange=collectionActions.handleChange.bind(null,this.props);const part={};part[name]=external_osdSharedDeps_Lodash_default.a.get(e,"[0].value",external_osdSharedDeps_Lodash_default.a.get(e,"target.value"));handleChange(external_osdSharedDeps_Lodash_default.a.assign({},item,part))}}renderRow(row,i,items){const handleAdd=collectionActions.handleAdd.bind(null,this.props,newVariable);const handleDelete=collectionActions.handleDelete.bind(null,this.props,row);return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{key:row.id,"data-test-subj":"varRow"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",responsive:false,gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{className:"tvbAggs__varName","aria-label":external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.vars.variableNameAriaLabel",{defaultMessage:"Variable name"}),placeholder:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.vars.variableNamePlaceholder",{defaultMessage:"Variable name"}),onChange:this.handleChange(row,"name"),value:row.name})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{className:"tvbAggs__varMetricWrapper"},external_osdSharedDeps_React_default.a.createElement(MetricSelect,{onChange:this.handleChange(row,"field"),metrics:this.props.metrics,metric:this.props.model,value:row.field,includeSiblings:this.props.includeSiblings})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(AddDeleteButtons,{onAdd:handleAdd,onDelete:handleDelete,disableDelete:items.length<2,responsive:false}))))}render(){const{model:model,name:name}=this.props;if(!model[name])return external_osdSharedDeps_React_default.a.createElement("div",null);const rows=model[name].map(this.renderRow);return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"s"},rows)}}vars_CalculationVars.defaultProps={name:"variables",includeSiblings:false};const checkModel=model=>Array.isArray(model.variables)&&model.script!==undefined;function CalculationAgg(props){const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const{siblings:siblings,model:model}=props;const handleChange=createChangeHandler(props.onChange,model);const handleSelectChange=createSelectHandler(handleChange);const handleTextChange=createTextHandler(handleChange);Object(external_osdSharedDeps_React_["useEffect"])(()=>{if(!checkModel(model)){handleChange({variables:[newVariable()],script:""})}},[handleChange,model]);return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"l"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.calculation.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("variables")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.calculation.variablesLabel",defaultMessage:"Variables"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(vars_CalculationVars,{id:htmlId("variables"),metrics:siblings,onChange:handleChange,name:"variables",model:model})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("painless"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.calculation.painlessScriptLabel",defaultMessage:"Painless Script"}),fullWidth:true,helpText:external_osdSharedDeps_React_default.a.createElement("div",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.calculation.painlessScriptDescription",defaultMessage:"Variables are keys on the {params} object, i.e. {paramsName}. To access the bucket interval (in milliseconds) use {paramsInterval}.",values:{params:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"params"),paramsName:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"params.<name>"),paramsInterval:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"params._interval")}}))},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTextArea"],{onChange:handleTextChange("script"),value:model.script,fullWidth:true})))))}function field_select_extends(){field_select_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return field_select_extends.apply(this,arguments)}const isFieldTypeEnabled=(fieldRestrictions,fieldType)=>fieldRestrictions.length?fieldRestrictions.includes(fieldType):true;function FieldSelectUi(_ref){let{type:type,fields:fields,indexPattern:indexPattern,value:value,onChange:onChange,disabled:disabled,restrict:restrict,placeholder:placeholder,uiRestrictions:uiRestrictions,...rest}=_ref;if(type==="count"){return null}const selectedOptions=[];const options=Object.values((fields[indexPattern]||[]).reduce((acc,field)=>{if(isFieldTypeEnabled(restrict,field.type)&&isFieldEnabled(field.name,type,uiRestrictions)){const item={label:field.name,value:field.name};if(acc[field.type]){acc[field.type].options.push(item)}else{acc[field.type]={options:[item],label:field.type}}if(value===item.value){selectedOptions.push(item)}}return acc},{}));if(onChange&&value&&!selectedOptions.length){onChange()}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],field_select_extends({placeholder:placeholder,isDisabled:disabled,options:options,selectedOptions:selectedOptions,onChange:onChange,singleSelection:{asPlainText:true}},rest))}FieldSelectUi.defaultProps={indexPattern:"*",disabled:false,restrict:[],placeholder:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.fieldSelect.selectFieldPlaceholder",{defaultMessage:"Select field..."})};const FieldSelect=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(FieldSelectUi);function getSupportedFieldsByMetricType(type){switch(type){case METRIC_TYPES.CARDINALITY:return Object.values(public_["OSD_FIELD_TYPES"]).filter(t=>t!==public_["OSD_FIELD_TYPES"].HISTOGRAM);case METRIC_TYPES.VALUE_COUNT:return Object.values(public_["OSD_FIELD_TYPES"]);case METRIC_TYPES.AVERAGE:case METRIC_TYPES.SUM:return[public_["OSD_FIELD_TYPES"].NUMBER,public_["OSD_FIELD_TYPES"].HISTOGRAM];default:return[public_["OSD_FIELD_TYPES"].NUMBER]}}function StandardAgg(props){const{model:model,panel:panel,series:series,fields:fields,uiRestrictions:uiRestrictions}=props;const handleChange=createChangeHandler(props.onChange,model);const handleSelectChange=createSelectHandler(handleChange);const restrictFields=getSupportedFieldsByMetricType(model.type);const indexPattern=series.override_index_pattern&&series.series_index_pattern||panel.index_pattern;const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdAgg.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,uiRestrictions:uiRestrictions,onChange:handleSelectChange("type"),fullWidth:true})),model.type!=="count"?external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdAgg.fieldLabel",defaultMessage:"Field"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(FieldSelect,{fields:fields,type:model.type,restrict:restrictFields,indexPattern:indexPattern,value:model.field,onChange:handleSelectChange("field"),uiRestrictions:uiRestrictions,fullWidth:true}))):null))}function percentile_ui_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const newPercentile=opts=>external_osdSharedDeps_Lodash_default.a.assign({id:uuid_default.a.v1(),mode:"line",shade:.2},opts);class percentile_ui_PercentilesUi extends external_osdSharedDeps_React_["Component"]{constructor(){super(...arguments);percentile_ui_defineProperty(this,"renderRow",(row,i,items)=>{const defaults={value:"",percentile:"",shade:""};const model={...defaults,...row};const{intl:intl,panel:panel}=this.props;const percentileFieldNumber=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{"aria-label":intl.formatMessage({id:"visTypeTimeseries.percentile.percentileAriaLabel",defaultMessage:"Percentile"}),placeholder:0,max:100,min:0,step:1,onChange:this.handleTextChange(model,"value"),value:model.value===""?"":Number(model.value)}));if(panel.type==="table"){return percentileFieldNumber}const handleAdd=collectionActions.handleAdd.bind(null,this.props,newPercentile);const handleDelete=collectionActions.handleDelete.bind(null,this.props,model);const modeOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.percentile.modeOptions.lineLabel",defaultMessage:"Line"}),value:"line"},{label:intl.formatMessage({id:"visTypeTimeseries.percentile.modeOptions.bandLabel",defaultMessage:"Band"}),value:"band"}];const optionsStyle={};if(model.mode==="line"){optionsStyle.display="none"}const labelStyle={marginBottom:0};const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])(model.id);const selectedModeOption=modeOptions.find(option=>model.mode===option.value);return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{key:model.id},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",responsive:false,gutterSize:"s"},percentileFieldNumber,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{style:labelStyle,htmlFor:htmlId("mode")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.percentile.modeLabel",defaultMessage:"Mode:"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,id:htmlId("mode"),options:modeOptions,selectedOptions:selectedModeOption?[selectedModeOption]:[],onChange:this.handleTextChange(model,"mode"),singleSelection:{asPlainText:true}})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{style:optionsStyle,grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{style:labelStyle,htmlFor:htmlId("fillTo")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.percentile.fillToLabel",defaultMessage:"Fill to:"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{style:optionsStyle,grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{id:htmlId("fillTo"),min:0,max:100,step:1,onChange:this.handleTextChange(model,"percentile"),value:Number(model.percentile)})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{style:optionsStyle,grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{style:labelStyle,htmlFor:htmlId("shade")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.percentile.shadeLabel",defaultMessage:"Shade (0 to 1):"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{style:optionsStyle,grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{id:htmlId("shade"),style:optionsStyle,step:.1,onChange:this.handleTextChange(model,"shade"),value:Number(model.shade)})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(AddDeleteButtons,{onAdd:handleAdd,onDelete:handleDelete,disableDelete:items.length<2,responsive:false}))))})}handleTextChange(item,name){return e=>{const handleChange=collectionActions.handleChange.bind(null,this.props);const part={};part[name]=external_osdSharedDeps_Lodash_default.a.get(e,"[0].value",external_osdSharedDeps_Lodash_default.a.get(e,"target.value"));handleChange(external_osdSharedDeps_Lodash_default.a.assign({},item,part))}}render(){const{model:model,name:name,panel:panel}=this.props;if(!model[name])return external_osdSharedDeps_React_default.a.createElement("div",null);let rows;if(panel.type==="table"){rows=this.renderRow(external_osdSharedDeps_Lodash_default.a.last(model[name]))}else{rows=model[name].map(this.renderRow)}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"s"},rows)}}percentile_ui_PercentilesUi.defaultProps={name:"percentile"};const Percentiles=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(percentile_ui_PercentilesUi);const RESTRICT_FIELDS=[public_["OSD_FIELD_TYPES"].NUMBER,public_["OSD_FIELD_TYPES"].HISTOGRAM];const percentile_checkModel=model=>Array.isArray(model.percentiles);function PercentileAgg(props){const{series:series,model:model,panel:panel,fields:fields}=props;const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const handleChange=createChangeHandler(props.onChange,model);const handleSelectChange=createSelectHandler(handleChange);const indexPattern=series.override_index_pattern&&series.series_index_pattern||panel.index_pattern;Object(external_osdSharedDeps_React_["useEffect"])(()=>{if(!percentile_checkModel(model)){handleChange({percentiles:[newPercentile({value:50})]})}},[handleChange,model]);return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.percentile.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.percentile.fieldLabel",defaultMessage:"Field"})},external_osdSharedDeps_React_default.a.createElement(FieldSelect,{fields:fields,type:model.type,restrict:RESTRICT_FIELDS,indexPattern:indexPattern,value:model.field,onChange:handleSelectChange("field")})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(Percentiles,{onChange:handleChange,name:"percentiles",model:model,panel:panel}))}function CumulativeSumAgg(props){const{model:model,siblings:siblings}=props;const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const handleChange=createChangeHandler(props.onChange,model);const handleSelectChange=createSelectHandler(handleChange);return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.cumulativeSum.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("metric"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.cumulativeSum.metricLabel",defaultMessage:"Metric"})},external_osdSharedDeps_React_default.a.createElement(MetricSelect,{onChange:handleSelectChange("field"),metrics:siblings,metric:model,value:model.field})))))}const std_deviation_RESTRICT_FIELDS=[public_["OSD_FIELD_TYPES"].NUMBER];const StandardDeviationAggUi=props=>{const{series:series,panel:panel,fields:fields,intl:intl}=props;const defaults={sigma:""};const model={...defaults,...props.model};const modeOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.stdDeviation.modeOptions.rawLabel",defaultMessage:"Raw"}),value:"raw"},{label:intl.formatMessage({id:"visTypeTimeseries.stdDeviation.modeOptions.upperBoundLabel",defaultMessage:"Upper Bound"}),value:"upper"},{label:intl.formatMessage({id:"visTypeTimeseries.stdDeviation.modeOptions.lowerBoundLabel",defaultMessage:"Lower Bound"}),value:"lower"}];if(panel.type!=="table"){modeOptions.push({label:intl.formatMessage({id:"visTypeTimeseries.stdDeviation.modeOptions.boundsBandLabel",defaultMessage:"Bounds Band"}),value:"band"})}const handleChange=createChangeHandler(props.onChange,model);const handleSelectChange=createSelectHandler(handleChange);const handleTextChange=createTextHandler(handleChange);const indexPattern=series.override_index_pattern&&series.series_index_pattern||panel.index_pattern;const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const selectedModeOption=modeOptions.find(option=>model.mode===option.value);return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdDeviation.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdDeviation.fieldLabel",defaultMessage:"Field"})},external_osdSharedDeps_React_default.a.createElement(FieldSelect,{fields:fields,type:model.type,restrict:std_deviation_RESTRICT_FIELDS,indexPattern:indexPattern,value:model.field,onChange:handleSelectChange("field")}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("sigma"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdDeviation.sigmaLabel",defaultMessage:"Sigma"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{value:model.sigma,onChange:handleTextChange("sigma")}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("mode"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdDeviation.modeLabel",defaultMessage:"Mode"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{options:modeOptions,selectedOptions:selectedModeOption?[selectedModeOption]:[],onChange:handleSelectChange("mode"),singleSelection:{asPlainText:true}})))))};const StandardDeviationAgg=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(StandardDeviationAggUi);const StandardSiblingAggUi=props=>{const{siblings:siblings,intl:intl}=props;const defaults={sigma:""};const model={...defaults,...props.model};const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const handleChange=createChangeHandler(props.onChange,model);const handleSelectChange=createSelectHandler(handleChange);const handleTextChange=createTextHandler(handleChange);const stdDev={};if(model.type==="std_deviation_bucket"){stdDev.sigma=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("sigma"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdSibling.sigmaLabel",defaultMessage:"Sigma"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{value:model.sigma,onChange:handleTextChange("sigma")})));const modeOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.stdSibling.modeOptions.rawLabel",defaultMessage:"Raw"}),value:"raw"},{label:intl.formatMessage({id:"visTypeTimeseries.stdSibling.modeOptions.upperBoundLabel",defaultMessage:"Upper Bound"}),value:"upper"},{label:intl.formatMessage({id:"visTypeTimeseries.stdSibling.modeOptions.lowerBoundLabel",defaultMessage:"Lower Bound"}),value:"lower"},{label:intl.formatMessage({id:"visTypeTimeseries.stdSibling.modeOptions.boundsBandLabel",defaultMessage:"Bounds Band"}),value:"band"}];const selectedModeOption=modeOptions.find(option=>model.mode===option.value);stdDev.mode=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("mode"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdSibling.modeLabel",defaultMessage:"Mode"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{options:modeOptions,selectedOptions:selectedModeOption?[selectedModeOption]:[],onChange:handleSelectChange("mode"),singleSelection:{asPlainText:true}})))}return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdSibling.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,uiRestrictions:props.uiRestrictions,onChange:handleSelectChange("type")})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("metric"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdSibling.metricLabel",defaultMessage:"Metric"})},external_osdSharedDeps_React_default.a.createElement(MetricSelect,{onChange:handleSelectChange("field"),exclude:["percentile"],metrics:siblings,metric:model,value:model.field}))),stdDev.sigma,stdDev.mode))};const StandardSiblingAgg=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(StandardSiblingAggUi);function SeriesAggUi(props){const{panel:panel,model:model,intl:intl}=props;const handleChange=createChangeHandler(props.onChange,model);const handleSelectChange=createSelectHandler(handleChange);const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const functionOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.sumLabel",defaultMessage:"Sum"}),value:"sum"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.maxLabel",defaultMessage:"Max"}),value:"max"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.minLabel",defaultMessage:"Min"}),value:"min"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.avgLabel",defaultMessage:"Avg"}),value:"mean"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.overallSumLabel",defaultMessage:"Overall Sum"}),value:"overall_sum"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.overallMaxLabel",defaultMessage:"Overall Max"}),value:"overall_max"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.overallMinLabel",defaultMessage:"Overall Min"}),value:"overall_min"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.overallAvgLabel",defaultMessage:"Overall Avg"}),value:"overall_avg"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.cumulativeSumLabel",defaultMessage:"Cumulative Sum"}),value:"cumulative_sum"}];const selectedFunctionOption=functionOptions.find(option=>model.function===option.value);if(panel.type==="table"){return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{className:"tvbAggRow__unavailable",size:"xxxs"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesAgg.seriesAggIsNotCompatibleLabel",defaultMessage:"Series Agg is not compatible with the table visualization."}))))}return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesAgg.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("function"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesAgg.functionLabel",defaultMessage:"Function"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{options:functionOptions,selectedOptions:selectedFunctionOption?[selectedFunctionOption]:[],onChange:handleSelectChange("function"),singleSelection:{asPlainText:true}})))))}const SeriesAgg=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(SeriesAggUi);const SerialDiffAgg=props=>{var _useOpenSearchDashboa;const{siblings:siblings}=props;const defaults={lag:""};const model={...defaults,...props.model};const handleChange=createChangeHandler(props.onChange,model);const handleSelectChange=createSelectHandler(handleChange);const handleNumberChange=createNumberHandler(handleChange);const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const serialDiffDoc=(_useOpenSearchDashboa=Object(opensearchDashboardsReact_public_["useOpenSearchDashboards"])().services.docLinks)===null||_useOpenSearchDashboa===void 0?void 0:_useOpenSearchDashboa.links.opensearch.aggregations.pipeline.serial_diff;return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.serialDiff.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("metric"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.serialDiff.metricLabel",defaultMessage:"Metric"})},external_osdSharedDeps_React_default.a.createElement(MetricSelect,{onChange:handleSelectChange("field"),metrics:siblings,metric:model,value:model.field}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("lag"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.serialDiff.lagLabel",defaultMessage:"Lag",description:"'Lag' refers to the parameter name of the serial diff translation\n                ".concat(serialDiffDoc,".\n                This should only be translated if there is a reasaonable word explaining what that parameter does.")})},external_osdSharedDeps_React_default.a.createElement("input",{className:"tvbAgg__input",onChange:handleNumberChange("lag"),value:model.lag,type:"text"})))))};const PositiveOnlyAgg=props=>{const{siblings:siblings}=props;const defaults={unit:""};const model={...defaults,...props.model};const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const handleChange=createChangeHandler(props.onChange,model);const handleSelectChange=createSelectHandler(handleChange);return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.positiveOnly.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("metric"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.positiveOnly.metricLabel",defaultMessage:"Metric"})},external_osdSharedDeps_React_default.a.createElement(MetricSelect,{onChange:handleSelectChange("field"),metrics:siblings,metric:model,value:model.field})))))};const CoreStartContext=external_osdSharedDeps_React_default.a.createContext(null);const CoreStartContextProvider=CoreStartContext.Provider;function query_bar_wrapper_extends(){query_bar_wrapper_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return query_bar_wrapper_extends.apply(this,arguments)}function QueryBarWrapper(props){const coreStartContext=Object(external_osdSharedDeps_React_["useContext"])(CoreStartContext);return external_osdSharedDeps_React_default.a.createElement(public_["QueryStringInput"],query_bar_wrapper_extends({},props,coreStartContext))}const isFieldHistogram=(fields,indexPattern,field)=>{const indexFields=fields[indexPattern];if(!indexFields)return false;const fieldObject=indexFields.find(f=>f.name===field);if(!fieldObject)return false;return fieldObject.type===public_["OSD_FIELD_TYPES"].HISTOGRAM};const FilterRatioAgg=props=>{const{series:series,fields:fields,panel:panel}=props;const handleChange=Object(external_osdSharedDeps_React_["useMemo"])(()=>createChangeHandler(props.onChange,props.model),[props.model,props.onChange]);const handleSelectChange=createSelectHandler(handleChange);const handleNumeratorQueryChange=Object(external_osdSharedDeps_React_["useCallback"])(query=>handleChange({numerator:query}),[handleChange]);const handleDenominatorQueryChange=Object(external_osdSharedDeps_React_["useCallback"])(query=>handleChange({denominator:query}),[handleChange]);const indexPattern=series.override_index_pattern&&series.series_index_pattern||panel.index_pattern;const defaults={numerator:Object(services["c"])().query.queryString.getDefaultQuery(),denominator:Object(services["c"])().query.queryString.getDefaultQuery(),metric_agg:"count"};const model={...defaults,...props.model};const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.filterRatio.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("numerator"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.filterRatio.numeratorLabel",defaultMessage:"Numerator"})},external_osdSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:model.numerator,onChange:handleNumeratorQueryChange,indexPatterns:[indexPattern]}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("denominator"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.filterRatio.denominatorLabel",defaultMessage:"Denominator"})},external_osdSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:model.denominator,onChange:handleDenominatorQueryChange,indexPatterns:[indexPattern]})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("metric")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.filterRatio.metricAggregationLabel",defaultMessage:"Metric Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("metric"),siblings:props.siblings,panelType:isFieldHistogram(fields,indexPattern,model.field)?"histogram":"filter_ratio",value:model.metric_agg,onChange:handleSelectChange("metric_agg")})),model.metric_agg!=="count"?external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("aggField"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.filterRatio.fieldLabel",defaultMessage:"Field"})},external_osdSharedDeps_React_default.a.createElement(FieldSelect,{fields:fields,type:model.metric_agg,restrict:getSupportedFieldsByMetricType(model.metric_agg),indexPattern:indexPattern,value:model.field,onChange:handleSelectChange("field")}))):null))};const MultiValueRow=_ref=>{let{model:model,onChange:onChange,onDelete:onDelete,onAdd:onAdd,disableAdd:disableAdd,disableDelete:disableDelete}=_ref;const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const onFieldNumberChange=event=>onChange({...model,value:Object(external_osdSharedDeps_Lodash_["get"])(event,"target.value")});return external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow__multiValueRow"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("value")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.multivalueRow.valueLabel",defaultMessage:"Value:"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{value:model.value===""?"":Number(model.value),placeholder:"0",onChange:onFieldNumberChange})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(AddDeleteButtons,{onAdd:onAdd,onDelete:()=>onDelete(model),disableDelete:disableDelete,disableAdd:disableAdd}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],null))};MultiValueRow.defaultProps={model:{id:null,value:""}};const PercentileRankValues=props=>{const model=props.model||[];const{onChange:onChange,disableAdd:disableAdd,disableDelete:disableDelete,showOnlyLastRow:showOnlyLastRow}=props;const onChangeValue=_ref=>{let{value:value,id:id}=_ref;model[id]=value;onChange(model)};const onDeleteValue=_ref2=>{let{id:id}=_ref2;return onChange(model.filter((item,currentIndex)=>id!==currentIndex))};const onAddValue=()=>onChange([...model,""]);const renderRow=_ref3=>{let{rowModel:rowModel,disableDeleteRow:disableDeleteRow,disableAddRow:disableAddRow}=_ref3;return external_osdSharedDeps_React_default.a.createElement(MultiValueRow,{key:"percentileRankValue__item".concat(rowModel.id),onAdd:onAddValue,onChange:onChangeValue,onDelete:onDeleteValue,disableDelete:disableDeleteRow,disableAdd:disableAddRow,model:rowModel})};return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",responsive:false,gutterSize:"xs"},showOnlyLastRow&&renderRow({rowModel:{id:model.length-1,value:Object(external_osdSharedDeps_Lodash_["last"])(model)||""},disableAddRow:true,disableDeleteRow:true}),!showOnlyLastRow&&model.map((value,id,array)=>renderRow({rowModel:{id:id,value:value||""},disableAddRow:disableAdd,disableDeleteRow:disableDelete||array.length<2})))};const percentile_rank_RESTRICT_FIELDS=[public_["OSD_FIELD_TYPES"].NUMBER,public_["OSD_FIELD_TYPES"].HISTOGRAM];const PercentileRankAgg=props=>{const{series:series,panel:panel,fields:fields}=props;const defaults={values:[""]};const model={...defaults,...props.model};const indexPattern=series.override_index_pattern&&series.series_index_pattern||panel.index_pattern;const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const isTablePanel=panel.type==="table";const handleChange=createChangeHandler(props.onChange,model);const handleSelectChange=createSelectHandler(handleChange);const handlePercentileRankValuesChange=values=>{handleChange({...model,values:values})};return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.percentileRank.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.percentileRank.fieldLabel",defaultMessage:"Field"})},external_osdSharedDeps_React_default.a.createElement(FieldSelect,{fields:fields,type:model.type,restrict:percentile_rank_RESTRICT_FIELDS,indexPattern:indexPattern,value:model.field,onChange:handleSelectChange("field")})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],null),model.values&&external_osdSharedDeps_React_default.a.createElement(PercentileRankValues,{disableAdd:isTablePanel,disableDelete:isTablePanel,showOnlyLastRow:isTablePanel,model:model.values,onChange:handlePercentileRankValuesChange}))};const Static=props=>{const handleChange=createChangeHandler(props.onChange,props.model);const handleSelectChange=createSelectHandler(handleChange);const handleTextChange=createTextHandler(handleChange);const defaults={numerator:"*",denominator:"*",metric_agg:"count",value:""};const model={...defaults,...props.model};const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.static.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("staticValue"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.static.staticValuesLabel",defaultMessage:"Static Value"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{onChange:handleTextChange("value"),value:model.value===""?"":Number(model.value),step:.1})))))};const math_checkModel=model=>Array.isArray(model.variables)&&model.script!==undefined;function MathAgg(props){const{siblings:siblings,model:model}=props;const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const handleChange=createChangeHandler(props.onChange,model);const handleSelectChange=createSelectHandler(handleChange);const handleTextChange=createTextHandler(handleChange);Object(external_osdSharedDeps_React_["useEffect"])(()=>{if(!math_checkModel(model)){handleChange({variables:[newVariable()],script:""})}},[handleChange,model]);return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"l"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.math.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("variables")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.math.variablesLabel",defaultMessage:"Variables"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(vars_CalculationVars,{id:htmlId("variables"),metrics:siblings,onChange:handleChange,name:"variables",model:model,includeSiblings:true})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:"mathExpressionInput",label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.math.expressionLabel",defaultMessage:"Expression"}),fullWidth:true,helpText:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.math.expressionDescription",defaultMessage:"This field uses basic math expressions (see {link}) - Variables are keys on the {params} object, i.e. {paramsName} To access all the data use {paramsValues} for an array of the values and {paramsTimestamps} for an array of the timestamps. {paramsTimestamp} is available for the current bucket's timestamp, {paramsIndex} is available for the current bucket's index, and {paramsInterval}s available for the interval in milliseconds.",values:{link:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiLink"],{href:"https://github.com/elastic/tinymath/blob/master/docs/functions.md",target:"_blank"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.math.expressionDescription.tinyMathLinkText",defaultMessage:"TinyMath"})),params:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"params"),paramsName:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"params.<name>"),paramsValues:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"params._all.<name>.values"),paramsTimestamps:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"params._all.<name>.timestamps"),paramsTimestamp:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"params._timestamp"),paramsIndex:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"params._index"),paramsInterval:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"params._interval")}})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTextArea"],{"data-test-subj":"mathExpression",onChange:handleTextChange("script"),fullWidth:true,value:model.script})))))}const top_hit_isFieldTypeEnabled=(fieldRestrictions,fieldType)=>fieldRestrictions.length?fieldRestrictions.includes(fieldType):true;const getAggWithOptions=function(){let field=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};let fieldTypesRestriction=arguments.length>1?arguments[1]:undefined;if(top_hit_isFieldTypeEnabled(fieldTypesRestriction,field.type)){switch(field.type){case public_["OSD_FIELD_TYPES"].NUMBER:return[{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.topHit.aggWithOptions.averageLabel",{defaultMessage:"Avg"}),value:"avg"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.topHit.aggWithOptions.maxLabel",{defaultMessage:"Max"}),value:"max"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.topHit.aggWithOptions.minLabel",{defaultMessage:"Min"}),value:"min"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.topHit.aggWithOptions.sumLabel",{defaultMessage:"Sum"}),value:"sum"}];case public_["OSD_FIELD_TYPES"].STRING:return[{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.topHit.aggWithOptions.concatenate",{defaultMessage:"Concatenate"}),value:"concat"}]}}return[]};const getOrderOptions=()=>[{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.topHit.orderOptions.ascLabel",{defaultMessage:"Asc"}),value:"asc"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.topHit.orderOptions.descLabel",{defaultMessage:"Desc"}),value:"desc"}];const ORDER_DATE_RESTRICT_FIELDS=[public_["OSD_FIELD_TYPES"].DATE];const TopHitAggUi=props=>{const{fields:fields,series:series,panel:panel}=props;const defaults={size:1,agg_with:"noop",order:"desc"};const model={...defaults,...props.model};const indexPattern=series.override_index_pattern&&series.series_index_pattern||panel.index_pattern;const aggWithOptionsRestrictFields=[panel_types["a"].TABLE,panel_types["a"].METRIC,panel_types["a"].MARKDOWN].includes(panel.type)?[public_["OSD_FIELD_TYPES"].NUMBER,public_["OSD_FIELD_TYPES"].STRING]:[public_["OSD_FIELD_TYPES"].NUMBER];const handleChange=createChangeHandler(props.onChange,model);const handleSelectChange=createSelectHandler(handleChange);const handleTextChange=createTextHandler(handleChange);const field=fields[indexPattern].find(f=>f.name===model.field);const aggWithOptions=getAggWithOptions(field,aggWithOptionsRestrictFields);const orderOptions=getOrderOptions();const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const selectedAggWithOption=aggWithOptions.find(option=>model.agg_with===option.value);const selectedOrderOption=orderOptions.find(option=>model.order===option.value);return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topHit.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topHit.fieldLabel",defaultMessage:"Field"})},external_osdSharedDeps_React_default.a.createElement(FieldSelect,{fields:fields,type:model.type,restrict:aggWithOptionsRestrictFields,indexPattern:indexPattern,value:model.field,onChange:handleSelectChange("field")})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("size"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topHit.sizeLabel",defaultMessage:"Size"})},external_osdSharedDeps_React_default.a.createElement("input",{className:"tvbAgg__input",value:model.size,onChange:handleTextChange("size")}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("agg_with"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topHit.aggregateWithLabel",defaultMessage:"Aggregate with"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,placeholder:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.topHit.aggregateWith.selectPlaceholder",{defaultMessage:"Select..."}),options:aggWithOptions,selectedOptions:selectedAggWithOption?[selectedAggWithOption]:[],onChange:handleSelectChange("agg_with"),singleSelection:{asPlainText:true}}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("order_by"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topHit.orderByLabel",defaultMessage:"Order by"})},external_osdSharedDeps_React_default.a.createElement(FieldSelect,{restrict:ORDER_DATE_RESTRICT_FIELDS,value:model.order_by,onChange:handleSelectChange("order_by"),indexPattern:indexPattern,fields:fields}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("order"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topHit.orderLabel",defaultMessage:"Order"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,placeholder:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.topHit.order.selectPlaceholder",{defaultMessage:"Select..."}),options:orderOptions,selectedOptions:selectedOrderOption?[selectedOrderOption]:[],onChange:handleSelectChange("order"),singleSelection:{asPlainText:true}})))))};const TopHitAgg=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(TopHitAggUi);const UNIT_OPTIONS=[{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.units.auto",{defaultMessage:"auto"}),value:""},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.units.perMillisecond",{defaultMessage:"per millisecond"}),value:"1ms"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.units.perSecond",{defaultMessage:"per second"}),value:"1s"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.units.perMinute",{defaultMessage:"per minute"}),value:"1m"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.units.perHour",{defaultMessage:"per hour"}),value:"1h"},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.units.perDay",{defaultMessage:"per day"}),value:"1d"}];const PositiveRateAgg=props=>{const defaults={unit:""};const model={...defaults,...props.model};const handleChange=createChangeHandler(props.onChange,model);const handleSelectChange=createSelectHandler(handleChange);const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const indexPattern=props.series.override_index_pattern&&props.series.series_index_pattern||props.panel.index_pattern;const selectedUnitOptions=UNIT_OPTIONS.filter(o=>o.value===model.unit);return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.positiveRate.aggregationLabel",defaultMessage:"Aggregation"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type"),fullWidth:true})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.postiveRate.fieldLabel",defaultMessage:"Field"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(FieldSelect,{fields:props.fields,type:model.type,restrict:[public_["OSD_FIELD_TYPES"].NUMBER],indexPattern:indexPattern,value:model.field,onChange:handleSelectChange("field"),uiRestrictions:props.uiRestrictions,fullWidth:true}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("units"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.positiveRate.unitsLabel",defaultMessage:"Scale"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{placeholder:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.positiveRate.unitSelectPlaceholder",{defaultMessage:"Select scale..."}),options:UNIT_OPTIONS,onChange:handleSelectChange("unit"),singleSelection:{asPlainText:true},selectedOptions:selectedUnitOptions})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_osdSharedDeps_React_default.a.createElement("p",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.positiveRate.helpText",defaultMessage:"This aggregation should only be applied to {link}, it is a shortcut for applying max, derivative and positive only to a field.",values:{link:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiLink"],{href:"https://en.wikipedia.org/wiki/Monotonic_function",target:"_BLANK"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.positiveRate.helpTextLink",defaultMessage:"monotonically increasing numbers"}))}}))))};const aggToComponent={count:StandardAgg,avg:StandardAgg,max:StandardAgg,min:StandardAgg,sum:StandardAgg,std_deviation:StandardDeviationAgg,sum_of_squares:StandardAgg,variance:StandardAgg,avg_bucket:StandardSiblingAgg,max_bucket:StandardSiblingAgg,min_bucket:StandardSiblingAgg,sum_bucket:StandardSiblingAgg,variance_bucket:StandardSiblingAgg,sum_of_squares_bucket:StandardSiblingAgg,std_deviation_bucket:StandardSiblingAgg,percentile:PercentileAgg,percentile_rank:PercentileRankAgg,cardinality:StandardAgg,value_count:StandardAgg,calculation:CalculationAgg,cumulative_sum:CumulativeSumAgg,moving_average:MovingAverageAgg,derivative:DerivativeAgg,series_agg:SeriesAgg,serial_diff:SerialDiffAgg,filter_ratio:FilterRatioAgg,positive_only:PositiveOnlyAgg,static:Static,math:MathAgg,top_hit:TopHitAgg,positive_rate:PositiveRateAgg};function UnsupportedAgg(props){return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{className:"tvbAggRow__unavailable",size:"xxxs"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.unsupportedAgg.aggIsNotSupportedDescription",defaultMessage:"The {modelType} aggregation is no longer supported.",values:{modelType:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,props.model.type)}}))))}function TemporaryUnsupportedAgg(props){return external_osdSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{className:"tvbAggRow__unavailable",size:"xxxs"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.unsupportedAgg.aggIsTemporaryUnsupportedDescription",defaultMessage:"The {modelType} aggregation is currently unsupported.",values:{modelType:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,props.model.type)}}))))}function Agg(props){const{model:model,uiRestrictions:uiRestrictions}=props;let Component=aggToComponent[model.type];if(!Component){Component=UnsupportedAgg}else if(!isMetricEnabled(model.type,uiRestrictions)){Component=TemporaryUnsupportedAgg}const style={cursor:"default",...props.style};return external_osdSharedDeps_React_default.a.createElement("div",{className:props.className,style:style},external_osdSharedDeps_React_default.a.createElement(Component,{fields:props.fields,disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onChange:props.onChange,onDelete:props.onDelete,panel:props.panel,series:props.series,siblings:props.siblings,uiRestrictions:props.uiRestrictions,dragHandleProps:props.dragHandleProps}))}const newMetricAggFn=()=>({id:uuid_default.a.v1(),type:"count"});const seriesChangeHandler=(props,items)=>doc=>{if(items.length===1&&!isBasicAgg(doc)){collection_actions_handleAdd.call(null,props,()=>{const metric=newMetricAggFn();metric.type=doc.type;const incompatPipelines=["calculation","series_agg"];if(!external_osdSharedDeps_Lodash_default.a.includes(incompatPipelines,doc.type))metric.field=doc.id;return metric})}else{collection_actions_handleChange.call(null,props,doc)}};const DROPPABLE_ID="aggs_dnd";class aggs_Aggs extends external_osdSharedDeps_React_["PureComponent"]{render(){const{panel:panel,model:model,fields:fields,uiRestrictions:uiRestrictions}=this.props;const list=model.metrics;const onChange=seriesChangeHandler(this.props,list);return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiDroppable"],{droppableId:"".concat(DROPPABLE_ID,":").concat(model.id),type:"MICRO",spacing:"s"},list.map((row,idx)=>external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiDraggable"],{spacing:"s",key:row.id,index:idx,customDragHandle:true,draggableId:"".concat(DROPPABLE_ID,":").concat(model.id,":").concat(row.id)},provided=>external_osdSharedDeps_React_default.a.createElement(Agg,{key:row.id,disableDelete:list.length<2,fields:fields,model:row,onAdd:()=>collection_actions_handleAdd(this.props,newMetricAggFn),onChange:onChange,onDelete:()=>collection_actions_handleDelete(this.props,row),panel:panel,series:model,siblings:list,uiRestrictions:uiRestrictions,dragHandleProps:provided.dragHandleProps}))))}}function data_format_picker_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const DEFAULT_OUTPUT_PRECISION="2";class data_format_picker_DataFormatPickerUI extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);data_format_picker_defineProperty(this,"handleCustomChange",()=>{this.props.onChange([{value:this.custom&&this.custom.value||""}])});data_format_picker_defineProperty(this,"handleChange",selectedOptions=>{if(selectedOptions.length<1){return}if(selectedOptions[0].value==="custom"){this.handleCustomChange()}else if(selectedOptions[0].value==="duration"){const{from:from,to:to,decimals:decimals}=this.state;this.props.onChange([{value:"".concat(from,",").concat(to,",").concat(decimals)}])}else{this.props.onChange(selectedOptions)}});let _from;let _to;let _decimals;if(isDuration(props.value)){[_from,_to,_decimals]=props.value.split(",")}this.state={from:_from||"ms",to:_to||"ms",decimals:_decimals||""}}handleDurationChange(name){return selectedOptions=>{if(selectedOptions.length<1){return}let newValue;if(name==="decimals"){newValue=this.decimals.value}else{newValue=selectedOptions[0].value}this.setState({[name]:newValue},()=>{const{from:from,to:to,decimals:decimals}=this.state;this.props.onChange([{value:"".concat(from,",").concat(to,",").concat(decimals)}])})}}render(){const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const value=this.props.value||"";let defaultValue=value;if(!external_osdSharedDeps_Lodash_default.a.includes(["bytes","number","percent"],value)){defaultValue="custom"}if(isDuration(value)){defaultValue="duration"}const{intl:intl}=this.props;const options=[{label:intl.formatMessage({id:"visTypeTimeseries.dataFormatPicker.bytesLabel",defaultMessage:"Bytes"}),value:"bytes"},{label:intl.formatMessage({id:"visTypeTimeseries.dataFormatPicker.numberLabel",defaultMessage:"Number"}),value:"number"},{label:intl.formatMessage({id:"visTypeTimeseries.dataFormatPicker.percentLabel",defaultMessage:"Percent"}),value:"percent"},{label:intl.formatMessage({id:"visTypeTimeseries.dataFormatPicker.durationLabel",defaultMessage:"Duration"}),value:"duration"},{label:intl.formatMessage({id:"visTypeTimeseries.dataFormatPicker.customLabel",defaultMessage:"Custom"}),value:"custom"}];const selectedOption=options.find(option=>defaultValue===option.value);let custom;if(defaultValue==="duration"){const[from,to,decimals]=value.split(",");const selectedFrom=durationInputOptions.find(option=>from===option.value);const selectedTo=durationOutputOptions.find(option=>to===option.value);return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("date"),label:this.props.label},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:options,selectedOptions:selectedOption?[selectedOption]:[],onChange:this.handleChange,singleSelection:{asPlainText:true}}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("from"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.dataFormatPicker.fromLabel",defaultMessage:"From"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:durationInputOptions,selectedOptions:selectedFrom?[selectedFrom]:[],onChange:this.handleDurationChange("from"),singleSelection:{asPlainText:true}}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("to"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.dataFormatPicker.toLabel",defaultMessage:"To"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:durationOutputOptions,selectedOptions:selectedTo?[selectedTo]:[],onChange:this.handleDurationChange("to"),singleSelection:{asPlainText:true}}))),selectedTo&&selectedTo.value!=="humanize"&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("decimal"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.dataFormatPicker.decimalPlacesLabel",defaultMessage:"Decimal places"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{defaultValue:decimals,inputRef:el=>this.decimals=el,placeholder:DEFAULT_OUTPUT_PRECISION,onChange:this.handleDurationChange("decimals")}))))}if(defaultValue==="custom"){custom=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.dataFormatPicker.formatStringLabel",defaultMessage:"Format string"}),helpText:external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.dataFormatPicker.formatStringHelpText",defaultMessage:"See {numeralJsLink}",values:{numeralJsLink:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiLink"],{href:"http://numeraljs.com/#format",target:"_BLANK"},"Numeral.js")}}))},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{defaultValue:value,inputRef:el=>this.custom=el,onChange:this.handleCustomChange})))}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{label:this.props.label},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:options,selectedOptions:selectedOption?[selectedOption]:[],onChange:this.handleChange,singleSelection:{asPlainText:true},"data-test-subj":"tsvbDataFormatPicker"}))),custom)}}data_format_picker_DataFormatPickerUI.defaultProps={label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.defaultDataFormatterLabel",{defaultMessage:"Data Formatter"})};const DataFormatPicker=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(data_format_picker_DataFormatPickerUI);function YesNo(props){const{name:name,value:value,disabled:disabled,"data-test-subj":dataTestSubj}=props;const handleChange=value=>{const{name:name}=props;return()=>{const parts={[name]:value};props.onChange(parts)}};const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const inputName=name+external_osdSharedDeps_Lodash_default.a.uniqueId();return external_osdSharedDeps_React_default.a.createElement("div",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiRadio"],{id:htmlId("yes"),"data-test-subj":"".concat(dataTestSubj,"-yes"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.yesButtonLabel",defaultMessage:"Yes",description:"The 'yes' in a yes/no answer choice."}),className:"eui-displayInlineBlock",name:inputName,checked:Boolean(value),value:"yes",onChange:handleChange(1),disabled:disabled})," ",external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiRadio"],{id:htmlId("no"),"data-test-subj":"".concat(dataTestSubj,"-no"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.noButtonLabel",defaultMessage:"No",description:"The 'no' in a yes/no answer choice."}),className:"eui-displayInlineBlock",name:inputName,checked:!Boolean(value),value:"no",onChange:handleChange(0),disabled:disabled}))}YesNo.defaultProps={disabled:false};const FormValidationContext=external_osdSharedDeps_React_default.a.createContext({});const TIME_RANGE_DATA_MODES={ENTIRE_TIME_RANGE:"entire_time_range",LAST_VALUE:"last_value"};const TIME_RANGE_MODE_KEY="time_range_mode";const VisDataContext=external_osdSharedDeps_React_default.a.createContext({});const index_pattern_RESTRICT_FIELDS=[public_["OSD_FIELD_TYPES"].DATE];const validateIntervalValue=intervalValue=>{const isAutoOrGteInterval=isGteInterval(intervalValue)||isAutoInterval(intervalValue);if(isAutoOrGteInterval){return{isValid:true}}return validateReInterval(intervalValue)};const index_pattern_htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const isEntireTimeRangeActive=(model,isTimeSeries)=>!isTimeSeries&&model[TIME_RANGE_MODE_KEY]===TIME_RANGE_DATA_MODES.ENTIRE_TIME_RANGE;const IndexPattern=_ref=>{let{fields:fields,prefix:prefix,onChange:onChange,disabled:disabled,model:_model}=_ref;const handleSelectChange=createSelectHandler(onChange);const handleTextChange=createTextHandler(onChange);const timeFieldName="".concat(prefix,"time_field");const indexPatternName="".concat(prefix,"index_pattern");const intervalName="".concat(prefix,"interval");const dropBucketName="".concat(prefix,"drop_last_bucket");const updateControlValidity=Object(external_osdSharedDeps_React_["useContext"])(FormValidationContext);const uiRestrictions=Object(external_osdSharedDeps_Lodash_["get"])(Object(external_osdSharedDeps_React_["useContext"])(VisDataContext),"uiRestrictions");const timeRangeOptions=[{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.indexPattern.timeRange.lastValue",{defaultMessage:"Last value"}),value:TIME_RANGE_DATA_MODES.LAST_VALUE,disabled:!isTimerangeModeEnabled(TIME_RANGE_DATA_MODES.LAST_VALUE,uiRestrictions)},{label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.indexPattern.timeRange.entireTimeRange",{defaultMessage:"Entire time range"}),value:TIME_RANGE_DATA_MODES.ENTIRE_TIME_RANGE,disabled:!isTimerangeModeEnabled(TIME_RANGE_DATA_MODES.ENTIRE_TIME_RANGE,uiRestrictions)}];const defaults={default_index_pattern:"",[indexPatternName]:"*",[intervalName]:AUTO_INTERVAL,[dropBucketName]:1,[TIME_RANGE_MODE_KEY]:timeRangeOptions[0].value};const model={...defaults,..._model};const isDefaultIndexPatternUsed=model.default_index_pattern&&!model[indexPatternName];const intervalValidation=validateIntervalValue(model[intervalName]);const selectedTimeRangeOption=timeRangeOptions.find(_ref2=>{let{value:value}=_ref2;return model[TIME_RANGE_MODE_KEY]===value});const isTimeSeries=model.type===panel_types["a"].TIMESERIES;updateControlValidity(intervalName,intervalValidation.isValid);return external_osdSharedDeps_React_default.a.createElement("div",{className:"index-pattern"},!isTimeSeries&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:index_pattern_htmlId("timeRange"),label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.indexPattern.timeRange.label",{defaultMessage:"Data timerange mode"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,placeholder:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.indexPattern.timeRange.selectTimeRange",{defaultMessage:"Select"}),options:timeRangeOptions,selectedOptions:selectedTimeRangeOption?[selectedTimeRangeOption]:[],onChange:handleSelectChange(TIME_RANGE_MODE_KEY),singleSelection:{asPlainText:true},isDisabled:disabled})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],{size:"xs",style:{margin:0}},external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.indexPattern.timeRange.hint",{defaultMessage:'This setting controls the timespan used for matching documents.\n                "Entire timerange" will match all the documents selected in the timepicker.\n                "Last value" will match only the documents for the specified interval from the end of the timerange.'})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:index_pattern_htmlId("indexPattern"),label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.indexPatternLabel",{defaultMessage:"Index pattern"}),helpText:isDefaultIndexPatternUsed&&external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.indexPattern.searchByDefaultIndex",{defaultMessage:"Default index pattern is used. To query all indexes use *"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":"metricsIndexPatternInput",disabled:disabled,placeholder:model.default_index_pattern,onChange:handleTextChange(indexPatternName,"*"),value:model[indexPatternName]}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:index_pattern_htmlId("timeField"),label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.indexPattern.timeFieldLabel",{defaultMessage:"Time field"})},external_osdSharedDeps_React_default.a.createElement(FieldSelect,{"data-test-subj":"metricsIndexPatternFieldsSelect",restrict:index_pattern_RESTRICT_FIELDS,value:model[timeFieldName],disabled:disabled,onChange:handleSelectChange(timeFieldName),indexPattern:model[indexPatternName],fields:fields,placeholder:isDefaultIndexPatternUsed?model.default_timefield:undefined}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{isInvalid:!intervalValidation.isValid,error:intervalValidation.errorMessage,id:index_pattern_htmlId("interval"),label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.indexPattern.intervalLabel",{defaultMessage:"Interval"}),helpText:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.indexPattern.intervalHelpText",{defaultMessage:"Examples: auto, 1m, 1d, 7d, 1y, >=1m",description:"auto, 1m, 1d, 7d, 1y, >=1m are required values and must not be translated."})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":"metricsIndexPatternInterval",isInvalid:!intervalValidation.isValid,disabled:disabled||isEntireTimeRangeActive(model,isTimeSeries),onChange:handleTextChange(intervalName,AUTO_INTERVAL),value:model[intervalName],placeholder:AUTO_INTERVAL}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:index_pattern_htmlId("dropLastBucket"),label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.indexPattern.dropLastBucketLabel",{defaultMessage:"Drop last bucket?"})},external_osdSharedDeps_React_default.a.createElement(YesNo,{"data-test-subj":"metricsDropLastBucket",value:model[dropBucketName],name:dropBucketName,onChange:onChange,disabled:disabled||isEntireTimeRangeActive(model,isTimeSeries)})))))};IndexPattern.defaultProps={prefix:"",disabled:false};function getDefaultQueryLanguage(){return Object(services["g"])().get(public_["UI_SETTINGS"].SEARCH_QUERY_LANGUAGE)}const isPercentDisabled=seriesQuantity=>seriesQuantity<2;function config_extends(){config_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return config_extends.apply(this,arguments)}const TimeseriesConfig=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])((function(props){const handleSelectChange=createSelectHandler(props.onChange);const handleTextChange=createTextHandler(props.onChange);const defaults={fill:"",line_width:"",point_size:"",value_template:"{{value}}",offset_time:"",split_color_mode:"opensearchDashboards",axis_min:"",axis_max:"",stacked:STACKED_OPTIONS.NONE,steps:0};const model={...defaults,...props.model};const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const{intl:intl}=props;const stackedOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.noneLabel",defaultMessage:"None"}),value:STACKED_OPTIONS.NONE},{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.stackedLabel",defaultMessage:"Stacked"}),value:STACKED_OPTIONS.STACKED},{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.stackedWithinSeriesLabel",defaultMessage:"Stacked within series"}),value:STACKED_OPTIONS.STACKED_WITHIN_SERIES},{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.percentLabel",defaultMessage:"Percent"}),value:STACKED_OPTIONS.PERCENT,disabled:isPercentDisabled(props.seriesQuantity[model.id])}];const selectedStackedOption=stackedOptions.find(option=>model.stacked===option.value);const positionOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.rightLabel",defaultMessage:"Right"}),value:"right"},{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.leftLabel",defaultMessage:"Left"}),value:"left"}];const selectedAxisPosOption=positionOptions.find(option=>model.axis_position===option.value);const chartTypeOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.barLabel",defaultMessage:"Bar"}),value:"bar"},{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.lineLabel",defaultMessage:"Line"}),value:"line"}];const selectedChartTypeOption=chartTypeOptions.find(option=>model.chart_type===option.value);const splitColorOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.defaultPaletteLabel",defaultMessage:"Default palette"}),value:"opensearchDashboards"},{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.rainbowLabel",defaultMessage:"Rainbow"}),value:"rainbow"},{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.gradientLabel",defaultMessage:"Gradient"}),value:"gradient"}];const selectedSplitColorOption=splitColorOptions.find(option=>model.split_color_mode===option.value);let type;if(model.chart_type==="line"){type=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("chartType"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartLine.chartTypeLabel",defaultMessage:"Chart type"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:chartTypeOptions,selectedOptions:selectedChartTypeOption?[selectedChartTypeOption]:[],onChange:handleSelectChange("chart_type"),singleSelection:{asPlainText:true}}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("stacked"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartLine.stackedLabel",defaultMessage:"Stacked"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:stackedOptions,selectedOptions:selectedStackedOption?[selectedStackedOption]:[],onChange:handleSelectChange("stacked"),singleSelection:{asPlainText:true}}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("fill"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartLine.fillLabel",defaultMessage:"Fill (0 to 1)"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{step:.1,onChange:handleTextChange("fill"),value:Number(model.fill)}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("lineWidth"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartLine.lineWidthLabel",defaultMessage:"Line width"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{onChange:handleTextChange("line_width"),value:Number(model.line_width)}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("pointSize"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartLine.pointSizeLabel",defaultMessage:"Point size"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{onChange:handleTextChange("point_size"),value:Number(model.point_size)}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartLine.stepsLabel",defaultMessage:"Steps"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.steps,name:"steps",onChange:props.onChange})))}if(model.chart_type==="bar"){type=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("chartType"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartBar.chartTypeLabel",defaultMessage:"Chart type"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:chartTypeOptions,selectedOptions:selectedChartTypeOption?[selectedChartTypeOption]:[],onChange:handleSelectChange("chart_type"),singleSelection:{asPlainText:true}}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("stacked"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartBar.stackedLabel",defaultMessage:"Stacked"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:stackedOptions,selectedOptions:selectedStackedOption?[selectedStackedOption]:[],onChange:handleSelectChange("stacked"),singleSelection:{asPlainText:true}}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("fill"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartBar.fillLabel",defaultMessage:"Fill (0 to 1)"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{step:.1,onChange:handleTextChange("fill"),value:Number(model.fill)}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("lineWidth"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartBar.lineWidthLabel",defaultMessage:"Line width"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{onChange:handleTextChange("line_width"),value:Number(model.line_width)}))))}const disableSeparateYaxis=model.separate_axis?false:true;const seriesIndexPattern=props.model.override_index_pattern&&props.model.series_index_pattern?props.model.series_index_pattern:props.indexPatternForQuery;return external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(DataFormatPicker,{onChange:handleSelectChange("formatter"),value:model.formatter})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("template"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.templateLabel",defaultMessage:"Template"}),helpText:external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.templateHelpText",defaultMessage:"eg.{templateExample}",values:{templateExample:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"{{value}}/s")}})),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("value_template"),value:model.value_template,fullWidth:true,"data-test-subj":"tsvb_series_value"})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("series_filter"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.filterLabel",defaultMessage:"Filter"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter&&model.filter.language?model.filter.language:getDefaultQueryLanguage(),query:model.filter&&model.filter.query?model.filter.query:""},onChange:filter=>props.onChange({filter:filter}),indexPatterns:[seriesIndexPattern]}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),type,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("offset"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.offsetSeriesTimeLabel",defaultMessage:"Offset series time by (1m, 1h, 1w, 1d)",description:"1m, 1h, 1w, 1d are required values and must not be translated."})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":"offsetTimeSeries",onChange:handleTextChange("offset_time"),value:model.offset_time}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.hideInLegendLabel",defaultMessage:"Hide in legend"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.hide_in_legend,name:"hide_in_legend",onChange:props.onChange})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("splitColor"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.splitColorThemeLabel",defaultMessage:"Split color theme"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:splitColorOptions,selectedOptions:selectedSplitColorOption?[selectedSplitColorOption]:[],onChange:handleSelectChange("split_color_mode"),singleSelection:{asPlainText:true}})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.separateAxisLabel",defaultMessage:"Separate axis?"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.separate_axis,name:"separate_axis",onChange:props.onChange})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("axisMin"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.axisMinLabel",defaultMessage:"Axis min"})},external_osdSharedDeps_React_default.a.createElement("input",{className:"tvbAgg__input",type:"number",disabled:disableSeparateYaxis,onChange:handleTextChange("axis_min"),value:model.axis_min}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("axisMax"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.axisMaxLabel",defaultMessage:"Axis max"})},external_osdSharedDeps_React_default.a.createElement("input",{className:"tvbAgg__input",disabled:disableSeparateYaxis,onChange:handleTextChange("axis_max"),value:model.axis_max}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("axisPos"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.axisPositionLabel",defaultMessage:"Axis position"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,isDisabled:disableSeparateYaxis,options:positionOptions,selectedOptions:selectedAxisPosOption?[selectedAxisPosOption]:[],onChange:handleSelectChange("axis_position"),singleSelection:{asPlainText:true}})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.overrideIndexPatternLabel",defaultMessage:"Override Index Pattern?"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.override_index_pattern,name:"override_index_pattern",onChange:props.onChange})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(IndexPattern,config_extends({},props,{prefix:"series_",disabled:!model.override_index_pattern,"with-interval":true})))))}));function GroupBySelectUi(props){const{intl:intl,uiRestrictions:uiRestrictions}=props;const modeOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.splits.groupBySelect.modeOptions.everythingLabel",defaultMessage:"Everything"}),value:"everything"},{label:intl.formatMessage({id:"visTypeTimeseries.splits.groupBySelect.modeOptions.filterLabel",defaultMessage:"Filter"}),value:"filter"},{label:intl.formatMessage({id:"visTypeTimeseries.splits.groupBySelect.modeOptions.filtersLabel",defaultMessage:"Filters"}),value:"filters"},{label:intl.formatMessage({id:"visTypeTimeseries.splits.groupBySelect.modeOptions.termsLabel",defaultMessage:"Terms"}),value:"terms"}].map(field=>({...field,disabled:!isGroupByFieldsEnabled(field.value,uiRestrictions)}));const selectedValue=props.value||"everything";const selectedOption=modeOptions.find(option=>selectedValue===option.value);return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{id:props.id,isClearable:false,options:modeOptions,selectedOptions:[selectedOption],onChange:props.onChange,singleSelection:{asPlainText:true}})}const GroupBySelect=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(GroupBySelectUi);const FIELD_TYPES={BOOLEAN:"boolean",DATE:"date",GEO:"geo_point",NUMBER:"number",STRING:"string"};const terms_DEFAULTS={terms_direction:"desc",terms_size:10,terms_order_by:"_count"};const SplitByTermsUI=_ref=>{let{onChange:onChange,indexPattern:indexPattern,intl:intl,model:seriesModel,fields:fields,uiRestrictions:uiRestrictions,seriesQuantity:seriesQuantity}=_ref;const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const handleTextChange=createTextHandler(onChange);const handleSelectChange=createSelectHandler(onChange);const model={...terms_DEFAULTS,...seriesModel};const{metrics:metrics}=model;const defaultCount={value:"_count",label:intl.formatMessage({id:"visTypeTimeseries.splits.terms.defaultCountLabel",defaultMessage:"Doc Count (default)"})};const terms={value:"_key",label:intl.formatMessage({id:"visTypeTimeseries.splits.terms.termsLabel",defaultMessage:"Terms"})};const dirOptions=[{value:"desc",label:intl.formatMessage({id:"visTypeTimeseries.splits.terms.dirOptions.descendingLabel",defaultMessage:"Descending"})},{value:"asc",label:intl.formatMessage({id:"visTypeTimeseries.splits.terms.dirOptions.ascendingLabel",defaultMessage:"Ascending"})}];const selectedDirectionOption=dirOptions.find(option=>model.terms_direction===option.value);const selectedField=Object(external_osdSharedDeps_Lodash_["find"])(fields[indexPattern],_ref2=>{let{name:name}=_ref2;return name===model.terms_field});const selectedFieldType=Object(external_osdSharedDeps_Lodash_["get"])(selectedField,"type");if(seriesQuantity&&model.stacked===STACKED_OPTIONS.PERCENT&&isPercentDisabled(seriesQuantity[model.id])){onChange({["stacked"]:STACKED_OPTIONS.NONE})}return external_osdSharedDeps_React_default.a.createElement("div",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("group"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.terms.groupByLabel",defaultMessage:"Group by"})},external_osdSharedDeps_React_default.a.createElement(GroupBySelect,{value:model.split_mode,onChange:handleSelectChange("split_mode"),uiRestrictions:uiRestrictions}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("by"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.terms.byLabel",defaultMessage:"By",description:"This labels a field selector allowing the user to chose 'by' which field to group."})},external_osdSharedDeps_React_default.a.createElement(FieldSelect,{"data-test-subj":"groupByField",indexPattern:indexPattern,onChange:handleSelectChange("terms_field"),value:model.terms_field,fields:fields,uiRestrictions:uiRestrictions,type:"terms"})))),selectedFieldType===FIELD_TYPES.STRING&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("include"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.terms.includeLabel",defaultMessage:"Include"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{value:model.terms_include,onChange:handleTextChange("terms_include")}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("exclude"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.terms.excludeLabel",defaultMessage:"Exclude"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{value:model.terms_exclude,onChange:handleTextChange("terms_exclude")})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("top"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.terms.topLabel",defaultMessage:"Top"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{placeholder:intl.formatMessage({id:"visTypeTimeseries.splits.terms.sizePlaceholder",defaultMessage:"Size"}),value:Number(model.terms_size),onChange:handleTextChange("terms_size")}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("order"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.terms.orderByLabel",defaultMessage:"Order by"})},external_osdSharedDeps_React_default.a.createElement(MetricSelect,{metrics:metrics,clearable:false,additionalOptions:[defaultCount,terms],onChange:handleSelectChange("terms_order_by"),restrict:"basic",value:model.terms_order_by}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("direction"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.terms.directionLabel",defaultMessage:"Direction"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:dirOptions,selectedOptions:selectedDirectionOption?[selectedDirectionOption]:[],onChange:handleSelectChange("terms_direction"),singleSelection:{asPlainText:true}})))))};const SplitByTerms=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(SplitByTermsUI);const SplitByFilter=props=>{const{onChange:onChange,uiRestrictions:uiRestrictions,indexPattern:indexPattern}=props;const defaults={filter:{language:getDefaultQueryLanguage(),query:""}};const model={...defaults,...props.model};const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const handleSelectChange=createSelectHandler(onChange);return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("group"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.filter.groupByLabel",defaultMessage:"Group by"})},external_osdSharedDeps_React_default.a.createElement(GroupBySelect,{value:model.split_mode,onChange:handleSelectChange("split_mode"),uiRestrictions:uiRestrictions}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("query"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.filter.queryStringLabel",defaultMessage:"Query string"})},external_osdSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language||getDefaultQueryLanguage(),query:model.filter.query||""},onChange:filter=>onChange({filter:filter}),indexPatterns:[indexPattern]}))))};function filter_items_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class filter_items_FilterItemsUi extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);filter_items_defineProperty(this,"handleQueryChange",(model,filter)=>{const part={filter:filter};collectionActions.handleChange(this.props,external_osdSharedDeps_Lodash_default.a.assign({},model,part))});this.renderRow=this.renderRow.bind(this)}handleChange(item,name){return e=>{const handleChange=collectionActions.handleChange.bind(null,this.props);handleChange(external_osdSharedDeps_Lodash_default.a.assign({},item,{[name]:external_osdSharedDeps_Lodash_default.a.get(e,"value",external_osdSharedDeps_Lodash_default.a.get(e,"target.value"))}))}}renderRow(row,i,items){const indexPatterns=this.props.indexPatterns;const defaults={filter:"",label:""};const model={...defaults,...row};const handleChange=part=>{const fn=collectionActions.handleChange.bind(null,this.props);fn(external_osdSharedDeps_Lodash_default.a.assign({},model,part))};const newFilter=()=>({color:this.props.model.color,id:uuid_default.a.v1(),filter:{language:model.filter.language||getDefaultQueryLanguage(),query:""}});const handleAdd=collectionActions.handleAdd.bind(null,this.props,newFilter);const handleDelete=collectionActions.handleDelete.bind(null,this.props,model);const{intl:intl}=this.props;return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",className:"tvbAggRow",alignItems:"center",key:model.id},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(ColorPicker,{disableTrash:true,onChange:handleChange,name:"color",value:model.color})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language||getDefaultQueryLanguage(),query:model.filter.query||""},onChange:query=>this.handleQueryChange(model,query),indexPatterns:[indexPatterns]})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{placeholder:intl.formatMessage({id:"visTypeTimeseries.splits.filterItems.labelPlaceholder",defaultMessage:"Label"}),"aria-label":intl.formatMessage({id:"visTypeTimeseries.splits.filterItems.labelAriaLabel",defaultMessage:"Label"}),onChange:this.handleChange(model,"label"),value:model.label,fullWidth:true})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(AddDeleteButtons,{onAdd:handleAdd,onDelete:handleDelete,disableDelete:items.length<2,responsive:false})))}render(){const{model:model,name:name}=this.props;if(!model[name])return external_osdSharedDeps_React_default.a.createElement("div",null);const rows=model[name].map(this.renderRow);return external_osdSharedDeps_React_default.a.createElement("div",null,rows)}}const FilterItems=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(filter_items_FilterItemsUi);const SplitByFilters=props=>{const{onChange:onChange,model:model,uiRestrictions:uiRestrictions,indexPattern:indexPattern}=props;const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const handleSelectChange=createSelectHandler(onChange);return external_osdSharedDeps_React_default.a.createElement("div",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("group"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.filters.groupByLabel",defaultMessage:"Group by"})},external_osdSharedDeps_React_default.a.createElement(GroupBySelect,{value:model.split_mode,onChange:handleSelectChange("split_mode"),uiRestrictions:uiRestrictions})))),external_osdSharedDeps_React_default.a.createElement(FilterItems,{name:"split_filters",model:model,onChange:onChange,indexPatterns:indexPattern}))};const SplitByEverything=props=>{const{onChange:onChange,model:model,uiRestrictions:uiRestrictions}=props;const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const handleSelectChange=createSelectHandler(onChange);return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("group"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.everything.groupByLabel",defaultMessage:"Group by"})},external_osdSharedDeps_React_default.a.createElement(GroupBySelect,{value:model.split_mode,onChange:handleSelectChange("split_mode"),uiRestrictions:uiRestrictions}))))};const SplitUnsupported=props=>{const{onChange:onChange,model:model,uiRestrictions:uiRestrictions}=props;const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const handleSelectChange=createSelectHandler(onChange);return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("group"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.everything.groupByLabel",defaultMessage:"Group by"})},external_osdSharedDeps_React_default.a.createElement(GroupBySelect,{value:model.split_mode,onChange:handleSelectChange("split_mode"),uiRestrictions:uiRestrictions}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{className:"tvbAggRow__unavailable",size:"xxxs"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.unsupportedSplit.splitIsUnsupportedDescription",defaultMessage:"Split by {modelType} is unsupported.",values:{modelType:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,model.split_mode)}})))))};const SPLIT_MODES={FILTERS:"filters",FILTER:"filter",TERMS:"terms",EVERYTHING:"everything"};class split_Split extends external_osdSharedDeps_React_["Component"]{UNSAFE_componentWillReceiveProps(nextProps){const{model:model}=nextProps;if(model.split_mode==="filters"&&!model.split_filters){this.props.onChange({split_filters:[{color:model.color,id:uuid_default.a.v1(),filter:{query:"",language:getDefaultQueryLanguage()}}]})}}getComponent(splitMode,uiRestrictions){if(!isGroupByFieldsEnabled(splitMode,uiRestrictions)){return SplitUnsupported}switch(splitMode){case SPLIT_MODES.TERMS:return SplitByTerms;case SPLIT_MODES.FILTER:return SplitByFilter;case SPLIT_MODES.FILTERS:return SplitByFilters;default:return SplitByEverything}}render(){const{model:model,panel:panel,uiRestrictions:uiRestrictions,seriesQuantity:seriesQuantity}=this.props;const indexPattern=model.override_index_pattern&&model.series_index_pattern||panel.index_pattern;const splitMode=Object(external_osdSharedDeps_Lodash_["get"])(this.props,"model.split_mode",SPLIT_MODES.EVERYTHING);const Component=this.getComponent(splitMode,uiRestrictions);return external_osdSharedDeps_React_default.a.createElement(Component,{model:model,indexPattern:indexPattern,fields:this.props.fields,onChange:this.props.onChange,uiRestrictions:uiRestrictions,seriesQuantity:seriesQuantity})}}const TimeseriesSeriesUI=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])((function(props){const{panel:panel,fields:fields,onAdd:onAdd,onDelete:onDelete,disableDelete:disableDelete,disableAdd:disableAdd,selectedTab:selectedTab,onChange:onChange,visible:visible,intl:intl,name:name,uiRestrictions:uiRestrictions,seriesQuantity:seriesQuantity}=props;const defaults={label:"",type:panel_types["a"].TIMESERIES};const model={...defaults,...props.model};const handleChange=createTextHandler(onChange);let caretIcon="arrowDown";if(!visible)caretIcon="arrowRight";let body=null;if(visible){let seriesBody;if(selectedTab==="metrics"){seriesBody=external_osdSharedDeps_React_default.a.createElement("div",null,external_osdSharedDeps_React_default.a.createElement(aggs_Aggs,{onChange:props.onChange,fields:fields,panel:panel,model:model,name:name,uiRestrictions:uiRestrictions,dragHandleProps:props.dragHandleProps}),external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow tvbAggRow--split"},external_osdSharedDeps_React_default.a.createElement(split_Split,{onChange:props.onChange,fields:fields,panel:panel,model:model,uiRestrictions:uiRestrictions,seriesQuantity:seriesQuantity})))}else{seriesBody=external_osdSharedDeps_React_default.a.createElement(TimeseriesConfig,{fields:props.fields,model:model,onChange:props.onChange,indexPatternForQuery:props.indexPatternForQuery,seriesQuantity:seriesQuantity})}body=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbSeries__body"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="metrics",onClick:()=>props.switchTab("metrics")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.tab.metricsLabel",defaultMessage:"Metrics"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"seriesOptions",isSelected:selectedTab==="options",onClick:()=>props.switchTab("options")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.tab.optionsLabel",defaultMessage:"Options"}))),seriesBody)}const colorPicker=external_osdSharedDeps_React_default.a.createElement(ColorPicker,{disableTrash:true,onChange:props.onChange,name:"color",value:model.color});return external_osdSharedDeps_React_default.a.createElement("div",{className:"".concat(props.className),style:props.style},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s",alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:caretIcon,color:"text",onClick:props.toggleVisible,"aria-label":intl.formatMessage({id:"visTypeTimeseries.timeSeries.toggleSeriesEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":props.visible})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},colorPicker),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,onChange:handleChange("label"),placeholder:intl.formatMessage({id:"visTypeTimeseries.timeSeries.labelPlaceholder",defaultMessage:"Label"}),value:model.label})),external_osdSharedDeps_React_default.a.createElement(series_drag_handler_SeriesDragHandler,{dragHandleProps:props.dragHandleProps,hideDragHandler:props.disableDelete}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(AddDeleteButtons,{addTooltip:intl.formatMessage({id:"visTypeTimeseries.timeSeries.addSeriesTooltip",defaultMessage:"Add Series"}),deleteTooltip:intl.formatMessage({id:"visTypeTimeseries.timeSeries.deleteSeriesTooltip",defaultMessage:"Delete Series"}),cloneTooltip:intl.formatMessage({id:"visTypeTimeseries.timeSeries.cloneSeriesTooltip",defaultMessage:"Clone Series"}),onDelete:onDelete,onClone:props.onClone,togglePanelActivation:props.togglePanelActivation,isPanelActive:!model.hidden,onAdd:onAdd,disableDelete:disableDelete,disableAdd:disableAdd,responsive:false}))),body)}));const TimeseriesSeries=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(TimeseriesSeriesUI);const SeriesConfig=props=>{const defaults={offset_time:"",value_template:""};const model={...defaults,...props.model};const handleSelectChange=createSelectHandler(props.onChange);const handleTextChange=createTextHandler(props.onChange);const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const seriesIndexPattern=props.model.override_index_pattern&&props.model.series_index_pattern?props.model.series_index_pattern:props.indexPatternForQuery;return external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow"},external_osdSharedDeps_React_default.a.createElement(DataFormatPicker,{onChange:handleSelectChange("formatter"),value:model.formatter}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("series_filter"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesConfig.filterLabel",defaultMessage:"Filter"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter&&model.filter.language?model.filter.language:getDefaultQueryLanguage(),query:model.filter&&model.filter.query?model.filter.query:""},onChange:filter=>props.onChange({filter:filter}),indexPatterns:[seriesIndexPattern]})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("template"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesConfig.templateLabel",defaultMessage:"Template"}),helpText:external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesConfig.templateHelpText",defaultMessage:"eg. {templateExample}",values:{templateExample:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"{{value}}/s")}})),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("value_template"),value:model.value_template,fullWidth:true}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("offsetSeries"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesConfig.offsetSeriesTimeLabel",defaultMessage:"Offset series time by (1m, 1h, 1w, 1d)",description:"1m, 1h, 1w and 1d are required values and must not be translated."})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":"offsetTimeSeries",onChange:handleTextChange("offset_time"),value:model.offset_time})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesConfig.overrideIndexPatternLabel",defaultMessage:"Override Index Pattern?"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.override_index_pattern,name:"override_index_pattern",onChange:props.onChange})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(IndexPattern,{onChange:props.onChange,model:props.model,fields:props.fields,prefix:"series_",disabled:!model.override_index_pattern}))))};function MetricSeriesUi(props){const{panel:panel,fields:fields,name:name,onAdd:onAdd,onChange:onChange,onDelete:onDelete,disableDelete:disableDelete,disableAdd:disableAdd,selectedTab:selectedTab,visible:visible,intl:intl,uiRestrictions:uiRestrictions}=props;const defaults={label:""};const model={...defaults,...props.model};const handleChange=createTextHandler(onChange);let caretIcon="arrowDown";if(!visible)caretIcon="arrowRight";let body=null;if(visible){let seriesBody;if(selectedTab==="metrics"){seriesBody=external_osdSharedDeps_React_default.a.createElement("div",null,external_osdSharedDeps_React_default.a.createElement(aggs_Aggs,{onChange:props.onChange,fields:fields,panel:panel,model:model,name:name,uiRestrictions:uiRestrictions,dragHandleProps:props.dragHandleProps}),external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow tvbAggRow--split"},external_osdSharedDeps_React_default.a.createElement(split_Split,{onChange:props.onChange,fields:fields,panel:panel,model:model,uiRestrictions:uiRestrictions})))}else{seriesBody=external_osdSharedDeps_React_default.a.createElement(SeriesConfig,{fields:props.fields,model:props.model,onChange:props.onChange,indexPatternForQuery:props.indexPatternForQuery})}body=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbSeries__body"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="metrics",onClick:()=>props.switchTab("metrics")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.dataTab.metricsButtonLabel",defaultMessage:"Metrics"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"seriesOptions",isSelected:selectedTab==="options",onClick:()=>props.switchTab("options")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.optionsTab.optionsButtonLabel",defaultMessage:"Options"}))),seriesBody)}let colorPicker;if(props.colorPicker){colorPicker=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(ColorPicker,{disableTrash:true,onChange:props.onChange,name:"color",value:model.color}))}return external_osdSharedDeps_React_default.a.createElement("div",{className:"".concat(props.className),style:props.style},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s",alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:caretIcon,color:"text",onClick:props.toggleVisible,"aria-label":intl.formatMessage({id:"visTypeTimeseries.metric.editor.toggleEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":props.visible})),colorPicker,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,onChange:handleChange("label"),placeholder:intl.formatMessage({id:"visTypeTimeseries.metric.editor.labelPlaceholder",defaultMessage:"Label"}),value:model.label})),external_osdSharedDeps_React_default.a.createElement(series_drag_handler_SeriesDragHandler,{dragHandleProps:props.dragHandleProps,hideDragHandler:props.disableDelete}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(AddDeleteButtons,{addTooltip:intl.formatMessage({id:"visTypeTimeseries.metric.editor.addSeriesTooltip",defaultMessage:"Add Series"}),deleteTooltip:intl.formatMessage({id:"visTypeTimeseries.metric.editor.deleteSeriesTooltip",defaultMessage:"Delete Series"}),cloneTooltip:intl.formatMessage({id:"visTypeTimeseries.metric.editor.cloneSeriesTooltip",defaultMessage:"Clone Series"}),onDelete:onDelete,onClone:props.onClone,onAdd:onAdd,togglePanelActivation:props.togglePanelActivation,isPanelActive:!model.hidden,disableDelete:disableDelete,disableAdd:disableAdd,responsive:false}))),body)}const MetricSeries=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(MetricSeriesUi);const TopNSeries=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])((function(props){const{panel:panel,model:model,name:name,fields:fields,onAdd:onAdd,onChange:onChange,onDelete:onDelete,disableDelete:disableDelete,disableAdd:disableAdd,selectedTab:selectedTab,visible:visible,intl:intl,uiRestrictions:uiRestrictions}=props;const handleChange=createTextHandler(onChange);let caretIcon="arrowDown";if(!visible)caretIcon="arrowRight";let body=null;if(visible){let seriesBody;if(selectedTab==="metrics"){seriesBody=external_osdSharedDeps_React_default.a.createElement("div",null,external_osdSharedDeps_React_default.a.createElement(aggs_Aggs,{onChange:props.onChange,fields:fields,panel:panel,model:model,name:name,uiRestrictions:uiRestrictions,dragHandleProps:props.dragHandleProps}),external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow tvbAggRow--split"},external_osdSharedDeps_React_default.a.createElement(split_Split,{onChange:props.onChange,fields:fields,panel:panel,model:model,uiRestrictions:uiRestrictions})))}else{seriesBody=external_osdSharedDeps_React_default.a.createElement(SeriesConfig,{fields:props.fields,model:props.model,onChange:props.onChange,indexPatternForQuery:props.indexPatternForQuery})}body=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbSeries__body"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="metrics",onClick:()=>props.switchTab("metrics")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.tab.metricsLabel",defaultMessage:"Metrics"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"seriesOptions",isSelected:selectedTab==="options",onClick:()=>props.switchTab("options")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.tab.optionsLabel",defaultMessage:"Options"}))),seriesBody)}const colorPicker=external_osdSharedDeps_React_default.a.createElement(ColorPicker,{disableTrash:true,onChange:props.onChange,name:"color",value:model.color});return external_osdSharedDeps_React_default.a.createElement("div",{className:"".concat(props.className),style:props.style},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s",alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:caretIcon,color:"text",onClick:props.toggleVisible,"aria-label":intl.formatMessage({id:"visTypeTimeseries.topN.toggleSeriesEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":props.visible})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},colorPicker),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,onChange:handleChange("label"),placeholder:intl.formatMessage({id:"visTypeTimeseries.topN.labelPlaceholder",defaultMessage:"Label"}),value:model.label})),external_osdSharedDeps_React_default.a.createElement(series_drag_handler_SeriesDragHandler,{dragHandleProps:props.dragHandleProps,hideDragHandler:props.disableDelete}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(AddDeleteButtons,{addTooltip:intl.formatMessage({id:"visTypeTimeseries.topN.addSeriesTooltip",defaultMessage:"Add Series"}),deleteTooltip:intl.formatMessage({id:"visTypeTimeseries.topN.deleteSeriesTooltip",defaultMessage:"Delete Series"}),cloneTooltip:intl.formatMessage({id:"visTypeTimeseries.topN.cloneSeriesTooltip",defaultMessage:"Clone Series"}),onDelete:onDelete,onClone:props.onClone,onAdd:onAdd,togglePanelActivation:props.togglePanelActivation,isPanelActive:!model.hidden,disableDelete:disableDelete,disableAdd:disableAdd,responsive:false}))),body)}));class color_rules_ColorRulesUI extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);this.renderRow=this.renderRow.bind(this)}handleChange(item,name){let cast=arguments.length>2&&arguments[2]!==undefined?arguments[2]:String;return e=>{const handleChange=collectionActions.handleChange.bind(null,this.props);const part={};part[name]=cast(external_osdSharedDeps_Lodash_default.a.get(e,"[0].value",external_osdSharedDeps_Lodash_default.a.get(e,"target.value")));if(part[name]==="undefined")part[name]=undefined;if(cast===Number&&isNaN(part[name]))part[name]=undefined;handleChange(external_osdSharedDeps_Lodash_default.a.assign({},item,part))}}renderRow(row,i,items){const defaults={value:0};const model={...defaults,...row};const handleAdd=()=>collectionActions.handleAdd(this.props);const handleDelete=collectionActions.handleDelete.bind(null,this.props,model);const{intl:intl}=this.props;const operatorOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.colorRules.greaterThanLabel",defaultMessage:"> greater than"}),value:"gt"},{label:intl.formatMessage({id:"visTypeTimeseries.colorRules.greaterThanOrEqualLabel",defaultMessage:">= greater than or equal"}),value:"gte"},{label:intl.formatMessage({id:"visTypeTimeseries.colorRules.lessThanLabel",defaultMessage:"< less than"}),value:"lt"},{label:intl.formatMessage({id:"visTypeTimeseries.colorRules.lessThanOrEqualLabel",defaultMessage:"<= less than or equal"}),value:"lte"}];const handleColorChange=part=>{const handleChange=collectionActions.handleChange.bind(null,this.props);handleChange(external_osdSharedDeps_Lodash_default.a.assign({},model,part))};const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])(model.id);const selectedOperatorOption=operatorOptions.find(option=>model.operator===option.value);const labelStyle={marginBottom:0};let secondary;if(!this.props.hideSecondary){secondary=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_["Fragment"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{style:labelStyle},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.colorRules.setSecondaryColorLabel",defaultMessage:"and {secondaryName} to",values:{secondaryName:this.props.secondaryName},description:"Part of a larger string: Set {primaryName} to {color} and {secondaryName} to {color} if metric is {greaterOrLessThan} {value}."}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(ColorPicker,{onChange:handleColorChange,name:this.props.secondaryVarName,value:model[this.props.secondaryVarName]})))}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true,responsive:false,gutterSize:"s",key:model.id,alignItems:"center",className:"tvbColorRules__rule"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{style:labelStyle},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.colorRules.setPrimaryColorLabel",defaultMessage:"Set {primaryName} to",values:{primaryName:this.props.primaryName},description:"Part of a larger string: Set {primaryName} to {color} and {secondaryName} to {color} if metric is {greaterOrLessThan} {value}."}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(ColorPicker,{onChange:handleColorChange,name:this.props.primaryVarName,value:model[this.props.primaryVarName]})),secondary,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{style:labelStyle,htmlFor:htmlId("ifMetricIs")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.colorRules.ifMetricIsLabel",defaultMessage:"if metric is",description:"Part of a larger string: Set {primaryName} to {color} and {secondaryName} to {color} if metric is {greaterOrLessThan} {value}."}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{id:htmlId("ifMetricIs"),options:operatorOptions,selectedOptions:selectedOperatorOption?[selectedOperatorOption]:[],onChange:this.handleChange(model,"operator"),singleSelection:{asPlainText:true},"data-test-subj":"colorRuleOperator",fullWidth:true})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{"aria-label":intl.formatMessage({id:"visTypeTimeseries.colorRules.valueAriaLabel",defaultMessage:"Value"}),value:model.value,onChange:this.handleChange(model,"value",Number),"data-test-subj":"colorRuleValue",fullWidth:true})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(AddDeleteButtons,{onAdd:handleAdd,onDelete:handleDelete,disableDelete:items.length<2,responsive:false})))}render(){const{model:model,name:name}=this.props;if(!model[name])return external_osdSharedDeps_React_default.a.createElement("div",null);const rows=model[name].map(this.renderRow);return external_osdSharedDeps_React_default.a.createElement("div",null,rows)}}color_rules_ColorRulesUI.defaultProps={name:"color_rules",primaryName:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.colorRules.defaultPrimaryNameLabel",{defaultMessage:"background"}),primaryVarName:"background_color",secondaryName:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.colorRules.defaultSecondaryNameLabel",{defaultMessage:"text"}),secondaryVarName:"color",hideSecondary:false};const ColorRules=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(color_rules_ColorRulesUI);class config_TableSeriesConfigUI extends external_osdSharedDeps_React_["Component"]{UNSAFE_componentWillMount(){const{model:model}=this.props;if(!model.color_rules||model.color_rules&&model.color_rules.length===0){this.props.onChange({color_rules:[{id:uuid_default.a.v1()}]})}}render(){const defaults={offset_time:"",value_template:""};const model={...defaults,...this.props.model};const handleSelectChange=createSelectHandler(this.props.onChange);const handleTextChange=createTextHandler(this.props.onChange);const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const{intl:intl}=this.props;const functionOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.table.sumLabel",defaultMessage:"Sum"}),value:"sum"},{label:intl.formatMessage({id:"visTypeTimeseries.table.maxLabel",defaultMessage:"Max"}),value:"max"},{label:intl.formatMessage({id:"visTypeTimeseries.table.minLabel",defaultMessage:"Min"}),value:"min"},{label:intl.formatMessage({id:"visTypeTimeseries.table.avgLabel",defaultMessage:"Avg"}),value:"mean"},{label:intl.formatMessage({id:"visTypeTimeseries.table.overallSumLabel",defaultMessage:"Overall Sum"}),value:"overall_sum"},{label:intl.formatMessage({id:"visTypeTimeseries.table.overallMaxLabel",defaultMessage:"Overall Max"}),value:"overall_max"},{label:intl.formatMessage({id:"visTypeTimeseries.table.overallMinLabel",defaultMessage:"Overall Min"}),value:"overall_min"},{label:intl.formatMessage({id:"visTypeTimeseries.table.overallAvgLabel",defaultMessage:"Overall Avg"}),value:"overall_avg"},{label:intl.formatMessage({id:"visTypeTimeseries.table.cumulativeSumLabel",defaultMessage:"Cumulative Sum"}),value:"cumulative_sum"}];const selectedAggFuncOption=functionOptions.find(option=>model.aggregate_function===option.value);return external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(DataFormatPicker,{onChange:handleSelectChange("formatter"),value:model.formatter})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("template"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.templateLabel",defaultMessage:"Template"}),helpText:external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.templateHelpText",defaultMessage:"eg.{templateExample}",values:{templateExample:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"{{value}}/s")}})),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("value_template"),value:model.value_template,fullWidth:true})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("filterInput"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.filterLabel",defaultMessage:"Filter"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter&&model.filter.language?model.filter.language:getDefaultQueryLanguage(),query:model.filter&&model.filter.query?model.filter.query:""},onChange:filter=>this.props.onChange({filter:filter}),indexPatterns:[this.props.indexPatternForQuery]}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.showTrendArrowsLabel",defaultMessage:"Show trend arrows?"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.trend_arrows,name:"trend_arrows",onChange:this.props.onChange}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.fieldLabel",defaultMessage:"Field"})},external_osdSharedDeps_React_default.a.createElement(FieldSelect,{fields:this.props.fields,indexPattern:this.props.panel.index_pattern,value:model.aggregate_by,onChange:handleSelectChange("aggregate_by"),fullWidth:true}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("aggregateFunctionInput"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.aggregateFunctionLabel",defaultMessage:"Aggregate function"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{options:functionOptions,selectedOptions:selectedAggFuncOption?[selectedAggFuncOption]:[],onChange:handleSelectChange("aggregate_function"),singleSelection:{asPlainText:true},fullWidth:true})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"xxs"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.colorRulesLabel",defaultMessage:"Color rules"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(ColorRules,{primaryName:"text",primaryVarName:"text",hideSecondary:true,model:model,onChange:this.props.onChange,name:"color_rules"}))}}const TableSeriesConfig=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(config_TableSeriesConfigUI);function TableSeriesUI(props){const{model:model,onAdd:onAdd,name:name,fields:fields,panel:panel,onChange:onChange,onDelete:onDelete,disableDelete:disableDelete,disableAdd:disableAdd,selectedTab:selectedTab,visible:visible,intl:intl,uiRestrictions:uiRestrictions}=props;const handleChange=createTextHandler(onChange);let caretIcon="arrowDown";if(!visible)caretIcon="arrowRight";let body=null;if(visible){let seriesBody;if(selectedTab==="metrics"){seriesBody=external_osdSharedDeps_React_default.a.createElement("div",null,external_osdSharedDeps_React_default.a.createElement(aggs_Aggs,{onChange:props.onChange,fields:fields,panel:panel,model:model,name:name,uiRestrictions:uiRestrictions,dragHandleProps:props.dragHandleProps}))}else{seriesBody=external_osdSharedDeps_React_default.a.createElement(TableSeriesConfig,{panel:props.panel,fields:props.fields,model:props.model,onChange:props.onChange,indexPatternForQuery:props.indexPatternForQuery})}body=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbSeries__body"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="metrics",onClick:()=>props.switchTab("metrics")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.tab.metricsLabel",defaultMessage:"Metrics"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"seriesOptions",isSelected:selectedTab==="options",onClick:()=>props.switchTab("options")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.tab.optionsLabel",defaultMessage:"Options"}))),seriesBody)}return external_osdSharedDeps_React_default.a.createElement("div",{className:"".concat(props.className),style:props.style},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s",alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:caretIcon,color:"text",onClick:props.toggleVisible,"aria-label":intl.formatMessage({id:"visTypeTimeseries.table.toggleSeriesEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":props.visible})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,"aria-label":intl.formatMessage({id:"visTypeTimeseries.table.labelAriaLabel",defaultMessage:"Label"}),onChange:handleChange("label"),placeholder:intl.formatMessage({id:"visTypeTimeseries.table.labelPlaceholder",defaultMessage:"Label"}),value:model.label})),external_osdSharedDeps_React_default.a.createElement(series_drag_handler_SeriesDragHandler,{dragHandleProps:props.dragHandleProps,hideDragHandler:props.disableDelete}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(AddDeleteButtons,{addTooltip:intl.formatMessage({id:"visTypeTimeseries.table.addSeriesTooltip",defaultMessage:"Add Series"}),deleteTooltip:intl.formatMessage({id:"visTypeTimeseries.table.deleteSeriesTooltip",defaultMessage:"Delete Series"}),cloneTooltip:intl.formatMessage({id:"visTypeTimeseries.table.cloneSeriesTooltip",defaultMessage:"Clone Series"}),onDelete:onDelete,onClone:props.onClone,onAdd:onAdd,togglePanelActivation:props.togglePanelActivation,isPanelActive:!model.hidden,disableDelete:disableDelete,disableAdd:disableAdd,responsive:false}))),body)}const TableSeries=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(TableSeriesUI);function GaugeSeriesUi(props){const{panel:panel,fields:fields,onAdd:onAdd,name:name,onChange:onChange,onDelete:onDelete,disableDelete:disableDelete,disableAdd:disableAdd,selectedTab:selectedTab,visible:visible,intl:intl,uiRestrictions:uiRestrictions}=props;const defaults={label:""};const model={...defaults,...props.model};const handleChange=createTextHandler(onChange);let caretIcon="arrowDown";if(!visible)caretIcon="arrowRight";let body=null;if(visible){let seriesBody;if(selectedTab==="metrics"){seriesBody=external_osdSharedDeps_React_default.a.createElement("div",null,external_osdSharedDeps_React_default.a.createElement(aggs_Aggs,{onChange:props.onChange,fields:fields,panel:panel,model:model,name:name,uiRestrictions:uiRestrictions,dragHandleProps:props.dragHandleProps}),external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow tvbAggRow--split"},external_osdSharedDeps_React_default.a.createElement(split_Split,{onChange:props.onChange,fields:fields,panel:panel,model:model,uiRestrictions:uiRestrictions})))}else{seriesBody=external_osdSharedDeps_React_default.a.createElement(SeriesConfig,{fields:props.fields,model:props.model,onChange:props.onChange,indexPatternForQuery:props.indexPatternForQuery})}body=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbSeries__body"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="metrics",onClick:()=>props.switchTab("metrics")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.dataTab.metricsButtonLabel",defaultMessage:"Metrics"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"seriesOptions",isSelected:selectedTab==="options",onClick:()=>props.switchTab("options")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.optionsButtonLabel",defaultMessage:"Options"}))),seriesBody)}const colorPicker=external_osdSharedDeps_React_default.a.createElement(ColorPicker,{disableTrash:true,onChange:props.onChange,name:"color",value:model.color});return external_osdSharedDeps_React_default.a.createElement("div",{className:"".concat(props.className),style:props.style},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s",alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:caretIcon,color:"text",onClick:props.toggleVisible,"aria-label":intl.formatMessage({id:"visTypeTimeseries.gauge.editor.toggleEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":props.visible})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},colorPicker),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,onChange:handleChange("label"),placeholder:intl.formatMessage({id:"visTypeTimeseries.gauge.editor.labelPlaceholder",defaultMessage:"Label"}),value:model.label})),external_osdSharedDeps_React_default.a.createElement(series_drag_handler_SeriesDragHandler,{dragHandleProps:props.dragHandleProps,hideDragHandler:props.disableDelete}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(AddDeleteButtons,{addTooltip:intl.formatMessage({id:"visTypeTimeseries.gauge.editor.addSeriesTooltip",defaultMessage:"Add Series"}),deleteTooltip:intl.formatMessage({id:"visTypeTimeseries.gauge.editor.deleteSeriesTooltip",defaultMessage:"Delete Series"}),cloneTooltip:intl.formatMessage({id:"visTypeTimeseries.gauge.editor.cloneSeriesTooltip",defaultMessage:"Clone Series"}),onDelete:onDelete,onClone:props.onClone,onAdd:onAdd,disableDelete:disableDelete,disableAdd:disableAdd,responsive:false}))),body)}const GaugeSeries=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(GaugeSeriesUi);function MarkdownSeriesUi(props){const{panel:panel,fields:fields,onAdd:onAdd,onChange:onChange,onDelete:onDelete,disableDelete:disableDelete,disableAdd:disableAdd,selectedTab:selectedTab,visible:visible,intl:intl,name:name,uiRestrictions:uiRestrictions}=props;const defaults={label:"",var_name:""};const model={...defaults,...props.model};const handleChange=createTextHandler(onChange);let caretIcon="arrowDown";if(!visible)caretIcon="arrowRight";let body=null;if(visible){let seriesBody;if(selectedTab==="metrics"){seriesBody=external_osdSharedDeps_React_default.a.createElement("div",null,external_osdSharedDeps_React_default.a.createElement(aggs_Aggs,{onChange:props.onChange,fields:fields,panel:panel,model:model,name:name,uiRestrictions:uiRestrictions,dragHandleProps:props.dragHandleProps}),external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow tvbAggRow--split"},external_osdSharedDeps_React_default.a.createElement(split_Split,{onChange:props.onChange,fields:fields,panel:panel,model:model,uiRestrictions:uiRestrictions})))}else{seriesBody=external_osdSharedDeps_React_default.a.createElement(SeriesConfig,{fields:props.fields,model:props.model,onChange:props.onChange,indexPatternForQuery:props.indexPatternForQuery})}body=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbSeries__body"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="metrics",onClick:()=>props.switchTab("metrics")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.dataTab.metricsButtonLabel",defaultMessage:"Metrics"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"seriesOptions",isSelected:selectedTab==="options",onClick:()=>props.switchTab("options")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.optionsButtonLabel",defaultMessage:"Options"}))),seriesBody)}return external_osdSharedDeps_React_default.a.createElement("div",{className:"".concat(props.className),style:props.style},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s",alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:caretIcon,color:"text",onClick:props.toggleVisible,"aria-label":intl.formatMessage({id:"visTypeTimeseries.markdown.editor.toggleEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":props.visible})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,onChange:handleChange("label"),placeholder:intl.formatMessage({id:"visTypeTimeseries.markdown.editor.labelPlaceholder",defaultMessage:"Label"}),value:model.label})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,onChange:handleChange("var_name"),placeholder:intl.formatMessage({id:"visTypeTimeseries.markdown.editor.variableNamePlaceholder",defaultMessage:"Variable name"}),value:model.var_name})),external_osdSharedDeps_React_default.a.createElement(series_drag_handler_SeriesDragHandler,{dragHandleProps:props.dragHandleProps,hideDragHandler:true}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(AddDeleteButtons,{addTooltip:intl.formatMessage({id:"visTypeTimeseries.markdown.editor.addSeriesTooltip",defaultMessage:"Add series"}),deleteTooltip:intl.formatMessage({id:"visTypeTimeseries.markdown.editor.deleteSeriesTooltip",defaultMessage:"Delete series"}),cloneTooltip:intl.formatMessage({id:"visTypeTimeseries.markdown.editor.cloneSeriesTooltip",defaultMessage:"Clone series"}),onDelete:onDelete,onClone:props.onClone,onAdd:onAdd,disableDelete:disableDelete,disableAdd:disableAdd,responsive:false}))),body)}const MarkdownSeries=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(MarkdownSeriesUi);function series_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const series_lookup={top_n:TopNSeries,table:TableSeries,metric:MetricSeries,timeseries:TimeseriesSeries,gauge:GaugeSeries,markdown:MarkdownSeries};class series_Series extends external_osdSharedDeps_React_["Component"]{constructor(){super(...arguments);series_defineProperty(this,"state",{visible:true,selectedTab:"metrics"});series_defineProperty(this,"switchTab",selectedTab=>{this.setState({selectedTab:selectedTab})});series_defineProperty(this,"handleChange",part=>{if(this.props.onChange){const{model:model}=this.props;const doc=Object(external_osdSharedDeps_Lodash_["assign"])({},model,part);this.props.onChange(doc)}});series_defineProperty(this,"togglePanelActivation",()=>{const{model:model}=this.props;this.handleChange({hidden:!model.hidden})});series_defineProperty(this,"toggleVisible",e=>{e.preventDefault();this.setState({visible:!this.state.visible})})}render(){const{panel:panel}=this.props;const Component=series_lookup[panel.type];return Boolean(Component)?external_osdSharedDeps_React_default.a.createElement(VisDataContext.Consumer,null,visData=>{const series=Object(external_osdSharedDeps_Lodash_["get"])(visData,"".concat(panel.id,".series"),[]);const counter={};const seriesQuantity=series.reduce((acc,value)=>{counter[value.seriesId]=counter[value.seriesId]+1||1;acc[value.seriesId]=counter[value.seriesId];return acc},{});return external_osdSharedDeps_React_default.a.createElement(Component,{className:this.props.className,disableAdd:this.props.disableAdd,uiRestrictions:visData.uiRestrictions,seriesQuantity:seriesQuantity,disableDelete:this.props.disableDelete,fields:this.props.fields,name:this.props.name,onAdd:this.props.onAdd,onChange:this.handleChange,onClone:this.props.onClone,onDelete:this.props.onDelete,model:this.props.model,panel:this.props.panel,selectedTab:this.state.selectedTab,style:this.props.style,switchTab:this.switchTab,toggleVisible:this.toggleVisible,togglePanelActivation:this.togglePanelActivation,visible:this.state.visible,dragHandleProps:this.props.dragHandleProps,indexPatternForQuery:panel.index_pattern||panel.default_index_pattern})}):external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesConfig.missingSeriesComponentDescription",defaultMessage:"Missing Series component for panel type: {panelType}",values:{panelType:panel.type}})}}series_Series.defaultProps={name:"metrics"};const newSeriesFn=function(){let obj=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return external_osdSharedDeps_Lodash_default.a.assign({id:uuid_default.a.v1(),color:"#68BC00",split_mode:"everything",metrics:[newMetricAggFn()],separate_axis:0,axis_position:"right",formatter:"number",chart_type:"line",line_width:1,point_size:1,fill:.5,stacked:STACKED_OPTIONS.NONE},obj)};const reorder=(list,startIndex,endIndex)=>{const result=Array.from(list);const[removed]=result.splice(startIndex,1);result.splice(endIndex,0,removed);return result};function series_editor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const series_editor_DROPPABLE_ID="series_editor_dnd";class series_editor_SeriesEditor extends external_osdSharedDeps_React_["Component"]{constructor(){super(...arguments);series_editor_defineProperty(this,"handleClone",series=>{const newSeries=reIdSeries(series);collection_actions_handleAdd.call(null,this.props,()=>newSeries)});series_editor_defineProperty(this,"sortHandler",_ref=>{let{destination:destination,source:source}=_ref;const canSort=destination&&source;if(canSort){const sortFunction=this.getSortFunction({destination:destination,source:source});sortFunction({destination:destination,source:source})}});series_editor_defineProperty(this,"getSortFunction",_ref2=>{let{destination:destination,source:source}=_ref2;return destination.droppableId===source.droppableId&&source.droppableId===series_editor_DROPPABLE_ID?this.sortSeries:this.sortAggregations});series_editor_defineProperty(this,"sortSeries",_ref3=>{let{destination:destination,source:source}=_ref3;this.props.onChange({series:reorder([...this.props.model.series],source.index,destination.index)})});series_editor_defineProperty(this,"sortAggregations",_ref4=>{let{destination:destination,source:source}=_ref4;const extractId=_ref5=>{let{droppableId:droppableId}=_ref5;return droppableId.split(":")[1]};const id=extractId(source);const canSort=id===extractId(destination);if(canSort){const model=[...this.props.model.series];const series=Object(external_osdSharedDeps_Lodash_["find"])(model,{id:id});series.metrics=reorder([...series.metrics],source.index,destination.index);this.props.onChange({series:model})}})}render(){const{limit:limit,model:model,name:name,fields:fields,colorPicker:colorPicker}=this.props;const list=model[name].filter((val,index)=>index<(limit||Infinity));return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiDragDropContext"],{onDragEnd:this.sortHandler},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiDroppable"],{droppableId:series_editor_DROPPABLE_ID,spacing:"l",type:"MACRO"},list.map((row,idx)=>external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiDraggable"],{spacing:"m",key:row.id,index:idx,customDragHandle:true,draggableId:"".concat(series_editor_DROPPABLE_ID,":").concat(row.id),disableInteractiveElementBlocking:true},provided=>external_osdSharedDeps_React_default.a.createElement(series_Series,{className:"tvbSeriesEditor",colorPicker:colorPicker,disableAdd:model[name].length>=limit,disableDelete:model[name].length<2,fields:fields,onAdd:()=>collection_actions_handleAdd(this.props,newSeriesFn),onChange:doc=>collection_actions_handleChange(this.props,doc),onClone:()=>this.handleClone(row),onDelete:()=>collection_actions_handleDelete(this.props,row),model:row,panel:model,dragHandleProps:provided.dragHandleProps})))))}}series_editor_SeriesEditor.defaultProps={name:"series",limit:Infinity,colorPicker:true};const ICONS=[{value:"fa-asterisk",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.iconSelect.asteriskLabel",{defaultMessage:"Asterisk"})},{value:"fa-bell",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.iconSelect.bellLabel",{defaultMessage:"Bell"})},{value:"fa-bolt",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.iconSelect.boltLabel",{defaultMessage:"Bolt"})},{value:"fa-comment",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.iconSelect.commentLabel",{defaultMessage:"Comment"})},{value:"fa-map-marker",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.iconSelect.mapMarkerLabel",{defaultMessage:"Map Marker"})},{value:"fa-map-pin",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.iconSelect.mapPinLabel",{defaultMessage:"Map Pin"})},{value:"fa-star",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.iconSelect.starLabel",{defaultMessage:"Star"})},{value:"fa-tag",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.iconSelect.tagLabel",{defaultMessage:"Tag"})},{value:"fa-bomb",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.iconSelect.bombLabel",{defaultMessage:"Bomb"})},{value:"fa-bug",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.iconSelect.bugLabel",{defaultMessage:"Bug"})},{value:"fa-exclamation-circle",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.iconSelect.exclamationCircleLabel",{defaultMessage:"Exclamation Circle"})},{value:"fa-exclamation-triangle",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.iconSelect.exclamationTriangleLabel",{defaultMessage:"Exclamation Triangle"})},{value:"fa-fire",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.iconSelect.fireLabel",{defaultMessage:"Fire"})},{value:"fa-flag",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.iconSelect.flagLabel",{defaultMessage:"Flag"})},{value:"fa-heart",label:external_osdSharedDeps_OsdI18n_["i18n"].translate("visTypeTimeseries.iconSelect.heartLabel",{defaultMessage:"Heart"})}];function IconView(_ref){let{value:icon,label:label}=_ref;return external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIcon"],{type:ICON_TYPES_MAP[icon]})," ".concat(label))}function IconSelect(_ref2){let{value:value,onChange:onChange}=_ref2;const selectedIcon=ICONS.find(option=>value===option.value)||ICONS[0];return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:ICONS,selectedOptions:[selectedIcon],onChange:onChange,singleSelection:{asPlainText:true},renderOption:IconView})}function annotations_editor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function newAnnotation(){return{id:uuid_default.a.v1(),color:"#F00",index_pattern:"*",time_field:"@timestamp",icon:"fa-tag",ignore_global_filters:1,ignore_panel_filters:1}}const annotations_editor_RESTRICT_FIELDS=[public_["OSD_FIELD_TYPES"].DATE];class annotations_editor_AnnotationsEditor extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);annotations_editor_defineProperty(this,"handleQueryChange",(model,filter)=>{const part={query_string:filter};collectionActions.handleChange(this.props,{...model,...part})});this.renderRow=this.renderRow.bind(this)}handleChange(item,name){return e=>{const handleChange=collectionActions.handleChange.bind(null,this.props);const part={};part[name]=external_osdSharedDeps_Lodash_default.a.get(e,"[0].value",external_osdSharedDeps_Lodash_default.a.get(e,"target.value"));handleChange(external_osdSharedDeps_Lodash_default.a.assign({},item,part))}}renderRow(row){const defaults={fields:"",template:"",index_pattern:"*",query_string:{query:"",language:getDefaultQueryLanguage()}};const model={...defaults,...row};const handleChange=part=>{const fn=collectionActions.handleChange.bind(null,this.props);fn(external_osdSharedDeps_Lodash_default.a.assign({},model,part))};const togglePanelActivation=()=>{handleChange({hidden:!model.hidden})};const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])(model.id);const handleAdd=collectionActions.handleAdd.bind(null,this.props,newAnnotation);const handleDelete=collectionActions.handleDelete.bind(null,this.props,model);return external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbAnnotationsEditor",key:model.id},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(ColorPicker,{disableTrash:true,onChange:handleChange,name:"color",value:model.color})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{className:"tvbAggRow__children"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,gutterSize:"m"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("indexPattern"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.indexPatternLabel",defaultMessage:"Index pattern (required)"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{onChange:this.handleChange(model,"index_pattern"),value:model.index_pattern,fullWidth:true}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("timeField"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.timeFieldLabel",defaultMessage:"Time field (required)"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(FieldSelect,{restrict:annotations_editor_RESTRICT_FIELDS,value:model.time_field,onChange:this.handleChange(model,"time_field"),indexPattern:model.index_pattern,fields:this.props.fields,fullWidth:true})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,gutterSize:"m"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("queryString"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.queryStringLabel",defaultMessage:"Query string"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.query_string.language||getDefaultQueryLanguage(),query:model.query_string.query||""},onChange:query=>this.handleQueryChange(model,query),indexPatterns:[model.index_pattern]}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.ignoreGlobalFiltersLabel",defaultMessage:"Ignore global filters?"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.ignore_global_filters,name:"ignore_global_filters",onChange:handleChange})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.ignorePanelFiltersLabel",defaultMessage:"Ignore panel filters?"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.ignore_panel_filters,name:"ignore_panel_filters",onChange:handleChange}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,gutterSize:"m"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("icon"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.iconLabel",defaultMessage:"Icon (required)"})},external_osdSharedDeps_React_default.a.createElement(IconSelect,{value:model.icon,onChange:this.handleChange(model,"icon")}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("fields"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.fieldsLabel",defaultMessage:"Fields (required - comma separated paths)"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{onChange:this.handleChange(model,"fields"),value:model.fields,fullWidth:true}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("rowTemplate"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.rowTemplateLabel",defaultMessage:"Row template (required)"}),helpText:external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.rowTemplateHelpText",defaultMessage:"eg.{rowTemplateExample}",values:{rowTemplateExample:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"{{field}}")}})),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{onChange:this.handleChange(model,"template"),value:model.template,fullWidth:true}))))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(AddDeleteButtons,{onAdd:handleAdd,onDelete:handleDelete,togglePanelActivation:togglePanelActivation,isPanelActive:!model.hidden}))))}render(){const{model:model}=this.props;let content;if(!model.annotations||!model.annotations.length){const handleAdd=collectionActions.handleAdd.bind(null,this.props,newAnnotation);content=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],{textAlign:"center"},external_osdSharedDeps_React_default.a.createElement("p",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.howToCreateAnnotationDataSourceDescription",defaultMessage:"Click the button below to create an annotation data source."})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButton"],{fill:true,onClick:handleAdd},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.addDataSourceButtonLabel",defaultMessage:"Add data source"})))}else{const annotations=model.annotations.map(this.renderRow);content=external_osdSharedDeps_React_default.a.createElement("div",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.dataSourcesLabel",defaultMessage:"Data sources"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),annotations)}return external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbAnnotationsEditor__container"},content)}}annotations_editor_AnnotationsEditor.defaultProps={name:"annotations"};class timeseries_TimeseriesPanelConfigUi extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);this.state={selectedTab:"data"}}switchTab(selectedTab){this.setState({selectedTab:selectedTab})}render(){const defaults={filter:{query:"",language:getDefaultQueryLanguage()},axis_max:"",axis_min:"",legend_position:"right",show_grid:1,tooltip_mode:"show_all"};const model={...defaults,...this.props.model};const{selectedTab:selectedTab}=this.state;const handleSelectChange=createSelectHandler(this.props.onChange);const handleTextChange=createTextHandler(this.props.onChange);const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const{intl:intl}=this.props;const positionOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.positionOptions.rightLabel",defaultMessage:"Right"}),value:"right"},{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.positionOptions.leftLabel",defaultMessage:"Left"}),value:"left"}];const tooltipModeOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.tooltipOptions.showAll",defaultMessage:"Show all values"}),value:"show_all"},{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.tooltipOptions.showFocused",defaultMessage:"Show focused values"}),value:"show_focused"}];const selectedPositionOption=positionOptions.find(option=>model.axis_position===option.value);const scaleOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.scaleOptions.normalLabel",defaultMessage:"Normal"}),value:"normal"},{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.scaleOptions.logLabel",defaultMessage:"Log"}),value:"log"}];const selectedAxisScaleOption=scaleOptions.find(option=>model.axis_scale===option.value);const legendPositionOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.legendPositionOptions.rightLabel",defaultMessage:"Right"}),value:"right"},{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.legendPositionOptions.leftLabel",defaultMessage:"Left"}),value:"left"},{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.legendPositionOptions.bottomLabel",defaultMessage:"Bottom"}),value:"bottom"}];const selectedLegendPosOption=legendPositionOptions.find(option=>model.legend_position===option.value);const selectedTooltipMode=tooltipModeOptions.find(option=>model.tooltip_mode===option.value);let view;if(selectedTab==="data"){view=external_osdSharedDeps_React_default.a.createElement(series_editor_SeriesEditor,{fields:this.props.fields,model:this.props.model,name:this.props.name,onChange:this.props.onChange})}else if(selectedTab==="annotations"){view=external_osdSharedDeps_React_default.a.createElement(annotations_editor_AnnotationsEditor,{fields:this.props.fields,model:this.props.model,name:"annotations",onChange:this.props.onChange})}else{view=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbPanelConfig__container"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPanel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.dataLabel",defaultMessage:"Data"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(IndexPattern,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("panelFilter"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language||getDefaultQueryLanguage(),query:model.filter.query||""},onChange:filter=>this.props.onChange({filter:filter}),indexPatterns:[model.index_pattern||model.default_index_pattern]}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.ignoreGlobalFilterLabel",defaultMessage:"Ignore global filter?"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPanel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.styleLabel",defaultMessage:"Style"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("axisMin"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.axisMinLabel",defaultMessage:"Axis min"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("axis_min"),value:model.axis_min}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("axisMax"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.axisMaxLabel",defaultMessage:"Axis max"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("axis_max"),value:model.axis_max}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("axisPos"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.axisPositionLabel",defaultMessage:"Axis position"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:positionOptions,selectedOptions:selectedPositionOption?[selectedPositionOption]:[],onChange:handleSelectChange("axis_position"),singleSelection:{asPlainText:true}}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("axisScale"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.axisScaleLabel",defaultMessage:"Axis scale"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:scaleOptions,selectedOptions:selectedAxisScaleOption?[selectedAxisScaleOption]:[],onChange:handleSelectChange("axis_scale"),singleSelection:{asPlainText:true}})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.backgroundColorLabel",defaultMessage:"Background color:"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(ColorPicker,{onChange:this.props.onChange,name:"background_color",value:model.background_color})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.showLegendLabel",defaultMessage:"Show legend?"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.show_legend,name:"show_legend",onChange:this.props.onChange})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("legendPos")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.legendPositionLabel",defaultMessage:"Legend position"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,id:htmlId("legendPos"),options:legendPositionOptions,selectedOptions:selectedLegendPosOption?[selectedLegendPosOption]:[],onChange:handleSelectChange("legend_position"),singleSelection:{asPlainText:true}})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.displayGridLabel",defaultMessage:"Display grid"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.show_grid,name:"show_grid",onChange:this.props.onChange})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.tooltipMode",defaultMessage:"Tooltip"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,id:htmlId("tooltipMode"),options:tooltipModeOptions,selectedOptions:selectedTooltipMode?[selectedTooltipMode]:[],onChange:handleSelectChange("tooltip_mode"),singleSelection:{asPlainText:true}})))))}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="data",onClick:()=>this.switchTab("data")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.dataTab.dataButtonLabel",defaultMessage:"Data"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="options",onClick:()=>this.switchTab("options"),"data-test-subj":"timeSeriesEditorPanelOptionsBtn"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="annotations",onClick:()=>this.switchTab("annotations")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.annotationsTab.annotationsButtonLabel",defaultMessage:"Annotations"}))),view)}}const TimeseriesPanelConfig=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(timeseries_TimeseriesPanelConfigUi);class metric_MetricPanelConfig extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);this.state={selectedTab:"data"}}UNSAFE_componentWillMount(){const{model:model}=this.props;if(!model.background_color_rules||model.background_color_rules&&model.background_color_rules.length===0){this.props.onChange({background_color_rules:[{id:uuid_default.a.v1()}]})}}switchTab(selectedTab){this.setState({selectedTab:selectedTab})}render(){const{selectedTab:selectedTab}=this.state;const defaults={filter:{query:"",language:getDefaultQueryLanguage()}};const model={...defaults,...this.props.model};const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();let view;if(selectedTab==="data"){view=external_osdSharedDeps_React_default.a.createElement(series_editor_SeriesEditor,{colorPicker:false,fields:this.props.fields,limit:limitOfSeries[panel_types["a"].METRIC],model:this.props.model,name:this.props.name,onChange:this.props.onChange})}else{view=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbPanelConfig__container"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPanel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.optionsTab.dataLabel",defaultMessage:"Data"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(IndexPattern,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("panelFilter"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language||getDefaultQueryLanguage(),query:model.filter.query||""},onChange:filter=>this.props.onChange({filter:filter}),indexPatterns:[model.index_pattern||model.default_index_pattern]}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.optionsTab.ignoreGlobalFilterLabel",defaultMessage:"Ignore global filter?"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPanel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.optionsTab.colorRulesLabel",defaultMessage:"Color rules"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(ColorRules,{model:model,onChange:this.props.onChange,name:"background_color_rules"})))}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="data",onClick:()=>this.switchTab("data")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.dataTab.dataButtonLabel",defaultMessage:"Data"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="options",onClick:()=>this.switchTab("options"),"data-test-subj":"metricEditorPanelOptionsBtn"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"}))),view)}}class top_n_TopNPanelConfig extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);this.state={selectedTab:"data"}}UNSAFE_componentWillMount(){const{model:model}=this.props;const parts={};if(!model.bar_color_rules||model.bar_color_rules&&model.bar_color_rules.length===0){parts.bar_color_rules=[{id:uuid_default.a.v1()}]}this.props.onChange(parts)}switchTab(selectedTab){this.setState({selectedTab:selectedTab})}render(){const{selectedTab:selectedTab}=this.state;const defaults={drilldown_url:"",filter:{query:"",language:getDefaultQueryLanguage()}};const model={...defaults,...this.props.model};const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const handleTextChange=createTextHandler(this.props.onChange);let view;if(selectedTab==="data"){view=external_osdSharedDeps_React_default.a.createElement(series_editor_SeriesEditor,{colorPicker:false,fields:this.props.fields,model:this.props.model,name:this.props.name,onChange:this.props.onChange})}else{view=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbPanelConfig__container"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPanel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.dataLabel",defaultMessage:"Data"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("itemUrl"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.itemUrlLabel",defaultMessage:"Item url"}),helpText:external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.itemUrlDescription",defaultMessage:"This supports mustache templating. {key} is set to the term.",values:{key:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"{{key}}")}}))},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("drilldown_url"),value:model.drilldown_url})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_osdSharedDeps_React_default.a.createElement(IndexPattern,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("panelFilter"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language?model.filter.language:getDefaultQueryLanguage(),query:model.filter.query||""},onChange:filter=>this.props.onChange({filter:filter}),indexPatterns:[model.index_pattern||model.default_index_pattern]}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.ignoreGlobalFilterLabel",defaultMessage:"Ignore global filter?"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPanel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.styleLabel",defaultMessage:"Style"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.backgroundColorLabel",defaultMessage:"Background color:"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(ColorPicker,{onChange:this.props.onChange,name:"background_color",value:model.background_color}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"xxs"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.colorRulesLabel",defaultMessage:"Color rules"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(ColorRules,{model:model,primaryVarName:"bar_color",primaryName:"bar",hideSecondary:true,onChange:this.props.onChange,name:"bar_color_rules"})))}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="data",onClick:()=>this.switchTab("data")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.dataTab.dataButtonLabel",defaultMessage:"Data"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="options",onClick:()=>this.switchTab("options")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"}))),view)}}function table_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class table_TablePanelConfig extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);table_defineProperty(this,"handlePivotChange",selectedOption=>{const{fields:fields,model:model}=this.props;const pivotId=Object(external_osdSharedDeps_Lodash_["get"])(selectedOption,"[0].value",null);const field=fields[model.index_pattern].find(field=>field.name===pivotId);const pivotType=Object(external_osdSharedDeps_Lodash_["get"])(field,"type",model.pivot_type);this.props.onChange({pivot_id:pivotId,pivot_type:pivotType})});this.state={selectedTab:"data"}}UNSAFE_componentWillMount(){const{model:model}=this.props;const parts={};if(!model.bar_color_rules||model.bar_color_rules&&model.bar_color_rules.length===0){parts.bar_color_rules=[{id:uuid_default.a.v1()}]}this.props.onChange(parts)}switchTab(selectedTab){this.setState({selectedTab:selectedTab})}render(){const{selectedTab:selectedTab}=this.state;const defaults={drilldown_url:"",filter:{query:"",language:getDefaultQueryLanguage()},pivot_label:"",pivot_rows:10,pivot_type:""};const model={...defaults,...this.props.model};const handleTextChange=createTextHandler(this.props.onChange);const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();let view;if(selectedTab==="data"){view=external_osdSharedDeps_React_default.a.createElement("div",null,external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbPanelConfig__container"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPanel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],null,external_osdSharedDeps_React_default.a.createElement("p",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.dataTab.defineFieldDescription",defaultMessage:"For the table visualization you need to define a field to group by using a terms aggregation."}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"groupByField"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.dataTab.groupByFieldLabel",defaultMessage:"Group by field"})},external_osdSharedDeps_React_default.a.createElement(FieldSelect,{fields:this.props.fields,value:model.pivot_id,indexPattern:model.index_pattern,onChange:this.handlePivotChange,fullWidth:true}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("pivotLabelInput"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.dataTab.columnLabel",defaultMessage:"Column label"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":"columnLabelName",onChange:handleTextChange("pivot_label"),value:model.pivot_label,fullWidth:true}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("pivotRowsInput"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.dataTab.rowsLabel",defaultMessage:"Rows"})},external_osdSharedDeps_React_default.a.createElement("input",{className:"tvbAgg__input",type:"number",onChange:handleTextChange("pivot_rows"),value:model.pivot_rows})))))),external_osdSharedDeps_React_default.a.createElement(series_editor_SeriesEditor,{fields:this.props.fields,model:this.props.model,name:this.props.name,onChange:this.props.onChange}))}else{view=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbPanelConfig__container"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPanel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.optionsTab.dataLabel",defaultMessage:"Data"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("drilldownInput"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.optionsTab.itemUrlLabel",defaultMessage:"Item url"}),helpText:external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.optionsTab.itemUrlHelpText",defaultMessage:"This supports mustache templating. {key} is set to the term.",values:{key:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCode"],null,"{{key}}")}}))},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("drilldown_url"),value:model.drilldown_url})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_osdSharedDeps_React_default.a.createElement(IndexPattern,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("panelFilterInput"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language?model.filter.language:getDefaultQueryLanguage(),query:model.filter.query||""},onChange:filter=>this.props.onChange({filter:filter}),indexPatterns:[model.index_pattern||model.default_index_pattern]}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("globalFilterOption")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.optionsTab.ignoreGlobalFilterLabel",defaultMessage:"Ignore global filter?"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(YesNo,{id:htmlId("globalFilterOption"),value:model.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange})))))}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="data",onClick:()=>this.switchTab("data")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.dataTab.columnsButtonLabel",defaultMessage:"Columns"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="options",onClick:()=>this.switchTab("options")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"}))),view)}}class gauge_GaugePanelConfigUi extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);this.state={selectedTab:"data"}}UNSAFE_componentWillMount(){const{model:model}=this.props;const parts={};if(!model.gauge_color_rules||model.gauge_color_rules&&model.gauge_color_rules.length===0){parts.gauge_color_rules=[{id:uuid_default.a.v1()}]}if(model.gauge_width==null)parts.gauge_width=10;if(model.gauge_inner_width==null)parts.gauge_inner_width=10;if(model.gauge_style==null)parts.gauge_style="half";this.props.onChange(parts)}switchTab(selectedTab){this.setState({selectedTab:selectedTab})}render(){const{selectedTab:selectedTab}=this.state;const{intl:intl}=this.props;const defaults={gauge_max:"",filter:{query:"",language:getDefaultQueryLanguage()},gauge_style:"circle",gauge_inner_width:"",gauge_width:""};const model={...defaults,...this.props.model};const handleSelectChange=createSelectHandler(this.props.onChange);const handleTextChange=createTextHandler(this.props.onChange);const styleOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.gauge.styleOptions.circleLabel",defaultMessage:"Circle"}),value:"circle"},{label:intl.formatMessage({id:"visTypeTimeseries.gauge.styleOptions.halfCircleLabel",defaultMessage:"Half Circle"}),value:"half"}];const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const selectedGaugeStyleOption=styleOptions.find(option=>model.gauge_style===option.value);let view;if(selectedTab==="data"){view=external_osdSharedDeps_React_default.a.createElement(series_editor_SeriesEditor,{colorPicker:true,fields:this.props.fields,limit:limitOfSeries[panel_types["a"].GAUGE],model:this.props.model,name:this.props.name,onChange:this.props.onChange})}else{view=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbPanelConfig__container"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPanel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.dataLabel",defaultMessage:"Data"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(IndexPattern,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("panelFilter"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language||getDefaultQueryLanguage(),query:model.filter.query||""},onChange:filter=>this.props.onChange({filter:filter}),indexPatterns:[model.index_pattern||model.default_index_pattern]}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.ignoreGlobalFilterLabel",defaultMessage:"Ignore global filter?"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPanel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.styleLabel",defaultMessage:"Style"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("gaugeMax"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.gaugeMaxLabel",defaultMessage:"Gauge max (empty for auto)"})},external_osdSharedDeps_React_default.a.createElement("input",{id:htmlId("gaugeMax"),className:"tvbAgg__input",type:"number",onChange:handleTextChange("gauge_max"),value:model.gauge_max}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("gaugeStyle"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.gaugeStyleLabel",defaultMessage:"Gauge style"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:styleOptions,selectedOptions:selectedGaugeStyleOption?[selectedGaugeStyleOption]:[],onChange:handleSelectChange("gauge_style"),singleSelection:{asPlainText:true}}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("innerLine"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.innerLineWidthLabel",defaultMessage:"Inner line width"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{onChange:handleTextChange("gauge_inner_width"),value:Number(model.gauge_inner_width)}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("gaugeLine"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.gaugeLineWidthLabel",defaultMessage:"Gauge line width"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldNumber"],{onChange:handleTextChange("gauge_width"),value:Number(model.gauge_width)})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.backgroundColorLabel",defaultMessage:"Background color:"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(ColorPicker,{onChange:this.props.onChange,name:"background_color",value:model.background_color})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.innerColorLabel",defaultMessage:"Inner color:"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(ColorPicker,{onChange:this.props.onChange,name:"gauge_inner_color",value:model.gauge_inner_color}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"xxs"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.colorRulesLabel",defaultMessage:"Color rules"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(ColorRules,{primaryName:"gauge color",primaryVarName:"gauge",secondaryName:"text color",secondaryVarName:"text",model:model,onChange:this.props.onChange,name:"gauge_color_rules"})))}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="data",onClick:()=>this.switchTab("data")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.dataTab.dataButtonLabel",defaultMessage:"Data"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="options",onClick:()=>this.switchTab("options")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"}))),view)}}const GaugePanelConfig=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(gauge_GaugePanelConfigUi);var less=__webpack_require__(275);var mode_markdown=__webpack_require__(276);var github=__webpack_require__(281);function markdown_editor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class markdown_editor_MarkdownEditor extends external_osdSharedDeps_React_["Component"]{constructor(){super(...arguments);markdown_editor_defineProperty(this,"handleChange",value=>{this.props.onChange({markdown:value})});markdown_editor_defineProperty(this,"handleOnLoad",ace=>{this.ace=ace})}handleVarClick(snippet){return()=>{if(this.ace)this.ace.insert(snippet)}}render(){const{visData:visData,model:model,dateFormat:dateFormat}=this.props;if(!visData){return null}const series=external_osdSharedDeps_Lodash_default.a.get(visData,"".concat(model.id,".series"),[]);const variables=convertSeriesToVars(series,model,dateFormat,this.props.getConfig);const rows=[];const rawFormatter=createTickFormatter("0.[0000]",null,this.props.getConfig);const createPrimitiveRow=key=>{const snippet="{{ ".concat(key," }}");let value=external_osdSharedDeps_Lodash_default.a.get(variables,key);if(/raw$/.test(key))value=rawFormatter(value);rows.push(external_osdSharedDeps_React_default.a.createElement("tr",{key:key},external_osdSharedDeps_React_default.a.createElement("td",null,external_osdSharedDeps_React_default.a.createElement("a",{onClick:this.handleVarClick(snippet)},snippet)),external_osdSharedDeps_React_default.a.createElement("td",null,external_osdSharedDeps_React_default.a.createElement("code",null,"“",value,"”"))))};const createArrayRow=key=>{const snippet="{{# ".concat(key," }}{{/ ").concat(key," }}");const date=external_osdSharedDeps_Lodash_default.a.get(variables,"".concat(key,"[0][0]"));let value=external_osdSharedDeps_Lodash_default.a.get(variables,"".concat(key,"[0][1]"));if(/raw$/.test(key))value=rawFormatter(value);rows.push(external_osdSharedDeps_React_default.a.createElement("tr",{key:key},external_osdSharedDeps_React_default.a.createElement("td",null,external_osdSharedDeps_React_default.a.createElement("a",{onClick:this.handleVarClick(snippet)},"{{ ".concat(key," }}"))),external_osdSharedDeps_React_default.a.createElement("td",null,external_osdSharedDeps_React_default.a.createElement("code",null,"[ [ “",date,"”, “",value,"” ], ... ]"))))};function walk(obj){let path=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];for(const name in obj){if(Array.isArray(obj[name])){createArrayRow(path.concat(name).join("."))}else if(external_osdSharedDeps_Lodash_default.a.isObject(obj[name])){walk(obj[name],path.concat(name))}else{createPrimitiveRow(path.concat(name).join("."))}}}walk(variables);return external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbMarkdownEditor"},external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbMarkdownEditor__editor"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCodeEditor"],{onLoad:this.handleOnLoad,mode:"markdown",theme:"textmate",width:"100%",height:"100%",name:"ace-".concat(model.id),setOptions:{wrap:true,fontSize:"14px"},value:model.markdown,onChange:this.handleChange})),external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbMarkdownEditor__variables"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],null,external_osdSharedDeps_React_default.a.createElement("p",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdownEditor.howToUseVariablesInMarkdownDescription",defaultMessage:"The following variables can be used in the Markdown by using the Handlebar (mustache) syntax. {handlebarLink} on the available expressions.",values:{handlebarLink:external_osdSharedDeps_React_default.a.createElement("a",{href:"https://handlebarsjs.com/guide/expressions.html",target:"_BLANK",rel:"noreferrer noopener"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdownEditor.howUseVariablesInMarkdownDescription.documentationLinkText",defaultMessage:"Click here for documentation"}))}}))),external_osdSharedDeps_React_default.a.createElement("table",{className:"table","data-test-subj":"tsvbMarkdownVariablesTable"},external_osdSharedDeps_React_default.a.createElement("thead",null,external_osdSharedDeps_React_default.a.createElement("tr",null,external_osdSharedDeps_React_default.a.createElement("th",{scope:"col"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdownEditor.nameLabel",defaultMessage:"Name"})),external_osdSharedDeps_React_default.a.createElement("th",{scope:"col"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdownEditor.valueLabel",defaultMessage:"Value"})))),external_osdSharedDeps_React_default.a.createElement("tbody",null,rows)),rows.length===0&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"xxs",className:"tsvbMarkdownVariablesTable__noVariables","data-test-subj":"tvbMarkdownEditor__noVariables"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdownEditor.noVariablesAvailableDescription",defaultMessage:"No variables available for the selected data metrics."}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],null,external_osdSharedDeps_React_default.a.createElement("p",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdownEditor.howToAccessEntireTreeDescription",defaultMessage:"There is also a special variable named {all} which you can use to access the entire tree. This is useful for creating lists with data from a group by:",values:{all:external_osdSharedDeps_React_default.a.createElement("code",null,"_all")}}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCodeBlock"],null,"# All servers:\n\n    {{#each _all}}\n    - {{ label }} {{ last.formatted }}\n    {{/each}}")))}}var less_browser=__webpack_require__(282);var less_browser_default=__webpack_require__.n(less_browser);function markdown_extends(){markdown_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return markdown_extends.apply(this,arguments)}const lessC=less_browser_default()(window,{env:"production"});class markdown_MarkdownPanelConfigUi extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);this.state={selectedTab:"markdown"};this.handleCSSChange=this.handleCSSChange.bind(this)}switchTab(selectedTab){this.setState({selectedTab:selectedTab})}handleCSSChange(value){const{model:model}=this.props;const lessSrc="#markdown-".concat(model.id," {\n  ").concat(value,"\n}");lessC.render(lessSrc,{compress:true,javascriptEnabled:false},(e,output)=>{const parts={markdown_less:value};if(output){parts.markdown_css=output.css}this.props.onChange(parts)})}render(){const defaults={filter:{query:"",language:getDefaultQueryLanguage()}};const model={...defaults,...this.props.model};const{selectedTab:selectedTab}=this.state;const handleSelectChange=createSelectHandler(this.props.onChange);const{intl:intl}=this.props;const htmlId=Object(external_osdSharedDeps_ElasticEui_["htmlIdGenerator"])();const alignOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.markdown.alignOptions.topLabel",defaultMessage:"Top"}),value:"top"},{label:intl.formatMessage({id:"visTypeTimeseries.markdown.alignOptions.middleLabel",defaultMessage:"Middle"}),value:"middle"},{label:intl.formatMessage({id:"visTypeTimeseries.markdown.alignOptions.bottomLabel",defaultMessage:"Bottom"}),value:"bottom"}];const selectedAlignOption=alignOptions.find(option=>model.markdown_vertical_align===option.value);let view;if(selectedTab==="markdown"){view=external_osdSharedDeps_React_default.a.createElement(VisDataContext.Consumer,null,visData=>external_osdSharedDeps_React_default.a.createElement(markdown_editor_MarkdownEditor,markdown_extends({visData:visData},this.props)))}else if(selectedTab==="data"){view=external_osdSharedDeps_React_default.a.createElement(series_editor_SeriesEditor,{colorPicker:false,fields:this.props.fields,model:this.props.model,name:this.props.name,onChange:this.props.onChange})}else{view=external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbPanelConfig__container"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPanel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.dataLabel",defaultMessage:"Data"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(IndexPattern,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("panelFilter"),label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:true},external_osdSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language?model.filter.language:getDefaultQueryLanguage(),query:model.filter.query||""},onChange:filter=>this.props.onChange({filter:filter}),indexPatterns:[model.index_pattern||model.default_index_pattern]}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.ignoreGlobalFilterLabel",defaultMessage:"Ignore global filter?"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange})))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPanel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.styleLabel",defaultMessage:"Style"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,alignItems:"center"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.backgroundColorLabel",defaultMessage:"Background color:"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(ColorPicker,{onChange:this.props.onChange,name:"background_color",value:model.background_color})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.showScrollbarsLabel",defaultMessage:"Show scrollbars?"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.markdown_scrollbars,name:"markdown_scrollbars",onChange:this.props.onChange})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.openLinksInNewTab",defaultMessage:"Open links in new tab?"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(YesNo,{value:model.markdown_openLinksInNewTab,name:"markdown_openLinksInNewTab",onChange:this.props.onChange})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("valign")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.verticalAlignmentLabel",defaultMessage:"Vertical alignment:"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiComboBox"],{id:htmlId("valign"),isClearable:false,options:alignOptions,selectedOptions:selectedAlignOption?[selectedAlignOption]:[],onChange:handleSelectChange("markdown_vertical_align"),singleSelection:{asPlainText:true}}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTitle"],{size:"xxs"},external_osdSharedDeps_React_default.a.createElement("span",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.customCSSLabel",defaultMessage:"Custom CSS (supports Less)",description:"CSS and Less are names of technologies and should not be translated."}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCodeEditor"],{mode:"less",theme:"textmate",width:"100%",name:"ace-css-".concat(model.id),setOptions:{fontSize:"14px"},value:model.markdown_less,onChange:this.handleCSSChange})))}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="markdown",onClick:()=>this.switchTab("markdown"),"data-test-subj":"markdown-subtab"},"Markdown"),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"data-subtab",isSelected:selectedTab==="data",onClick:()=>this.switchTab("data")},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.dataTab.dataButtonLabel",defaultMessage:"Data"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="options",onClick:()=>this.switchTab("options"),"data-test-subj":"options-subtab"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"}))),view)}}const MarkdownPanelConfig=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(markdown_MarkdownPanelConfigUi);const panel_config_types={timeseries:TimeseriesPanelConfig,table:table_TablePanelConfig,metric:metric_MetricPanelConfig,top_n:top_n_TopNPanelConfig,gauge:GaugePanelConfig,markdown:MarkdownPanelConfig};const checkModelValidity=validationResults=>Boolean(Object.values(validationResults).every(isValid=>isValid));function PanelConfig(props){const{model:model}=props;const Component=panel_config_types[model.type];const[formValidationResults]=Object(external_osdSharedDeps_React_["useState"])({});const[visData,setVisData]=Object(external_osdSharedDeps_React_["useState"])({});Object(external_osdSharedDeps_React_["useEffect"])(()=>{model.isModelInvalid=!checkModelValidity(formValidationResults)});Object(external_osdSharedDeps_React_["useEffect"])(()=>{const visDataSubscription=props.visData$.subscribe((function(){let visData=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return setVisData(visData)}));return function cleanup(){visDataSubscription.unsubscribe()}},[model.id,props.visData$]);const updateControlValidity=(controlKey,isControlValid)=>{formValidationResults[controlKey]=isControlValid};if(Component){return external_osdSharedDeps_React_default.a.createElement(FormValidationContext.Provider,{value:updateControlValidity},external_osdSharedDeps_React_default.a.createElement(VisDataContext.Provider,{value:visData},external_osdSharedDeps_React_default.a.createElement("div",{"data-test-subj":"tvbPanelConfig__".concat(model.type)},external_osdSharedDeps_React_default.a.createElement(Component,props))))}return external_osdSharedDeps_React_default.a.createElement("div",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.missingPanelConfigDescription",defaultMessage:"Missing panel config for “{modelType}”",values:{modelType:model.type}}))}const createBrushHandler=applyFilter=>(gte,lte)=>applyFilter({timeFieldName:"*",filters:[{range:{"*":{gte:gte,lte:lte}}}]});var fetch_fields=__webpack_require__(14);var extract_index_patterns=__webpack_require__(15);var opensearchDashboardsUtils_public_=__webpack_require__(4);function vis_editor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const VIS_STATE_DEBOUNCE_DELAY=200;const APP_NAME="VisEditor";class vis_editor_VisEditor extends external_osdSharedDeps_React_["Component"]{constructor(props){var _this;super(props);_this=this;vis_editor_defineProperty(this,"getConfig",(function(){return _this.props.config.get(...arguments)}));vis_editor_defineProperty(this,"handleUiState",(field,value)=>{this.props.vis.uiState.set(field,value);this.props.vis.uiState.emit("reload")});vis_editor_defineProperty(this,"updateVisState",Object(external_osdSharedDeps_Lodash_["debounce"])(()=>{this.props.vis.params=this.state.model;this.props.embeddableHandler.reload();this.props.eventEmitter.emit("dirtyStateChange",{isDirty:false})},VIS_STATE_DEBOUNCE_DELAY));vis_editor_defineProperty(this,"handleChange",partialModel=>{if(Object(external_osdSharedDeps_Lodash_["isEmpty"])(partialModel)){return}const hasTypeChanged=partialModel.type&&this.state.model.type!==partialModel.type;const nextModel={...this.state.model,...partialModel};let dirty=true;if(this.state.autoApply||hasTypeChanged){this.updateVisState();dirty=false}if(this.props.isEditorMode){const extractedIndexPatterns=Object(extract_index_patterns["a"])(nextModel);if(!Object(external_osdSharedDeps_Lodash_["isEqual"])(this.state.extractedIndexPatterns,extractedIndexPatterns)){Object(fetch_fields["a"])(extractedIndexPatterns).then(visFields=>this.setState({visFields:visFields,extractedIndexPatterns:extractedIndexPatterns}))}}this.setState({dirty:dirty,model:nextModel})});vis_editor_defineProperty(this,"updateModel",()=>{const{params:params}=this.props.vis.clone();this.setState({model:params})});vis_editor_defineProperty(this,"handleCommit",()=>{this.updateVisState();this.setState({dirty:false})});vis_editor_defineProperty(this,"handleAutoApplyToggle",event=>{this.setState({autoApply:event.target.checked})});vis_editor_defineProperty(this,"onDataChange",_ref=>{let{visData:visData}=_ref;this.visDataSubject.next(visData)});this.localStorage=new opensearchDashboardsUtils_public_["Storage"](window.localStorage);this.state={model:props.visParams,dirty:false,autoApply:true,visFields:props.visFields,extractedIndexPatterns:[""]};this.onBrush=createBrushHandler(data=>props.vis.API.events.applyFilter(data));this.visDataSubject=new external_osdSharedDeps_Rxjs_["BehaviorSubject"](this.props.visData);this.visData$=this.visDataSubject.asObservable().pipe(Object(external_osdSharedDeps_RxjsOperators_["share"])());this.coreContext={appName:APP_NAME,uiSettings:Object(services["g"])(),savedObjectsClient:Object(services["f"])(),store:this.localStorage}}get uiState(){return this.props.vis.uiState}render(){if(!this.props.isEditorMode){if(!this.props.visParams||!this.props.visData){return null}return external_osdSharedDeps_React_default.a.createElement(Visualization,{dateFormat:this.props.config.get("dateFormat"),onBrush:this.onBrush,onUiState:this.handleUiState,uiState:this.uiState,model:this.props.visParams,visData:this.props.visData,getConfig:this.getConfig})}const{model:model}=this.state;if(model){return external_osdSharedDeps_React_default.a.createElement(opensearchDashboardsReact_public_["OpenSearchDashboardsContextProvider"],{services:{appName:APP_NAME,storage:this.localStorage,data:Object(services["c"])(),...Object(services["b"])()}},external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbEditor","data-test-subj":"tvbVisEditor"},external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbEditor--hideForReporting"},external_osdSharedDeps_React_default.a.createElement(VisPicker,{model:model,onChange:this.handleChange})),external_osdSharedDeps_React_default.a.createElement(VisEditorVisualization,{dirty:this.state.dirty,autoApply:this.state.autoApply,model:model,embeddableHandler:this.props.embeddableHandler,eventEmitter:this.props.eventEmitter,vis:this.props.vis,timeRange:this.props.timeRange,uiState:this.uiState,onCommit:this.handleCommit,onToggleAutoApply:this.handleAutoApplyToggle,title:this.props.vis.title,description:this.props.vis.description,onDataChange:this.onDataChange}),external_osdSharedDeps_React_default.a.createElement("div",{className:"tvbEditor--hideForReporting"},external_osdSharedDeps_React_default.a.createElement(CoreStartContextProvider,{value:this.coreContext},external_osdSharedDeps_React_default.a.createElement(PanelConfig,{fields:this.state.visFields,model:model,visData$:this.visData$,dateFormat:this.props.config.get("dateFormat"),onChange:this.handleChange,getConfig:this.getConfig})))))}return null}componentDidMount(){this.props.renderComplete();if(this.props.isEditorMode&&this.props.eventEmitter){this.props.eventEmitter.on("updateEditor",this.updateModel)}}componentDidUpdate(){this.props.renderComplete()}componentWillUnmount(){this.updateVisState.cancel();if(this.props.isEditorMode&&this.props.eventEmitter){this.props.eventEmitter.off("updateEditor",this.updateModel)}}}vis_editor_VisEditor.defaultProps={visData:{}}}}]);